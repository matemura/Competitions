Za celta izvur6vam "kompresirane na ravninata", kato sortiram vsi4ki abscisi i vsi4ki ordinati i davam na vseki pravougulnik koordinati ravni na indeksite na suotvetnite stoinosti v dvata sortirani masiva. Sled tova "risuvam" polu4enite pravougulnici v mreja, izobrazqva6ta ravninata, kato na kvadrat4etata, pokriti ot pravougulnik, davam stoinost 1, a na ostanalite - 0. Posle gledam kude se dopirat kvadrat4eta, ednoto ot koito e 0 a drugoto 1, i dobavqm kum otgovora duljinata na suotvetnata grani4na otse4ka (fakti4eski stranata na kvadrat4eto, koeto v deistvitelnost ne e kvadrat4e,a pravougulni4e).