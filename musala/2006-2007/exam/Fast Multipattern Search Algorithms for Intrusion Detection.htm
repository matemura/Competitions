<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<BASE HREF="http://www.dcc.uchile.cl/~gnavarro/ps/fi03.ps.gz"><table border=1 width=100%><tr><td><table border=1 bgcolor=#ffffff cellpadding=10 cellspacing=0 width=100% color=#ffffff><tr><td><font face=arial,sans-serif color=black size=-1>Това е текстовата версия на файла <A HREF="http://www.dcc.uchile.cl/~gnavarro/ps/fi03.ps.gz"><font color=blue>http://www.dcc.uchile.cl/~gnavarro/ps/fi03.ps.gz</font></a>. <br><b><font color=#0039b6>G</font> <font color=#c41200>o</font> <font color=#f3c518>o</font> <font color=#0039b6>g</font> <font color=#30a72f>l</font> <font color=#c41200>e</font></b> автоматично създава текстови версии на документите, докато индексираме мрежата.<br>За връзка към тази страница или добавянето и в отметките, използвайте следния url: <code>http://www.google.com/search?q=cache:AdX7XKVm5OQJ:www.dcc.uchile.cl/~gnavarro/ps/fi03.ps.gz+string+search+algorithm+%2Bmultiple+%2Blong+%2Bpreprocessing&amp;hl=bg&amp;gl=bg&amp;ct=clnk&amp;cd=18</code></font><br><br><center><font size=-2><i>Google не е свързан с авторите на тази страница и не е отговорен за материалите в нея.</i></font></center></td></tr>
<tr><td>
<table border=0 cellpadding=0 cellspacing=0><tr><td><font face=arial,sans-serif color=black size=-1>Маркирани бяха тези търсени термини:&nbsp;</font></td><td bgcolor=#ffff66><b><font face=arial,sans-serif color=black size=-1>string&nbsp;</font></b></td><td bgcolor=#a0ffff><b><font face=arial,sans-serif color=black size=-1>search&nbsp;</font></b></td><td bgcolor=#99ff99><b><font face=arial,sans-serif color=black size=-1>algorithm&nbsp;</font></b></td><td bgcolor=#ff9999><b><font face=arial,sans-serif color=black size=-1>multiple&nbsp;</font></b></td><td bgcolor=#ff66ff><b><font face=arial,sans-serif color=black size=-1>long&nbsp;</font></b></td><td bgcolor=#880000><b><font face=arial,sans-serif color=white size=-1>preprocessing&nbsp;</font></b></td></tr></table>
</td></tr></table></td></tr></table>
<hr>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Producer" content="GNU Ghostscript 7.07">
<meta name="Creator" content="dvips(k) 5.86 Copyright 1999 Radical Eye Software">
<title>Fast Multipattern Search Algorithms for Intrusion Detection</title>
</head><body  bgcolor=#ffffff vlink="blue" link="blue">
<table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=1><b>Page 1</b></a></font></td></tr></table><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:374;left:112"><nobr><i>Fundamenta Informaticae XXI (2001) 1001–1027</i></nobr></div>
<div style="position:absolute;top:374;left:766"><nobr>1001</nobr></div>
<div style="position:absolute;top:397;left:112"><nobr><i>IOS Press</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:445;left:157"><nobr><b>Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:502;left:157"><nobr><b>Josue Kuri</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:528;left:157"><nobr><i>Dept. of Computer Science and Networks, ENST</i></nobr></div>
<div style="position:absolute;top:552;left:157"><nobr><i>46, rue Barrault, 75634 Paris, France</i></nobr></div>
<div style="position:absolute;top:577;left:157"><nobr><i>kuri@enst.fr</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:607;left:157"><nobr><b>Gonzalo Navarro</b></nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:605;left:277"><nobr>y C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:633;left:157"><nobr><i>Dept. of Computer Science, University of Chile</i></nobr></div>
<div style="position:absolute;top:657;left:157"><nobr><i>Blanco Encalada 2120, Santiago, Chile</i></nobr></div>
<div style="position:absolute;top:682;left:157"><nobr><i>gnavarro@dcc.uchile.cl</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:712;left:157"><nobr><b>Ludovic Me</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:738;left:157"><nobr><i>Supelec. Campus de Rennes, France</i></nobr></div>
<div style="position:absolute;top:762;left:157"><nobr><i>Ludovic.Me@supelec.fr</i></nobr></div>
<div style="position:absolute;top:986;left:155"><nobr><b>Abstract. </b>We present new <b style="color:black;background-color:#a0ffff">search</b> algorithms to detect the occurrences of any pattern from a given</nobr></div>
<div style="position:absolute;top:1005;left:155"><nobr>pattern set in a text, allowing in the occurrences a limited number of spurious text characters among</nobr></div>
<div style="position:absolute;top:1023;left:155"><nobr>those of the pattern. This is a common requirement in intrusion detection applications. Our al-</nobr></div>
<div style="position:absolute;top:1040;left:155"><nobr>gorithms exploit the ability to represent the <b style="color:black;background-color:#a0ffff">search</b> state of one or more patterns in the bits of a</nobr></div>
<div style="position:absolute;top:1058;left:155"><nobr>single machine word and update all the <b style="color:black;background-color:#a0ffff">search</b> states in a single operation. We show analytically</nobr></div>
<div style="position:absolute;top:1076;left:155"><nobr>and experimentally that the algorithms are able of fast searching for large sets of patterns allowing a</nobr></div>
<div style="position:absolute;top:1094;left:155"><nobr>wide number of spurious characters, yielding in our machine about a 75-fold improvement over the</nobr></div>
<div style="position:absolute;top:1112;left:155"><nobr>classical dynamic programming <b style="color:black;background-color:#99ff99">algorithm</b>.</nobr></div>
<div style="position:absolute;top:1174;left:155"><nobr><b>Keywords: </b>Approximate <b style="color:black;background-color:#ffff66">string</b> matching, bit-parallelism, security, audit trails.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:1216;left:119"><nobr>Work supported by CONACyT grant # 122688.</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:5px;font-family:Times">
<div style="position:absolute;top:1233;left:112"><nobr>y</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:1233;left:118"><nobr>Supported in part by Fondecyt grant 1-020831.</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:1249;left:112"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:1250;left:119"><nobr>Corresponding author</nobr></div>
</span></font>

<div style="position:absolute;top:1363;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=2><b>Page 2</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:1508;left:108"><nobr>1002</nobr></div>
<div style="position:absolute;top:1508;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:1553;left:108"><nobr><b>1. Introduction</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:1598;left:108"><nobr>A major challenge in intrusion detection is the effective detection of attacks as they are occurring, a</nobr></div>
<div style="position:absolute;top:1618;left:108"><nobr>problem known as <i>on-line </i>intrusion detection. Current research trends aim to a simplified representa-</nobr></div>
<div style="position:absolute;top:1638;left:108"><nobr>tion of the problem in order to improve efficiency and performance. Pattern matching techniques are</nobr></div>
<div style="position:absolute;top:1659;left:108"><nobr>getting major attention as potential solutions because they have solved analog problems in domains as</nobr></div>
<div style="position:absolute;top:1679;left:108"><nobr>computational biology and information retrieval.</nobr></div>
<div style="position:absolute;top:1700;left:133"><nobr>We give an example to illustrate how an intrusion detection problem can be translated into a pattern</nobr></div>
<div style="position:absolute;top:1720;left:108"><nobr>matching problem. Auditable events in the target system (such as TCP/IP packages in a network or</nobr></div>
<div style="position:absolute;top:1741;left:108"><nobr>commands typed by users of a multi-user computer) can be seen as characters of an alphabet and the</nobr></div>
<div style="position:absolute;top:1761;left:108"><nobr>audit trail as a large <i><b style="color:black;background-color:#ffff66">string</b> </i>of characters in</nobr></div>
<div style="position:absolute;top:1761;left:404"><nobr>(<i>i.e.</i>, the text). The sequences of events representing attacks</nobr></div>
<div style="position:absolute;top:1781;left:108"><nobr>to be detected are then <i>substrings </i>(<i>i.e.</i>, patterns) to be located in the large <b style="color:black;background-color:#ffff66">string</b>. Potential attackers may</nobr></div>
<div style="position:absolute;top:1802;left:108"><nobr>introduce spurious events among those that represent an actual attack in order to disperse their evidence,</nobr></div>
<div style="position:absolute;top:1822;left:108"><nobr>so a limited number of spurious characters must be allowed when searching for the pattern. We are</nobr></div>
<div style="position:absolute;top:1842;left:108"><nobr>interested in detecting a <i>set </i>of possible attacks at the same time. This intrusion detection problem can be</nobr></div>
<div style="position:absolute;top:1863;left:108"><nobr>regarded as a particular case of the <b style="color:black;background-color:#ff9999">multiple</b> approximate pattern matching problem, where <i>insertion </i>in</nobr></div>
<div style="position:absolute;top:1883;left:108"><nobr>the pattern is the only allowed edit operation.</nobr></div>
<div style="position:absolute;top:1904;left:133"><nobr>We formalize the above problem as follows. Our text, T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:1911;left:508"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:1910;left:514"><nobr>::n</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:1904;left:529"><nobr>, is a sequence of n characters from an</nobr></div>
<div style="position:absolute;top:1924;left:108"><nobr>alphabet of size . Our pattern, P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:1932;left:343"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:1930;left:349"><nobr>::m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:1924;left:372"><nobr>is a sequence of m characters from the same alphabet. We want</nobr></div>
<div style="position:absolute;top:1945;left:108"><nobr>to report all the text positions that match the pattern, where at most k insertions between characters of P</nobr></div>
<div style="position:absolute;top:1965;left:108"><nobr>are allowed in its occurrence in T. We call</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:1967;left:400"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:1965;left:412"><nobr>k=m the “error level”.</nobr></div>
<div style="position:absolute;top:1986;left:133"><nobr>A common property of audit facilities is that they generate huge amounts of audited data in a short</nobr></div>
<div style="position:absolute;top:2007;left:108"><nobr>time, in the order of several millions of events per hour for large computing infrastructures. On the other</nobr></div>
<div style="position:absolute;top:2027;left:108"><nobr>hand, attacks are typically short sequences of no more than 8 commands. The number of known attacks to</nobr></div>
<div style="position:absolute;top:2047;left:108"><nobr>system vulnerabilities is large, so a common request for an intrusion detection system to <b style="color:black;background-color:#a0ffff">search</b> for attack</nobr></div>
<div style="position:absolute;top:2067;left:108"><nobr>sets of more than 100 elements. Under the approach of mapping events to characters, the typical alphabet</nobr></div>
<div style="position:absolute;top:2088;left:108"><nobr>size may vary from 60 to 80, depending on the number of different auditable events in a particular system.</nobr></div>
<div style="position:absolute;top:2109;left:133"><nobr>With respect to the typical k values, it is important to avoid false positives (<i>i.e.</i>, triggering unnecessary</nobr></div>
<div style="position:absolute;top:2129;left:108"><nobr>alarms for sequences that do not really represent an attack because k is too large) and to avoid false</nobr></div>
<div style="position:absolute;top:2149;left:108"><nobr>negatives (<i>i.e.</i>, missing true attacks). Empirical values of k are typically between 6 and 10. See [17, 14,</nobr></div>
<div style="position:absolute;top:2170;left:108"><nobr>13] for justifications of all these values.</nobr></div>
<div style="position:absolute;top:2191;left:133"><nobr>An extended version of this problem (namely searching allowing k differences, or allowing edit</nobr></div>
<div style="position:absolute;top:2211;left:108"><nobr>distance at most k) has received a lot of attention in the last decades [23], and some of the algorithms can</nobr></div>
<div style="position:absolute;top:2232;left:108"><nobr>be particularized to solve this problem for one pattern. However, no specially designed solutions exist</nobr></div>
<div style="position:absolute;top:2252;left:108"><nobr>that take full advantage of the nature of this problem. It would be misleading to think that permitting just</nobr></div>
<div style="position:absolute;top:2272;left:108"><nobr>insertions makes the problem easier. For example, several important invariants that make life easier hold</nobr></div>
<div style="position:absolute;top:2293;left:108"><nobr>in the k differences problem and do not hold in the k insertions problem (<i>e.g.</i>, that contiguous cells in</nobr></div>
<div style="position:absolute;top:2313;left:108"><nobr>the matrices used to compute the distances differ at most by one). Moreover, no solutions exist for the</nobr></div>
<div style="position:absolute;top:2333;left:108"><nobr>multipattern <b style="color:black;background-color:#a0ffff">search</b> problem, which is essential in this application.</nobr></div>
<div style="position:absolute;top:2354;left:133"><nobr>In this paper we present two different solutions for multipattern searching allowing insertions, which</nobr></div>
<div style="position:absolute;top:2374;left:108"><nobr>are especially tailored to the setup typical of intrusion detection applications: short patterns, large error</nobr></div>
<div style="position:absolute;top:2395;left:108"><nobr>levels, large alphabets, large number of patterns. Both solutions are based on bit parallelism, a technique</nobr></div>
<div style="position:absolute;top:2415;left:108"><nobr>to pack many values in the bits of a single computer word and manage to update all them in parallel. A</nobr></div>
<div style="position:absolute;top:2435;left:108"><nobr>first one uses bit parallelism to simulate the behavior of a nondeterministic finite automaton that finds all</nobr></div>
</span></font>

<div style="position:absolute;top:2551;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=3><b>Page 3</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:2696;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:2696;left:765"><nobr>1003</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:2747;left:112"><nobr>the occurrences of one pattern allowing k insertions, and searches for many patterns by “superimposing”</nobr></div>
<div style="position:absolute;top:2767;left:112"><nobr>their automata. A second one is a filter that discards most of the text by counting the number of pattern</nobr></div>
<div style="position:absolute;top:2788;left:112"><nobr>characters that appear in a window, and searches for many patterns by packing many counters in a</nobr></div>
<div style="position:absolute;top:2808;left:112"><nobr>single computer word. Both multipattern filters need, in order to work efficiently, that the lengths of</nobr></div>
<div style="position:absolute;top:2828;left:112"><nobr>the patterns involved are not very different. Although we reuse known techniques, their application to</nobr></div>
<div style="position:absolute;top:2849;left:112"><nobr>pattern matching allowing insertions is not trivial.</nobr></div>
<div style="position:absolute;top:2869;left:138"><nobr>We analyze both algorithms and find the optimal way to set up their parameters, as well as their</nobr></div>
<div style="position:absolute;top:2889;left:112"><nobr>expected case complexity and the maximum error level k=m up to where they are useful. We also present</nobr></div>
<div style="position:absolute;top:2910;left:112"><nobr>experimental results that confirm our analysis and measure the practical performance of the algorithms.</nobr></div>
<div style="position:absolute;top:2930;left:112"><nobr>For typical cases our bit-parallel versions for one pattern outperform the classical dynamic programming</nobr></div>
<div style="position:absolute;top:2950;left:112"><nobr><b style="color:black;background-color:#99ff99">algorithm</b> by a factor of 3, while the multipattern filters obtain a 25-fold speedup. The net result is a</nobr></div>
<div style="position:absolute;top:2971;left:112"><nobr>75-fold speedup over a classical approach. We include domain specific experiments as well.</nobr></div>
<div style="position:absolute;top:2991;left:138"><nobr>This paper is organized as follows. Section 2 puts our work and results in context, giving more</nobr></div>
<div style="position:absolute;top:3012;left:112"><nobr>details about the complexities we obtain and how they relate to previous work and their applications.</nobr></div>
<div style="position:absolute;top:3032;left:112"><nobr>Section 3 introduces the concept of “insertion distance” and gives a naive <b style="color:black;background-color:#99ff99">algorithm</b> obtained by adapting</nobr></div>
<div style="position:absolute;top:3052;left:112"><nobr>the classical solution for the k differences problem. Section 4 presents our first <b style="color:black;background-color:#99ff99">algorithm</b> based on bit-</nobr></div>
<div style="position:absolute;top:3072;left:112"><nobr>parallel simulation of a nondeterministic automaton, for one pattern. Section 5 builds a filtering <b style="color:black;background-color:#99ff99">algorithm</b></nobr></div>
<div style="position:absolute;top:3093;left:112"><nobr>for multipattern matching using that simulation. Section 6 presents the counting filter, for one and for</nobr></div>
<div style="position:absolute;top:3113;left:112"><nobr><b style="color:black;background-color:#ff9999">multiple</b> patterns. Section 7 gives all our experimental results validating the analysis and testing the</nobr></div>
<div style="position:absolute;top:3133;left:112"><nobr>algorithms. In Section 8 we apply our algorithms in a real-life case study. Finally, Section 9 gives our</nobr></div>
<div style="position:absolute;top:3154;left:112"><nobr>conclusions.</nobr></div>
<div style="position:absolute;top:3174;left:138"><nobr>Earlier versions of this paper have appeared in a <b style="color:black;background-color:#ffff66">string</b> matching oriented conference [15] and in an</nobr></div>
<div style="position:absolute;top:3195;left:112"><nobr>intrusion detection oriented one [16].</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:3243;left:112"><nobr><b>2. Our Work in Context</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:3284;left:112"><nobr><b>2.1. Pattern Matching</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3318;left:112"><nobr>A lot of work has been carried out on an extended version of our problem. This extension is called <i><b style="color:black;background-color:#a0ffff">search</b></i></nobr></div>
<div style="position:absolute;top:3339;left:112"><nobr><i>allowing </i>k <i>differences</i>, where not only insertions, but also deletions and replacements are allowed. In a</nobr></div>
<div style="position:absolute;top:3359;left:112"><nobr>recent survey [23] four approaches are distinguished to <b style="color:black;background-color:#a0ffff">search</b> with k differences: dynamic programming,</nobr></div>
<div style="position:absolute;top:3379;left:112"><nobr>automata, filtering and bit-parallelism.</nobr></div>
<div style="position:absolute;top:3400;left:138"><nobr>However, very little has been done to <b style="color:black;background-color:#a0ffff">search</b> with k insertions. Not all the algorithms for k differences</nobr></div>
<div style="position:absolute;top:3420;left:112"><nobr>can be successfully simplified for our restricted case. The most naive <b style="color:black;background-color:#99ff99">algorithm</b> (which we show in</nobr></div>
<div style="position:absolute;top:3440;left:112"><nobr>Section 3) is a simplification of the classical dynamic programming solution for k differences, and the</nobr></div>
<div style="position:absolute;top:3461;left:112"><nobr>same O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:3462;left:164"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3460;left:168"><nobr>mn</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:3462;left:191"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3461;left:200"><nobr><b style="color:black;background-color:#a0ffff">search</b> time is maintained. We consider this complexity as the reference point for further</nobr></div>
<div style="position:absolute;top:3481;left:112"><nobr>improvements. Automata approaches can be adapted with similar efficiency results: O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:3483;left:688"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3481;left:693"><nobr>n</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:3483;left:702"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3481;left:712"><nobr><b style="color:black;background-color:#a0ffff">search</b> time</nobr></div>
<div style="position:absolute;top:3501;left:112"><nobr>but impractically high <b style="color:white;background-color:#880000">preprocessing</b> and space requirements (exponential in m or k).</nobr></div>
<div style="position:absolute;top:3522;left:138"><nobr>Filtering approaches are very successful to <b style="color:black;background-color:#a0ffff">search</b> with k differences and are generally based in the</nobr></div>
<div style="position:absolute;top:3542;left:112"><nobr>concept that some pattern substrings must match even in inexact occurrences. This is also our case: for</nobr></div>
<div style="position:absolute;top:3562;left:112"><nobr>example, if k insertions are allowed in the matches then at least one pattern piece of length</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:3555;left:728"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3562;left:742"><nobr>m=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:3564;left:765"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3562;left:769"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:3564;left:783"><nobr>+</nobr></div>
<div style="position:absolute;top:3584;left:112"><nobr>1)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:3575;left:125"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3583;left:144"><nobr>must be found inside every occurrence. Hence we can <b style="color:black;background-color:#a0ffff">search</b> for those pieces and use a more</nobr></div>
<div style="position:absolute;top:3603;left:112"><nobr>expensive <b style="color:black;background-color:#99ff99">algorithm</b> only in the text areas surrounding such occurrences of pattern pieces. However, in</nobr></div>
<div style="position:absolute;top:3623;left:112"><nobr>most applications of the k differences problem it is common that k is much smaller than m and therefore</nobr></div>
</span></font>

<div style="position:absolute;top:3739;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=4><b>Page 4</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:3884;left:108"><nobr>1004</nobr></div>
<div style="position:absolute;top:3884;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:3935;left:108"><nobr>reasonably <b style="color:black;background-color:#ff66ff">long</b> pattern pieces have to be found. Instead, in intrusion detection k is normally large (in</nobr></div>
<div style="position:absolute;top:3955;left:108"><nobr>many cases k &gt; m) and therefore filtering approaches are ineffective in general.</nobr></div>
<div style="position:absolute;top:3976;left:133"><nobr>The most promising approach seems to be bit-parallelism (which we explain in Section 4), because</nobr></div>
<div style="position:absolute;top:3996;left:108"><nobr>the simplicity of the k insertions model allows devising faster algorithms. In particular, we present in</nobr></div>
<div style="position:absolute;top:4017;left:108"><nobr>Section 4 a <b style="color:black;background-color:#a0ffff">search</b> <b style="color:black;background-color:#99ff99">algorithm</b> with time complexity O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4018;left:466"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4016;left:471"><nobr>nm</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4018;left:496"><nobr>log(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4016;left:520"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4018;left:529"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4016;left:534"><nobr>=w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4018;left:555"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4017;left:566"><nobr>where w is the length in bits of</nobr></div>
<div style="position:absolute;top:4037;left:108"><nobr>the computer word. This is O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4039;left:314"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4037;left:319"><nobr>n</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4039;left:328"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4037;left:338"><nobr>for reasonably short patterns. Moreover, it is better than previous</nobr></div>
<div style="position:absolute;top:4057;left:108"><nobr>bit-parallel algorithms for the k differences, which were O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4059;left:493"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4057;left:498"><nobr>nmk=w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4059;left:551"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4057;left:560"><nobr>time [28, 4], but it is worse than a</nobr></div>
<div style="position:absolute;top:4078;left:108"><nobr>later development [20] which achieves O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4079;left:377"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4077;left:382"><nobr>mn=w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4079;left:426"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4078;left:431"><nobr>. Interestingly, this last approach cannot be adapted to</nobr></div>
<div style="position:absolute;top:4098;left:108"><nobr>our problem</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:4096;left:188"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4098;left:195"><nobr>, but that of [28] can be adapted at the same O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4100;left:501"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4098;left:506"><nobr>nmk=w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4100;left:559"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4098;left:568"><nobr>time cost. A related but different</nobr></div>
<div style="position:absolute;top:4118;left:108"><nobr>problem, called “episode matching”, is to find the pattern with the minimum number of insertions. Many</nobr></div>
<div style="position:absolute;top:4139;left:108"><nobr>algorithms are presented in [8], where the best one needing space polynomial in m takes O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4140;left:700"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4138;left:705"><nobr>mn=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4140;left:740"><nobr>log</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4138;left:762"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4140;left:775"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4159;left:108"><nobr>time. Finally, an independently developed work obtains also O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4161;left:522"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4159;left:527"><nobr>nm</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4161;left:552"><nobr>log(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4159;left:576"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4161;left:584"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4159;left:589"><nobr>=w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4161;left:610"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4159;left:620"><nobr>time for the k insertions</nobr></div>
<div style="position:absolute;top:4179;left:108"><nobr>problem [7], yet it does not generalize to multipattern <b style="color:black;background-color:#a0ffff">search</b>, as explained next.</nobr></div>
<div style="position:absolute;top:4200;left:133"><nobr>A special requirement of our application is the need for multipattern <b style="color:black;background-color:#a0ffff">search</b>. That is, we are given r</nobr></div>
<div style="position:absolute;top:4220;left:108"><nobr>patterns P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:4219;left:177"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4220;left:184"><nobr>:::P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:4217;left:210"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4220;left:222"><nobr>and we have to report all their occurrences. Little work has been done on multipattern</nobr></div>
<div style="position:absolute;top:4240;left:108"><nobr><b style="color:black;background-color:#a0ffff">search</b> for the k differences problem [19, 21, 5, 22]. In Sections 5 and 6 we adapt two of those approaches</nobr></div>
<div style="position:absolute;top:4261;left:108"><nobr>to the k insertions problem. The first one obtains a speedup of</nobr></div>
<div style="position:absolute;top:4261;left:562"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4262;left:572"><nobr>(1 + )</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:4260;left:624"><nobr>1+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4261;left:654"><nobr>(where</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4262;left:715"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4261;left:730"><nobr>k=m is</nobr></div>
<div style="position:absolute;top:4281;left:108"><nobr>the error level) over the basic bit-parallel <b style="color:black;background-color:#99ff99">algorithm</b> of Section 4. This speedup is larger than 1 for</nobr></div>
<div style="position:absolute;top:4301;left:117"><nobr>&lt; =e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4303;left:163"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4302;left:171"><nobr>. The second one obtains a speedup of w=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4303;left:444"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:4310;left:482"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4303;left:489"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4301;left:494"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4303;left:509"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4301;left:518"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4303;left:527"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4302;left:531"><nobr>, but it works well only for m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4303;left:719"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4301;left:729"><nobr>k &lt; ,</nobr></div>
<div style="position:absolute;top:4322;left:108"><nobr><i>i.e.</i>, short patterns. When the patterns have different lengths, these results still apply taking m as the</nobr></div>
<div style="position:absolute;top:4342;left:108"><nobr>minimum pattern length.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:4387;left:108"><nobr><b>2.2. Intrusion Detection</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:4421;left:108"><nobr>Research in intrusion detection has emerged in recent years as a major subject in the computer security</nobr></div>
<div style="position:absolute;top:4441;left:108"><nobr>field because of the difficulty of ensuring that information systems are free from security flaws. Computer</nobr></div>
<div style="position:absolute;top:4461;left:108"><nobr>systems suffer from security vulnerabilities regardless of their purpose, manufacturer or origin. It is both</nobr></div>
<div style="position:absolute;top:4482;left:108"><nobr>technically hard and economically costly to ensure that systems are not susceptible to attacks. Two</nobr></div>
<div style="position:absolute;top:4502;left:108"><nobr>approaches have been proposed to address the problem [17, 9, 14].</nobr></div>
<div style="position:absolute;top:4523;left:133"><nobr>A first approach, anomaly detection, suggests that user’s activity in the system can be characterized</nobr></div>
<div style="position:absolute;top:4543;left:108"><nobr>so that a profile of “normal utilization” of the system is established and excursions from this profile are</nobr></div>
<div style="position:absolute;top:4563;left:108"><nobr>tagged as potential intrusions, or attacks in a more general sense. This approach leads to some difficulties:</nobr></div>
<div style="position:absolute;top:4584;left:108"><nobr>a flow of alarms is generated in the case of a noticeable systems environment modification and a user can</nobr></div>
<div style="position:absolute;top:4604;left:108"><nobr>slowly change his behavior in order to cheat the system.</nobr></div>
<div style="position:absolute;top:4624;left:133"><nobr>We are more interested in misuse detection [10], which assumes that attacks are well-known se-</nobr></div>
<div style="position:absolute;top:4645;left:108"><nobr>quences of actions, called scenarios or attack signatures, and that the activity of the system (in the form</nobr></div>
<div style="position:absolute;top:4665;left:108"><nobr>of logs, network traffic, etc.) may be audited in order to determine the presence of such scenarios in the</nobr></div>
<div style="position:absolute;top:4685;left:108"><nobr>system.</nobr></div>
<div style="position:absolute;top:4706;left:133"><nobr>Misuse detection becomes an increasingly demanding task in terms of semantics and processing,</nobr></div>
<div style="position:absolute;top:4726;left:108"><nobr>as more sophisticated attacks are discovered every day [13] (which implies an increasing number of</nobr></div>
<div style="position:absolute;top:4747;left:108"><nobr>sophisticated scenarios to <b style="color:black;background-color:#a0ffff">search</b> for in audit trails). These challenges have lead to a research trend</nobr></div>
<div style="position:absolute;top:4767;left:108"><nobr>aimed to a simplified representation of the problem in order to improve performance and efficiency of</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:4796;left:108"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:4798;left:113"><nobr>The reason is that it strongly relies on the fact that consecutive cells in the dynamic programming matrix differ at most by 1,</nobr></div>
<div style="position:absolute;top:4814;left:108"><nobr>which permits representing a column using</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:4816;left:343"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:4814;left:349"><nobr>m bits, which is not possible when only insertions are permitted.</nobr></div>
</span></font>

<div style="position:absolute;top:4927;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=5><b>Page 5</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:5072;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:5072;left:765"><nobr>1005</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5123;left:112"><nobr>detection. In the short term, effective intrusion detection systems will incorporate a number of techniques</nobr></div>
<div style="position:absolute;top:5143;left:112"><nobr>rather than a “one-strategy-fits-all” approach. The greater the variety of available tools is, the better the</nobr></div>
<div style="position:absolute;top:5164;left:112"><nobr>intrusion detection system is.</nobr></div>
<div style="position:absolute;top:5185;left:138"><nobr>In general terms, the misuse detection problem is to detect the existence of a priori known series of</nobr></div>
<div style="position:absolute;top:5205;left:112"><nobr>events within the traces of activity of a system to protect. Traces widely differ in their origin, form and</nobr></div>
<div style="position:absolute;top:5225;left:112"><nobr>content, depending on the type of potential attacks that they attempt to cover. For example, traces in</nobr></div>
<div style="position:absolute;top:5246;left:112"><nobr>the form of network traffic collected by a firewall or a sniffer may be used to detect well-known attacks</nobr></div>
<div style="position:absolute;top:5266;left:112"><nobr>to implementations of a TCP/IP protocol stack. Another example are the logs of commands typed by</nobr></div>
<div style="position:absolute;top:5286;left:112"><nobr>users of a multi-user computer. In both cases, traces may be collected at a single place (<i>e.g.</i>, an ethernet</nobr></div>
<div style="position:absolute;top:5307;left:112"><nobr>segment, a host computer) or at <b style="color:black;background-color:#ff9999">multiple</b> locations simultaneously. We consider the detection of attacks</nobr></div>
<div style="position:absolute;top:5327;left:112"><nobr>using logs (audit trails) of commands typed by users of a distributed computer system.</nobr></div>
<div style="position:absolute;top:5348;left:138"><nobr>A recent approach [18, 16] to the problem of handling a <b style="color:black;background-color:#a0ffff">search</b> of increasing complexity and magni-</nobr></div>
<div style="position:absolute;top:5368;left:112"><nobr>tude is to develop systems for fast detection of potential attacks rather that accurate detection of actual</nobr></div>
<div style="position:absolute;top:5389;left:112"><nobr>attacks. The results of such a detection (<i>i.e.</i>, filtered audit trails, in which attacks may be present) would</nobr></div>
<div style="position:absolute;top:5409;left:112"><nobr>be used in turn as input for a more accurate (and slower) detection <b style="color:black;background-color:#99ff99">algorithm</b>.</nobr></div>
<div style="position:absolute;top:5430;left:138"><nobr>Under this approach, the misuse detection problem is modeled as a pattern matching problem in the</nobr></div>
<div style="position:absolute;top:5450;left:112"><nobr>following way: auditable commands in the system can be seen as characters of an alphabet and the</nobr></div>
<div style="position:absolute;top:5471;left:112"><nobr>audit trail as a large <b style="color:black;background-color:#ffff66">string</b> of characters in (<i>i.e.</i>, the text). The sequences of events representing attacks</nobr></div>
<div style="position:absolute;top:5491;left:112"><nobr>to be detected are then substrings (<i>i.e.</i>, patterns) to be located in the main <b style="color:black;background-color:#ffff66">string</b>. Since attackers may</nobr></div>
<div style="position:absolute;top:5511;left:112"><nobr>introduce spurious commands among those that represent an actual attack in order to disperse their evi-</nobr></div>
<div style="position:absolute;top:5532;left:112"><nobr>dence, a limited number of spurious characters must be allowed when searching for the pattern. Since the</nobr></div>
<div style="position:absolute;top:5552;left:112"><nobr>number of known attacks to system vulnerabilities is large, we are interested in simultaneously searching</nobr></div>
<div style="position:absolute;top:5572;left:112"><nobr>for a set of patterns. Thus, the misuse detection problem can be regarded as a particular case of the</nobr></div>
<div style="position:absolute;top:5593;left:112"><nobr><b style="color:black;background-color:#ff9999">multiple</b> approximate pattern matching problem, where insertion in the pattern is the only allowed edit</nobr></div>
<div style="position:absolute;top:5613;left:112"><nobr>operation. Figure 1 illustrates our model to map the misuse detection problem as a <b style="color:black;background-color:#ff9999">multiple</b> approximate</nobr></div>
<div style="position:absolute;top:5633;left:112"><nobr>pattern matching problem.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:5685;left:112"><nobr><b>3. The Insertion Distance and a Naive <b style="color:black;background-color:#99ff99">Algorithm</b></b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5729;left:112"><nobr>Our problem can be modeled using the concept of <i>insertion distance</i>. The insertion distance from a to b,</nobr></div>
<div style="position:absolute;top:5749;left:112"><nobr>denoted id</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5751;left:181"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5749;left:186"><nobr>a;b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5751;left:211"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5749;left:216"><nobr>, is the number of insertions necessary to convert a into b. We say that id</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5751;left:700"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5749;left:705"><nobr>a;b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5751;left:730"><nobr>) =</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:5741;left:754"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5749;left:772"><nobr>if</nobr></div>
<div style="position:absolute;top:5770;left:112"><nobr>conversion is not feasible. Clearly, id</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5771;left:355"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5769;left:359"><nobr>a;b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5771;left:385"><nobr>) =</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:5762;left:407"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5769;left:412"><nobr>b</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:5762;left:421"><nobr>j j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5769;left:446"><nobr>a</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:5762;left:455"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5770;left:464"><nobr>if a is a subsequence of b, and</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:5762;left:667"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5770;left:685"><nobr>otherwise.</nobr></div>
<div style="position:absolute;top:5791;left:138"><nobr>A related definition arises when we <b style="color:black;background-color:#a0ffff">search</b> for a pattern P in a text T allowing insertions. At each</nobr></div>
<div style="position:absolute;top:5811;left:112"><nobr>text position j</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:5803;left:209"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5813;left:228"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5811;left:235"><nobr>::n we are interested in the minimum number of insertions needed to convert P into</nobr></div>
<div style="position:absolute;top:5831;left:112"><nobr>some suffix of T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:5839;left:219"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5837;left:225"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5831;left:239"><nobr>. This is defined as</nobr></div>
<div style="position:absolute;top:5870;left:333"><nobr>lid</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5872;left:349"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5870;left:354"><nobr>P;T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:5878;left:386"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5876;left:392"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5872;left:406"><nobr>) =</nobr></div>
<div style="position:absolute;top:5872;left:452"><nobr>min</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5884;left:454"><nobr>j</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:5px;font-family:Times">
<div style="position:absolute;top:5886;left:460"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:5885;left:464"><nobr>2</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:5886;left:470"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5884;left:476"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5870;left:494"><nobr>id</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5872;left:507"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5870;left:511"><nobr>P;T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5876;left:542"><nobr>j</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:5px;font-family:Times">
<div style="position:absolute;top:5878;left:548"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5876;left:552"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5872;left:566"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5917;left:138"><nobr>The <b style="color:black;background-color:#a0ffff">search</b> problem can therefore be formalized as follows: given P, T and k, report all text positions</nobr></div>
<div style="position:absolute;top:5937;left:112"><nobr>j such that lid</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5939;left:200"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5937;left:205"><nobr>P;T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:5945;left:240"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5943;left:246"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5939;left:260"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5937;left:281"><nobr>k.</nobr></div>
<div style="position:absolute;top:5959;left:138"><nobr>An immediate solution to the problem comes from adapting a dynamic programming <b style="color:black;background-color:#99ff99">algorithm</b> for</nobr></div>
<div style="position:absolute;top:5979;left:112"><nobr>k differences [27]. A vector of values C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5985;left:386"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5979;left:397"><nobr>(i</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:5971;left:413"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5981;left:434"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5979;left:442"><nobr>::m) is updated for each new text character T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:5985;left:747"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5979;left:754"><nobr>. The</nobr></div>
<div style="position:absolute;top:5999;left:112"><nobr>invariant is that, after processing text position j, C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6005;left:456"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6001;left:469"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5999;left:485"><nobr>lid</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6001;left:502"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5999;left:506"><nobr>P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6007;left:526"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6005;left:532"><nobr>::i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5999;left:544"><nobr>;T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6007;left:561"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6005;left:567"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6001;left:581"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:5999;left:586"><nobr>. Therefore, we report all text</nobr></div>
</span></font>

<div style="position:absolute;top:6115;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=6><b>Page 6</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:6260;left:108"><nobr>1006</nobr></div>
<div style="position:absolute;top:6260;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:6519;left:162"><nobr>mknod</nobr></div>
<div style="position:absolute;top:6532;left:162"><nobr>xterm</nobr></div>
<div style="position:absolute;top:6544;left:162"><nobr>mv</nobr></div>
<div style="position:absolute;top:6557;left:162"><nobr>ln</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6499;left:162"><nobr><b>Attack 1</b></nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:6602;left:162"><nobr>cp</nobr></div>
<div style="position:absolute;top:6615;left:162"><nobr>chmod</nobr></div>
<div style="position:absolute;top:6628;left:162"><nobr>touch</nobr></div>
<div style="position:absolute;top:6641;left:162"><nobr>mail</nobr></div>
<div style="position:absolute;top:6654;left:162"><nobr>rm</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6583;left:162"><nobr><b>Attack 2</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:6307;left:168"><nobr><b>Audit</b></nobr></div>
<div style="position:absolute;top:6324;left:171"><nobr><b>Trail</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6412;left:166"><nobr>6:chmod</nobr></div>
<div style="position:absolute;top:6425;left:166"><nobr>7:ln</nobr></div>
<div style="position:absolute;top:6438;left:166"><nobr>8:touch</nobr></div>
<div style="position:absolute;top:6387;left:166"><nobr>4:mail</nobr></div>
<div style="position:absolute;top:6348;left:166"><nobr>1:chmod</nobr></div>
<div style="position:absolute;top:6361;left:166"><nobr>2:ln</nobr></div>
<div style="position:absolute;top:6374;left:166"><nobr>3:cp</nobr></div>
<div style="position:absolute;top:6399;left:166"><nobr>5:xterm</nobr></div>
<div style="position:absolute;top:6450;left:166"><nobr>9:mv</nobr></div>
<div style="position:absolute;top:6463;left:166"><nobr>10:rm</nobr></div>
<div style="position:absolute;top:6515;left:413"><nobr><b>attack 1: cdeb</b></nobr></div>
<div style="position:absolute;top:6528;left:413"><nobr><b>attack 2: faghi</b></nobr></div>
<div style="position:absolute;top:6440;left:413"><nobr><b>Audit trail:</b></nobr></div>
<div style="position:absolute;top:6457;left:413"><nobr><b>...abfhdabgei...</b></nobr></div>
<div style="position:absolute;top:6442;left:378"><nobr>a</nobr></div>
<div style="position:absolute;top:6455;left:378"><nobr>b</nobr></div>
<div style="position:absolute;top:6468;left:378"><nobr>c</nobr></div>
<div style="position:absolute;top:6481;left:378"><nobr>d</nobr></div>
<div style="position:absolute;top:6493;left:378"><nobr>e</nobr></div>
<div style="position:absolute;top:6519;left:378"><nobr>g</nobr></div>
<div style="position:absolute;top:6532;left:378"><nobr>h</nobr></div>
<div style="position:absolute;top:6545;left:378"><nobr>i</nobr></div>
<div style="position:absolute;top:6506;left:378"><nobr>f</nobr></div>
<div style="position:absolute;top:6442;left:309"><nobr>chmod</nobr></div>
<div style="position:absolute;top:6455;left:309"><nobr>ln</nobr></div>
<div style="position:absolute;top:6468;left:309"><nobr>mknod</nobr></div>
<div style="position:absolute;top:6481;left:309"><nobr>xterm</nobr></div>
<div style="position:absolute;top:6493;left:309"><nobr>mv</nobr></div>
<div style="position:absolute;top:6506;left:309"><nobr>cp</nobr></div>
<div style="position:absolute;top:6519;left:309"><nobr>touch</nobr></div>
<div style="position:absolute;top:6532;left:309"><nobr>mail</nobr></div>
<div style="position:absolute;top:6545;left:309"><nobr>rm</nobr></div>
<div style="position:absolute;top:6411;left:323"><nobr>...</nobr></div>
<div style="position:absolute;top:6550;left:323"><nobr>...</nobr></div>
<div style="position:absolute;top:6411;left:378"><nobr>...</nobr></div>
<div style="position:absolute;top:6550;left:378"><nobr>...</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:6387;left:404"><nobr><b>Mapping</b></nobr></div>
</span></font>
<font size=3 color="#ffffff" face="Times"><span style="font-size:11px;font-family:Times;color:#ffffff">
<div style="position:absolute;top:6432;left:633"><nobr><b>Approximate</b></nobr></div>
<div style="position:absolute;top:6450;left:615"><nobr><b>Pattern Matching</b></nobr></div>
<div style="position:absolute;top:6415;left:650"><nobr><b><b style="color:black;background-color:#ff9999">Multiple</b></b></nobr></div>
<div style="position:absolute;top:6467;left:643"><nobr><b><b style="color:black;background-color:#99ff99">Algorithm</b></b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6603;left:612"><nobr>[ cdeb  ][  65 ]</nobr></div>
<div style="position:absolute;top:6654;left:612"><nobr>[ faghi ][  99 ]</nobr></div>
<div style="position:absolute;top:6662;left:668"><nobr>...</nobr></div>
<div style="position:absolute;top:6615;left:612"><nobr>[ cdeb  ][ 163 ]</nobr></div>
<div style="position:absolute;top:6628;left:612"><nobr>[ faghi ][  32 ]</nobr></div>
<div style="position:absolute;top:6641;left:612"><nobr>[ cdeb  ][ 115 ]</nobr></div>
<div style="position:absolute;top:6568;left:668"><nobr>...</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:6558;left:655"><nobr><b>matches</b></nobr></div>
<div style="position:absolute;top:6544;left:653"><nobr><b>Reported</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6717;left:237"><nobr>Figure 1. A model for intrusion detection based on pattern matching.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6774;left:108"><nobr>positions j satisfying C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6779;left:265"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6774;left:297"><nobr>k. Initially (for j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6776;left:415"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6774;left:438"><nobr>) we have C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6781;left:535"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6776;left:548"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6774;left:576"><nobr>and C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6779;left:621"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6776;left:633"><nobr>=</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:6766;left:647"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6774;left:666"><nobr>for i &gt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6776;left:716"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6774;left:724"><nobr>. When</nobr></div>
<div style="position:absolute;top:6794;left:108"><nobr>reading the text character T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6800;left:287"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6794;left:298"><nobr>the C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6800;left:334"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6794;left:343"><nobr>values are updated to the new C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:6792;left:553"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6802;left:552"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6794;left:561"><nobr>values using the formula</nobr></div>
<div style="position:absolute;top:6832;left:257"><nobr>C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:6829;left:270"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6839;left:268"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6834;left:286"><nobr>= if (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6832;left:325"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6838;left:344"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6834;left:353"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6832;left:366"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6838;left:380"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6834;left:387"><nobr>) then min(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6832;left:457"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6838;left:481"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6839;left:487"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6832;left:502"><nobr>;C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6838;left:521"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6834;left:530"><nobr>+ 1) else</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6832;left:589"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6838;left:606"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6834;left:615"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6832;left:765"><nobr>(1)</nobr></div>
<div style="position:absolute;top:6870;left:108"><nobr>which has the following rationale: if the new text character T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6876;left:526"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6870;left:539"><nobr>does not match P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6876;left:657"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6870;left:663"><nobr>, then we keep the</nobr></div>
<div style="position:absolute;top:6890;left:108"><nobr>previous match of P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6896;left:242"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6890;left:252"><nobr>in a suffix of T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6898;left:350"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6896;left:356"><nobr>::j</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6898;left:370"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6890;left:391"><nobr>(the cost is C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6896;left:479"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6890;left:484"><nobr>) and add an insertion to reflect that undesired</nobr></div>
<div style="position:absolute;top:6911;left:108"><nobr>last character T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6916;left:209"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6911;left:216"><nobr>. If, on the other hand, the new text character matches P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6916;left:589"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6911;left:599"><nobr>then we have also the choice</nobr></div>
<div style="position:absolute;top:6931;left:108"><nobr>of using it and matching P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6938;left:282"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6937;left:288"><nobr>::i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6938;left:301"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6931;left:320"><nobr>with the best suffix of T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6938;left:476"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6937;left:482"><nobr>::j</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6938;left:496"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6931;left:517"><nobr>(the cost is C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:6937;left:603"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:6938;left:609"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6931;left:625"><nobr>).</nobr></div>
<div style="position:absolute;top:6952;left:133"><nobr>This <b style="color:black;background-color:#99ff99">algorithm</b> is O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6953;left:262"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6952;left:267"><nobr>mn</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6953;left:289"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6952;left:298"><nobr>time and O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6953;left:372"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6952;left:377"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6953;left:390"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:6952;left:399"><nobr>space.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:7001;left:108"><nobr><b>4. A Bit-parallel Simulation</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7045;left:108"><nobr>Bit-parallelism is a technique of common use in <b style="color:black;background-color:#ffff66">string</b> matching [2], firstly proposed in [1, 3]. The</nobr></div>
<div style="position:absolute;top:7065;left:108"><nobr>technique consists in taking advantage of the intrinsic parallelism of the bit operations inside a computer</nobr></div>
<div style="position:absolute;top:7085;left:108"><nobr>word. By using cleverly this fact, the number of operations that an <b style="color:black;background-color:#99ff99">algorithm</b> performs can be cut down by</nobr></div>
<div style="position:absolute;top:7106;left:108"><nobr>a factor of at most w, where w is the number of bits in the computer word. Since in current architectures</nobr></div>
<div style="position:absolute;top:7126;left:108"><nobr>w is 32 or 64, the speedup is very significant in practice (and improves with technological progress).</nobr></div>
<div style="position:absolute;top:7147;left:133"><nobr>We introduce now some notation we use for bit-parallel algorithms. We denote as b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7152;left:699"><nobr>s</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7146;left:706"><nobr>:::b</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7154;left:726"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7147;left:739"><nobr>the bits</nobr></div>
<div style="position:absolute;top:7167;left:108"><nobr>of a mask of length s. We use exponentiation to denote bit repetition (<i>e.g.</i>,</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7169;left:616"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7166;left:625"><nobr>3</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7169;left:632"><nobr>1 = 0001</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7167;left:694"><nobr>). We use C-</nobr></div>
<div style="position:absolute;top:7187;left:108"><nobr>like syntax for operations on the bits of computer words: “</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:7180;left:501"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7187;left:506"><nobr>” is the bitwise-or, “&amp;” is the bitwise-and,</nobr></div>
</span></font>

<div style="position:absolute;top:7303;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=7><b>Page 7</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:7448;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:7448;left:765"><nobr>1007</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7499;left:112"><nobr>“</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:26px;font-family:Times">
<div style="position:absolute;top:7487;left:123"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7499;left:142"><nobr>” is the bitwise-xor and “ ” complements all the bits. The shift-left operation, “&lt;&lt;”, moves the</nobr></div>
<div style="position:absolute;top:7519;left:112"><nobr>bits to the left and enters zeros from the right, <i>i.e.</i>, b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7525;left:465"><nobr>s</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7519;left:471"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7525;left:478"><nobr>s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7527;left:488"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7519;left:501"><nobr>:::b</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7527;left:522"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7519;left:529"><nobr>b</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7527;left:536"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7519;left:550"><nobr>&lt;&lt; r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7521;left:594"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7519;left:614"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7525;left:635"><nobr>s r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7519;left:657"><nobr>:::b</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7527;left:678"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7519;left:685"><nobr>b</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7527;left:692"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7521;left:699"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7516;left:707"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7519;left:714"><nobr>. The shift-</nobr></div>
<div style="position:absolute;top:7540;left:112"><nobr>right operation, “&gt;&gt;”, moves the bits to the right and enters zeros from the left, <i>i.e.</i>, b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7545;left:683"><nobr>s</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7539;left:690"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7545;left:697"><nobr>s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7547;left:706"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7539;left:720"><nobr>:::b</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7547;left:740"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7539;left:747"><nobr>b</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7547;left:754"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7539;left:767"><nobr>&lt;&lt;</nobr></div>
<div style="position:absolute;top:7560;left:112"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7562;left:131"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7557;left:167"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7560;left:174"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7565;left:181"><nobr>s</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7560;left:187"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7565;left:194"><nobr>s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7567;left:204"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7560;left:217"><nobr>:::b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7565;left:238"><nobr>s r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7567;left:252"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7560;left:277"><nobr>. Finally, we can perform arithmetic operations on the bits, such as addition</nobr></div>
<div style="position:absolute;top:7580;left:112"><nobr>and subtraction, which operates the bits as if they formed a number. For instance, b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7586;left:668"><nobr>s</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7580;left:675"><nobr>:::b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7586;left:696"><nobr>x</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7582;left:704"><nobr>10000 1 =</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7600;left:112"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7606;left:119"><nobr>s</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7600;left:126"><nobr>:::b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7606;left:146"><nobr>x</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7602;left:154"><nobr>01111</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7601;left:194"><nobr>.</nobr></div>
<div style="position:absolute;top:7621;left:138"><nobr>Many text searching algorithms can be seen as implementations of clever automata (classically, in</nobr></div>
<div style="position:absolute;top:7642;left:112"><nobr>their deterministic form). Bit-parallelism has since its invention become a general way to simulate simple</nobr></div>
<div style="position:absolute;top:7662;left:112"><nobr>non-deterministic automata instead of converting them to deterministic. It has the advantage of being</nobr></div>
<div style="position:absolute;top:7682;left:112"><nobr>much simpler, in many cases faster (since it makes better usage of the computer registers), and easier to</nobr></div>
<div style="position:absolute;top:7703;left:112"><nobr>extend to handle complex patterns than its classical counterparts. Its main disadvantage is the limitations</nobr></div>
<div style="position:absolute;top:7723;left:112"><nobr>it imposes with regard to the size of the computer word. In many cases its adaptations to cope with</nobr></div>
<div style="position:absolute;top:7743;left:112"><nobr>longer patterns are not so efficient. For our application, in particular, bit-parallelism seems to be a very</nobr></div>
<div style="position:absolute;top:7764;left:112"><nobr>promising approach.</nobr></div>
<div style="position:absolute;top:7785;left:138"><nobr>We show now how we can pack the C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7790;left:383"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7785;left:392"><nobr>values of Section 3 in the bits of a computer word to speed up</nobr></div>
<div style="position:absolute;top:7805;left:112"><nobr>the <b style="color:black;background-color:#a0ffff">search</b>. Only the values from zero to k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7807;left:388"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7805;left:411"><nobr>are of interest, since if a C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7810;left:588"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7805;left:597"><nobr>value is larger than k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7807;left:736"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7805;left:759"><nobr>then</nobr></div>
<div style="position:absolute;top:7825;left:112"><nobr>the outcome of the <b style="color:black;background-color:#a0ffff">search</b> is the same if we replace it by k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7827;left:491"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7825;left:510"><nobr>. Therefore, we use ‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7827;left:648"><nobr>=</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:7817;left:660"><nobr>d</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7827;left:674"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7834;left:703"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7827;left:710"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7825;left:714"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7827;left:726"><nobr>+ 1)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:7817;left:749"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7825;left:767"><nobr>bits</nobr></div>
<div style="position:absolute;top:7846;left:112"><nobr>to hold each C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7851;left:208"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7846;left:217"><nobr>value, plus an extra overflow bit whose purpose is made clear shortly.</nobr></div>
<div style="position:absolute;top:7866;left:138"><nobr>Taking minima in parallel is not impossible, but it is difficult. We show that the update formula (1)</nobr></div>
<div style="position:absolute;top:7887;left:112"><nobr>can be modified to avoid taking minima. First note that C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7892;left:499"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7894;left:506"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7886;left:540"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7892;left:558"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7888;left:567"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7887;left:587"><nobr>. That is, lid</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7888;left:671"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7886;left:676"><nobr>P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7894;left:696"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7892;left:702"><nobr>::i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7894;left:715"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7886;left:730"><nobr>;T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7894;left:747"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7892;left:753"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7888;left:767"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7907;left:112"><nobr>lid</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7909;left:129"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7907;left:134"><nobr>P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7914;left:148"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7912;left:154"><nobr>::i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7907;left:167"><nobr>;T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7914;left:184"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7912;left:190"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7909;left:204"><nobr>) + 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7907;left:232"><nobr>. This is clear, since any match of P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7914;left:475"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7912;left:481"><nobr>::i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7907;left:498"><nobr>against a suffix of T</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7914;left:628"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7912;left:634"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7907;left:653"><nobr>can be converted into</nobr></div>
<div style="position:absolute;top:7927;left:112"><nobr>a match of P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7935;left:195"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7933;left:201"><nobr>::i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7935;left:214"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7927;left:234"><nobr>just by removing the alignment of P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7933;left:469"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7927;left:478"><nobr>and considering it as an extra insertion (the</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7929;left:761"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7927;left:778"><nobr>).</nobr></div>
<div style="position:absolute;top:7948;left:112"><nobr>Hence the best alignment must be at most of that cost. Therefore, Eq. (1) is equivalent to</nobr></div>
<div style="position:absolute;top:7985;left:308"><nobr>C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:7983;left:321"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7993;left:320"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7987;left:338"><nobr>= if (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7985;left:376"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7991;left:395"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7987;left:405"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7985;left:418"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7991;left:432"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7987;left:438"><nobr>) then</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7985;left:479"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7991;left:496"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:7993;left:503"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7987;left:522"><nobr>else</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:7985;left:552"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:7991;left:563"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7987;left:572"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8024;left:112"><nobr>which we now parallelize. We precompute a table B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8026;left:462"><nobr>:</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:8016;left:483"><nobr>! f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8026;left:501"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8024;left:509"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8026;left:516"><nobr>1</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:8016;left:524"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8021;left:555"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8023;left:565"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8021;left:569"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8023;left:572"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8024;left:598"><nobr>, defined as</nobr></div>
<div style="position:absolute;top:8062;left:253"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:265"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:269"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:277"><nobr>] = 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:326"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:335"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:340"><nobr>c;P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8067;left:371"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:383"><nobr>) 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:408"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:417"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:422"><nobr>c;P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8067;left:448"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8069;left:462"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:476"><nobr>)</nobr></div>
<div style="position:absolute;top:8064;left:520"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:532"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:541"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:546"><nobr>c;P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8069;left:566"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:573"><nobr>) 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:598"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:607"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8062;left:612"><nobr>c;P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8069;left:638"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8064;left:645"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:112"><nobr>where b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8102;left:166"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:170"><nobr>c;c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8102;left:194"><nobr>) = 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8097;left:229"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:240"><nobr>and b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8102;left:276"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:281"><nobr>c;c</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:8098;left:302"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8102;left:307"><nobr>) = 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8097;left:344"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:355"><nobr>for c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:8092;left:391"><nobr>6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8102;left:405"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:418"><nobr>c</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:8098;left:415"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:420"><nobr>. That is, B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8102;left:495"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:499"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8102;left:507"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8100;left:516"><nobr>has m chunks of zeros or ones, indicating</nobr></div>
<div style="position:absolute;top:8121;left:112"><nobr>which pattern positions match character c. The idea is to use B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8122;left:545"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8120;left:549"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8122;left:557"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8121;left:567"><nobr>to implement the test</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8122;left:714"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8120;left:719"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8126;left:733"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8122;left:746"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8120;left:761"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8126;left:775"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8122;left:782"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8121;left:787"><nobr>,</nobr></div>
<div style="position:absolute;top:8141;left:112"><nobr>assigning C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8146;left:190"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8148;left:196"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8141;left:215"><nobr>where it has ones and leaving C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8146;left:424"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8143;left:433"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8141;left:456"><nobr>where it has zeros.</nobr></div>
<div style="position:absolute;top:8162;left:138"><nobr>The state of the <b style="color:black;background-color:#a0ffff">search</b> is kept in a bit mask D, composed of m chunks of ‘ bits each (plus the</nobr></div>
<div style="position:absolute;top:8182;left:112"><nobr>overflow bit), so that the i-th chunk stores the current C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8188;left:476"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8182;left:485"><nobr>value, <i>i.e.</i>,</nobr></div>
<div style="position:absolute;top:8220;left:292"><nobr>D</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8222;left:317"><nobr>= 0 [</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8220;left:354"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8226;left:373"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8222;left:385"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8226;left:390"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8222;left:404"><nobr>0 [</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8220;left:420"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8226;left:432"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8228;left:446"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8222;left:461"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8226;left:465"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8222;left:518"><nobr>0 [</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8220;left:534"><nobr>C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8228;left:540"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8222;left:548"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8226;left:552"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8222;left:566"><nobr>0 [</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8220;left:582"><nobr>C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8228;left:595"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8222;left:602"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8226;left:606"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8258;left:112"><nobr>where</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8260;left:158"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8258;left:162"><nobr>x</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8260;left:170"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8264;left:176"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8258;left:187"><nobr>is the number x represented in ‘ bits in the usual way (right-aligned). Note that C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8266;left:743"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8258;left:755"><nobr>is not</nobr></div>
<div style="position:absolute;top:8279;left:112"><nobr>represented because it is always zero. In principle, the update formula could be as simple as</nobr></div>
<div style="position:absolute;top:8317;left:236"><nobr>D</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:8314;left:250"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:267"><nobr>= (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8317;left:292"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:304"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8317;left:308"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8322;left:326"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:332"><nobr>] &amp; (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8317;left:359"><nobr>D &lt;&lt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:399"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8317;left:403"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:411"><nobr>+ 1)))</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:8309;left:449"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:458"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8317;left:474"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:486"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8317;left:490"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8322;left:537"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:543"><nobr>] &amp; (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8317;left:570"><nobr>D</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:586"><nobr>+ (0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8313;left:624"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:630"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8313;left:644"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8319;left:656"><nobr>))</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8355;left:112"><nobr>where B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8357;left:168"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8355;left:172"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8361;left:184"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8357;left:190"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8355;left:198"><nobr>is being used to select between</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8357;left:403"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8355;left:408"><nobr>D &lt;&lt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8357;left:448"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8355;left:453"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8357;left:460"><nobr>+ 1))</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8355;left:492"><nobr>(which puts the previous value C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8361;left:732"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8362;left:738"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8355;left:757"><nobr>at the</nobr></div>
<div style="position:absolute;top:8375;left:112"><nobr>i-th chunk) and</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8377;left:215"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8375;left:220"><nobr>D</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8377;left:236"><nobr>+ (0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8372;left:273"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8377;left:278"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8372;left:293"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8377;left:305"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8375;left:314"><nobr>(which adds 1 to the current C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8381;left:515"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8375;left:524"><nobr>values). In particular, the left shift brings</nobr></div>
</span></font>

<div style="position:absolute;top:8491;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=8><b>Page 8</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:8636;left:108"><nobr>1008</nobr></div>
<div style="position:absolute;top:8636;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8687;left:108"><nobr>zero bits to the first chunk C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8694;left:293"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8687;left:300"><nobr>, which is adequate since C</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8694;left:478"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8689;left:489"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8687;left:510"><nobr>. The problem with this scheme is that the</nobr></div>
<div style="position:absolute;top:8707;left:108"><nobr>C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8713;left:120"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8707;left:129"><nobr>values could surpass the barrier of k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8709;left:368"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8707;left:388"><nobr>.</nobr></div>
<div style="position:absolute;top:8729;left:133"><nobr>To overcome the problem we use the overflow bit. We let the C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8735;left:559"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8729;left:569"><nobr>values grow over k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8731;left:700"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8729;left:725"><nobr>provided</nobr></div>
<div style="position:absolute;top:8750;left:108"><nobr>they fit in ‘ bits. As soon as they overflow, the overflow bit will be set. At this point, we subtract one</nobr></div>
<div style="position:absolute;top:8770;left:108"><nobr>to them. The easiest way to subtract one to all the C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8775;left:460"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8770;left:470"><nobr>values whose overflow bit is set is to isolate the</nobr></div>
<div style="position:absolute;top:8790;left:108"><nobr>overflow bits, shift them ‘ positions to the right and subtract the mask from D.</nobr></div>
<div style="position:absolute;top:8812;left:133"><nobr>The final problem is how to determine the text positions that match. In the dynamic programming</nobr></div>
<div style="position:absolute;top:8832;left:108"><nobr>version we simply check C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8838;left:289"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8832;left:320"><nobr>k. In the bit-parallel version the C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8838;left:557"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8832;left:574"><nobr>value corresponds to the highest</nobr></div>
<div style="position:absolute;top:8853;left:108"><nobr>bits, and therefore we can numerically compare the whole bit mask D against</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8854;left:634"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8852;left:638"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8854;left:647"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8858;left:655"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8854;left:661"><nobr>1</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8852;left:669"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8850;left:673"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8852;left:676"><nobr>+1)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8850;left:695"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:8852;left:709"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8853;left:739"><nobr>, which</nobr></div>
<div style="position:absolute;top:8873;left:108"><nobr>avoids any additional bit shift or masking. We also want to report only text positions that end a genuine</nobr></div>
<div style="position:absolute;top:8893;left:108"><nobr>match, <i>i.e.</i>, such that the last text character matches the last pattern character. Otherwise we would be</nobr></div>
<div style="position:absolute;top:8914;left:108"><nobr>reporting trivial extensions of previously found matches. This can be determined by looking at the m-th</nobr></div>
<div style="position:absolute;top:8934;left:108"><nobr>chunk of B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8936;left:181"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8934;left:185"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:8940;left:197"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8936;left:204"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:8934;left:208"><nobr>. The complete <b style="color:black;background-color:#99ff99">algorithm</b> is shown in Figure 2.</nobr></div>
<div style="position:absolute;top:8973;left:151"><nobr><b style="color:black;background-color:#a0ffff">Search</b> (T,n,P,m,k)</nobr></div>
<div style="position:absolute;top:9014;left:237"><nobr>/* <b style="color:white;background-color:#880000">Preprocessing</b> */</nobr></div>
<div style="position:absolute;top:9034;left:117"><nobr>1.</nobr></div>
<div style="position:absolute;top:9035;left:173"><nobr>‘</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9028;left:193"><nobr>d</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9037;left:206"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9044;left:237"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9037;left:244"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9035;left:249"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9037;left:262"><nobr>+ 1)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9028;left:286"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9055;left:117"><nobr>2.</nobr></div>
<div style="position:absolute;top:9055;left:173"><nobr>for c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9048;left:214"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9055;left:244"><nobr>do B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9058;left:283"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9056;left:287"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9058;left:295"><nobr>] 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9053;left:347"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9055;left:358"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9053;left:362"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9055;left:365"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9076;left:117"><nobr>3.</nobr></div>
<div style="position:absolute;top:9076;left:173"><nobr>for i</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9069;left:210"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9078;left:227"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9076;left:235"><nobr>::m do</nobr></div>
<div style="position:absolute;top:9097;left:117"><nobr>4.</nobr></div>
<div style="position:absolute;top:9097;left:199"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9099;left:211"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9097;left:215"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9103;left:231"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9099;left:236"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9097;left:256"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9099;left:267"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9097;left:271"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9103;left:294"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9099;left:299"><nobr>]</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9090;left:312"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9099;left:326"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9096;left:334"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9095;left:337"><nobr>m i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9096;left:354"><nobr>)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9095;left:361"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9096;left:364"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9099;left:401"><nobr>01</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9095;left:417"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9099;left:423"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9096;left:431"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9095;left:435"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9096;left:441"><nobr>1)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9095;left:454"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9096;left:457"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9117;left:237"><nobr>/* Searching */</nobr></div>
<div style="position:absolute;top:9137;left:117"><nobr>5.</nobr></div>
<div style="position:absolute;top:9137;left:173"><nobr>for j</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9130;left:211"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9140;left:228"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9138;left:236"><nobr>::n</nobr></div>
<div style="position:absolute;top:9158;left:117"><nobr>6.</nobr></div>
<div style="position:absolute;top:9158;left:199"><nobr>Ds D &lt;&lt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9160;left:275"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9158;left:280"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9160;left:287"><nobr>+ 1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9178;left:117"><nobr>7.</nobr></div>
<div style="position:absolute;top:9179;left:199"><nobr>D D</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9181;left:243"><nobr>+ (0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9176;left:290"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9181;left:296"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9176;left:311"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9198;left:117"><nobr>8.</nobr></div>
<div style="position:absolute;top:9199;left:199"><nobr>D D</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9201;left:253"><nobr>((</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9199;left:263"><nobr>D &gt;&gt; ‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9201;left:306"><nobr>) &amp; (0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9196;left:395"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9201;left:401"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9196;left:415"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9201;left:427"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9219;left:117"><nobr>9.</nobr></div>
<div style="position:absolute;top:9219;left:199"><nobr>D</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9221;left:227"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9219;left:232"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9221;left:243"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9219;left:247"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9225;left:276"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9221;left:282"><nobr>] &amp;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9219;left:313"><nobr>Ds</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9221;left:333"><nobr>)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9212;left:346"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9221;left:360"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9219;left:376"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9221;left:388"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9219;left:392"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9225;left:417"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9221;left:424"><nobr>] &amp;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9219;left:455"><nobr>D</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9221;left:467"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9240;left:108"><nobr>10.</nobr></div>
<div style="position:absolute;top:9240;left:200"><nobr>if</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:217"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9240;left:221"><nobr>D</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:249"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9240;left:253"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:262"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9246;left:289"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:294"><nobr>1</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9239;left:303"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9237;left:306"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9239;left:309"><nobr>+1)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9237;left:329"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9239;left:343"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:372"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9240;left:385"><nobr>and</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:422"><nobr>((</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9240;left:431"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:443"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9240;left:447"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9246;left:461"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:468"><nobr>] &amp; 01</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9237;left:519"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:525"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9239;left:533"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9237;left:537"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9239;left:551"><nobr>1)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9237;left:564"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9239;left:567"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:602"><nobr>)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9233;left:612"><nobr>6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:625"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9237;left:639"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9239;left:649"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9237;left:653"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:9239;left:656"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9242;left:682"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9260;left:108"><nobr>11.</nobr></div>
<div style="position:absolute;top:9260;left:226"><nobr>then report a match ending at j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9313;left:123"><nobr>Figure 2. The bit parallel <b style="color:black;background-color:#99ff99">algorithm</b>. All the constants and repeated expressions are of course precomputed.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9359;left:133"><nobr>If the bits of the simulation do not fit in the computer word we set up as many computer words as</nobr></div>
<div style="position:absolute;top:9379;left:108"><nobr>needed. Since each one is updated in O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9381;left:360"><nobr>(1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9379;left:380"><nobr>time per text character, the total complexity is O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9381;left:689"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9379;left:694"><nobr>nm</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9381;left:719"><nobr>log(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9379;left:743"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9381;left:751"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9379;left:756"><nobr>=w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9381;left:778"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9379;left:782"><nobr>.</nobr></div>
<div style="position:absolute;top:9400;left:108"><nobr>For short patterns (<i>i.e.</i>, m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9401;left:276"><nobr>log</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9400;left:299"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9401;left:312"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9400;left:324"><nobr>O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9401;left:338"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9400;left:342"><nobr>w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9401;left:354"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9400;left:359"><nobr>) this is O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9401;left:425"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9400;left:429"><nobr>n</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9401;left:438"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9400;left:443"><nobr>.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:9457;left:108"><nobr><b>5. A Multipattern Filter</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9502;left:108"><nobr>We show now how to <b style="color:black;background-color:#a0ffff">search</b> for several patterns simultaneously. We will assume that all them have the</nobr></div>
<div style="position:absolute;top:9523;left:108"><nobr>same length m. If this is not the case, a solution is to truncate all to the shortest length, and if a truncated</nobr></div>
<div style="position:absolute;top:9543;left:108"><nobr>pattern is found we must verify for its full occurrence. This solution works well as <b style="color:black;background-color:#ff66ff">long</b> as the differences</nobr></div>
<div style="position:absolute;top:9563;left:108"><nobr>in length are not too large.</nobr></div>
</span></font>

<div style="position:absolute;top:9679;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=9><b>Page 9</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:9824;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:9824;left:765"><nobr>1009</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9875;left:138"><nobr>As already noted in [5, 22], the ability of bit-parallel algorithms to allow classes of characters can be</nobr></div>
<div style="position:absolute;top:9895;left:112"><nobr>used to build multipattern filters. Imagine that the pattern is not a sequence of characters but a sequence</nobr></div>
<div style="position:absolute;top:9916;left:112"><nobr>of <i>classes </i>of characters. A character a is said to match P at position i if a</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:9908;left:602"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9915;left:621"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:9921;left:631"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:9916;left:636"><nobr>, <i>i.e.</i>, if it belongs to the</nobr></div>
<div style="position:absolute;top:9936;left:112"><nobr>corresponding class.</nobr></div>
<div style="position:absolute;top:9956;left:138"><nobr>If we have a pattern which is a sequence of classes of characters, the <b style="color:black;background-color:#99ff99">algorithm</b> of Section 4 can still</nobr></div>
<div style="position:absolute;top:9977;left:112"><nobr>be used, just by changing the <b style="color:white;background-color:#880000">preprocessing</b> phase. The idea is that we can redefine the b function to</nobr></div>
<div style="position:absolute;top:10012;left:315"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10013;left:324"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10012;left:329"><nobr>c;c</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:10009;left:349"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10013;left:354"><nobr>) = 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10008;left:406"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10013;left:417"><nobr>if</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10012;left:429"><nobr>c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10004;left:442"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10012;left:460"><nobr>c</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:10009;left:466"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10013;left:474"><nobr>and 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10008;left:512"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10013;left:523"><nobr>otherwise</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10047;left:112"><nobr>which is equivalent to changing line 4 in Figure 2 to</nobr></div>
<div style="position:absolute;top:10082;left:262"><nobr>4: for c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10075;left:316"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10082;left:334"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10088;left:347"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10082;left:356"><nobr>do B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10084;left:390"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10082;left:394"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10084;left:402"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10082;left:422"><nobr>B</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10084;left:434"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10082;left:438"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10084;left:446"><nobr>]</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10075;left:454"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10084;left:463"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10081;left:482"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10079;left:486"><nobr>m i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10081;left:503"><nobr>)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10079;left:510"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10081;left:513"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10084;left:550"><nobr>01</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10079;left:566"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10084;left:572"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10081;left:580"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10079;left:584"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10081;left:590"><nobr>1)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10079;left:603"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10081;left:606"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10118;left:112"><nobr>that is, we allow the value of C</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10123;left:317"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10125;left:323"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10118;left:343"><nobr>to pass to position i for any character c that matches pattern position</nobr></div>
<div style="position:absolute;top:10138;left:112"><nobr>i.</nobr></div>
<div style="position:absolute;top:10158;left:138"><nobr>Consider now that we have r patterns P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10157;left:397"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10158;left:404"><nobr>:::P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10155;left:430"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10158;left:441"><nobr>of the same length m. From them we generate a much</nobr></div>
<div style="position:absolute;top:10179;left:112"><nobr>more relaxed pattern with classes of characters, which we call the <i>superimposition </i>of P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10178;left:696"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10178;left:703"><nobr>:::P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10176;left:729"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10179;left:736"><nobr>. This is</nobr></div>
<div style="position:absolute;top:10199;left:112"><nobr>defined as</nobr></div>
<div style="position:absolute;top:10219;left:285"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10221;left:311"><nobr>=</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10212;left:332"><nobr>f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10219;left:339"><nobr>P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10218;left:357"><nobr>1</nobr></div>
<div style="position:absolute;top:10228;left:355"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10219;left:364"><nobr>;:::;P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10216;left:405"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10228;left:402"><nobr>1</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10212;left:412"><nobr>gf</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10219;left:436"><nobr>P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10218;left:445"><nobr>1</nobr></div>
<div style="position:absolute;top:10228;left:443"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10219;left:452"><nobr>;:::;P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10216;left:493"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10228;left:491"><nobr>2</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10212;left:500"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10219;left:518"><nobr>:::</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10212;left:535"><nobr>f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10219;left:542"><nobr>P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10218;left:551"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10226;left:549"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10219;left:561"><nobr>;:::;P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10216;left:601"><nobr>r</nobr></div>
<div style="position:absolute;top:10226;left:599"><nobr>m</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10212;left:611"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10249;left:112"><nobr>which necessarily matches when one of the P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10246;left:413"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10249;left:424"><nobr>matches, although the converse is not true. For instance,</nobr></div>
<div style="position:absolute;top:10269;left:112"><nobr>if we <b style="color:black;background-color:#a0ffff">search</b> for &quot;abcd&quot; and &quot;adcc&quot; then the superimposed pattern is &quot;</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10261;left:580"><nobr>f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10268;left:587"><nobr>a</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10261;left:596"><nobr>gf</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10268;left:616"><nobr>b,d</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10261;left:640"><nobr>gf</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10268;left:660"><nobr>c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10261;left:668"><nobr>gf</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10268;left:688"><nobr>d,c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:10261;left:710"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10268;left:724"><nobr>&quot;, and the</nobr></div>
<div style="position:absolute;top:10289;left:112"><nobr>text window &quot;adcd&quot; will match with <i>zero </i>insertions, even if it is not in the set of patterns.</nobr></div>
<div style="position:absolute;top:10310;left:138"><nobr>Therefore, the technique consists in superimposing the <b style="color:black;background-color:#a0ffff">search</b> patterns, <b style="color:black;background-color:#a0ffff">search</b> for the superimposition</nobr></div>
<div style="position:absolute;top:10330;left:112"><nobr>with the same <b style="color:black;background-color:#99ff99">algorithm</b> of Section 4 (as extended in Section 5 to handle classes of characters), and then</nobr></div>
<div style="position:absolute;top:10350;left:112"><nobr>checking the areas where the superimposition is found for the presence of any of the individual patterns.</nobr></div>
<div style="position:absolute;top:10371;left:112"><nobr>That is, each time the <b style="color:black;background-color:#99ff99">algorithm</b> finds the superimposed pattern at text position j, we check each of the</nobr></div>
<div style="position:absolute;top:10391;left:112"><nobr>patterns separately (with the <b style="color:black;background-color:#99ff99">algorithm</b> of Section 4) in the text area T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10397;left:581"><nobr>j m k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10398;left:609"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10397;left:621"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10391;left:655"><nobr>. A similar idea was</nobr></div>
<div style="position:absolute;top:10411;left:112"><nobr>proposed in [5, 22] for the k-differences problem.</nobr></div>
<div style="position:absolute;top:10432;left:138"><nobr>To avoid re-verification due to overlapping areas, we keep track of the last position verified and the</nobr></div>
<div style="position:absolute;top:10452;left:112"><nobr>state of the verification <b style="color:black;background-color:#99ff99">algorithm</b>. If a new verification requirement starts before the last verified position,</nobr></div>
<div style="position:absolute;top:10472;left:112"><nobr>we start the verification from the last verified position, avoiding to re-verify the preceding area.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:10515;left:112"><nobr><b>5.1. Hierarchical Verification</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10548;left:112"><nobr>Instead of checking one by one the patterns for each occurrence of the superimposed pattern, we can</nobr></div>
<div style="position:absolute;top:10569;left:112"><nobr>build up a hierarchy of superimpositions [25, 22]. Imagine that r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10570;left:543"><nobr>= 8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10569;left:564"><nobr>. Then we build, at <b style="color:white;background-color:#880000">preprocessing</b></nobr></div>
<div style="position:absolute;top:10589;left:112"><nobr>time, the superimposition of the 8 patterns, called P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10588;left:450"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10586;left:456"><nobr>::</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10588;left:463"><nobr>8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10589;left:471"><nobr>. We consider this the root of a binary tree, whose</nobr></div>
<div style="position:absolute;top:10609;left:112"><nobr>two children are P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10608;left:238"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10606;left:244"><nobr>::</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10608;left:251"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10609;left:263"><nobr>and P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10608;left:304"><nobr>5</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10606;left:310"><nobr>::</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10608;left:318"><nobr>8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10609;left:325"><nobr>, <i>i.e.</i>, they superimpose only 4 patterns. The first one has two children</nobr></div>
<div style="position:absolute;top:10629;left:112"><nobr>P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10628;left:125"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10627;left:131"><nobr>::</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10628;left:138"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10630;left:150"><nobr>and P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10628;left:192"><nobr>3</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10627;left:198"><nobr>::</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10628;left:205"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10630;left:212"><nobr>, and so on. Finally, the leaves of the tree are the actual patterns. If r is not a power of</nobr></div>
<div style="position:absolute;top:10650;left:112"><nobr>two we build the tree as balanced as possible. Figure 3 illustrates.</nobr></div>
<div style="position:absolute;top:10670;left:138"><nobr>We <b style="color:black;background-color:#a0ffff">search</b> for P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10669;left:246"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10667;left:252"><nobr>::</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10669;left:259"><nobr>8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10670;left:271"><nobr>in the text. When it is found, we do not check immediately all the leaves P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10669;left:768"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10670;left:780"><nobr>to</nobr></div>
<div style="position:absolute;top:10690;left:112"><nobr>P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10689;left:125"><nobr>8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10690;left:132"><nobr>, but just its two children P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10689;left:319"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10687;left:325"><nobr>::</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10689;left:332"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10690;left:345"><nobr>and P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10689;left:386"><nobr>5</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:10687;left:392"><nobr>::</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:10689;left:399"><nobr>8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:10690;left:407"><nobr>. It is possible that, despite that the root was found, none</nobr></div>
<div style="position:absolute;top:10711;left:112"><nobr>of the two children appear (and therefore no leaf can appear as well). So we can avoid performing 8</nobr></div>
<div style="position:absolute;top:10731;left:112"><nobr>verifications at the cost of 2. Of course it is also possible that one and even both of the children appears</nobr></div>
<div style="position:absolute;top:10751;left:112"><nobr>in the text area and then their children have to be checked in turn until the leaves are found (and these</nobr></div>
</span></font>

<div style="position:absolute;top:10867;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=10><b>Page 10</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:11012;left:108"><nobr>1010</nobr></div>
<div style="position:absolute;top:11012;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11060;left:389"><nobr>1</nobr></div>
<div style="position:absolute;top:11070;left:389"><nobr>2</nobr></div>
<div style="position:absolute;top:11081;left:389"><nobr>3</nobr></div>
<div style="position:absolute;top:11091;left:389"><nobr>4</nobr></div>
<div style="position:absolute;top:11149;left:262"><nobr>1</nobr></div>
<div style="position:absolute;top:11160;left:262"><nobr>2</nobr></div>
<div style="position:absolute;top:11149;left:521"><nobr>3</nobr></div>
<div style="position:absolute;top:11160;left:521"><nobr>4</nobr></div>
<div style="position:absolute;top:11202;left:194"><nobr>1</nobr></div>
<div style="position:absolute;top:11202;left:326"><nobr>2</nobr></div>
<div style="position:absolute;top:11202;left:457"><nobr>3</nobr></div>
<div style="position:absolute;top:11202;left:589"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11236;left:254"><nobr>Figure 3. Hierarchical verification for 4 superimposed patterns.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11293;left:108"><nobr>are actually reported). In particular, if a leaf appears it will require all the path of verifications instead</nobr></div>
<div style="position:absolute;top:11314;left:108"><nobr>of a single verification for the root node. However, as we show next, hierarchical verification pays off</nobr></div>
<div style="position:absolute;top:11334;left:108"><nobr>because we rarely reach the root node.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:11382;left:108"><nobr><b>5.2. Analysis</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11418;left:108"><nobr>Superimposing r patterns gives of course better <b style="color:black;background-color:#a0ffff">search</b> time because only one <b style="color:black;background-color:#a0ffff">search</b> is carried out instead</nobr></div>
<div style="position:absolute;top:11438;left:108"><nobr>of r. On the other hand, however, it makes necessary to check the occurrences of the superimposed pat-</nobr></div>
<div style="position:absolute;top:11458;left:108"><nobr>tern for the presence of the actual ones. Moreover, the probability of matching raises as we superimpose</nobr></div>
<div style="position:absolute;top:11479;left:108"><nobr>more patterns, because up to r characters of the alphabet match each pattern position.</nobr></div>
<div style="position:absolute;top:11500;left:133"><nobr>We start by giving an upper bound on the matching probability of a random pattern of length m at</nobr></div>
<div style="position:absolute;top:11520;left:108"><nobr>a given text position, with up to k insertions. Consider a text position j. The pattern P appears with k</nobr></div>
<div style="position:absolute;top:11541;left:108"><nobr>insertions at a text position ending at j if and only if the text window T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11546;left:566"><nobr>j m k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:11548;left:593"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11546;left:606"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11541;left:643"><nobr>contains the m pattern</nobr></div>
<div style="position:absolute;top:11563;left:108"><nobr>characters in order. The window positions that match the pattern characters can be chosen in</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11558;left:753"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:11560;left:763"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11558;left:770"><nobr>k</nobr></div>
<div style="position:absolute;top:11571;left:761"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11583;left:108"><nobr>ways. Those characters are fixed but the other k can take any value. Therefore the probability that the</nobr></div>
<div style="position:absolute;top:11603;left:108"><nobr>text window matches the pattern with k insertions is at most</nobr></div>
<div style="position:absolute;top:11641;left:336"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11643;left:353"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11641;left:364"><nobr>k</nobr></div>
<div style="position:absolute;top:11664;left:350"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11639;left:413"><nobr>k</nobr></div>
<div style="position:absolute;top:11662;left:403"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:11664;left:414"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11662;left:420"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11655;left:450"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11641;left:492"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11643;left:509"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11641;left:521"><nobr>k</nobr></div>
<div style="position:absolute;top:11664;left:506"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11643;left:556"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11662;left:559"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11653;left:769"><nobr>(2)</nobr></div>
<div style="position:absolute;top:11700;left:108"><nobr>where we are overestimating because not all the selections of window positions give different windows.</nobr></div>
<div style="position:absolute;top:11721;left:108"><nobr>For instance the pattern &quot;abcd&quot; matches in text window &quot;abccd&quot; with k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11722;left:582"><nobr>= 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11721;left:607"><nobr>in two ways, but only one</nobr></div>
<div style="position:absolute;top:11741;left:108"><nobr>text window should be counted. In particular, our overestimation includes the case of k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11739;left:680"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11741;left:690"><nobr>&lt; k insertions,</nobr></div>
<div style="position:absolute;top:11761;left:108"><nobr>which is obtained by selecting the first k k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11759;left:398"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11761;left:406"><nobr>characters of the text window as insertions and distributing</nobr></div>
<div style="position:absolute;top:11782;left:108"><nobr>the k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11780;left:141"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11782;left:149"><nobr>remaining insertions in the remaining text window of length m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11783;left:563"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11781;left:575"><nobr>k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11780;left:590"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11782;left:594"><nobr>.</nobr></div>
<div style="position:absolute;top:11803;left:133"><nobr>If we are given r random patterns and superimpose them in groups of r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11801;left:618"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11803;left:622"><nobr>, there are at most r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11801;left:758"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11803;left:767"><nobr>out</nobr></div>
<div style="position:absolute;top:11823;left:108"><nobr>of alphabet characters that will match each pattern position now. The net effect is that of dividing</nobr></div>
<div style="position:absolute;top:11843;left:118"><nobr>by r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11841;left:152"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11843;left:161"><nobr>in the formulas. If we consider that no hierarchical verification is used, then each match of the</nobr></div>
<div style="position:absolute;top:11864;left:108"><nobr>superimposed pattern triggers a verification of r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11862;left:418"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11864;left:425"><nobr>original patterns in a text area of width m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11866;left:691"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11864;left:700"><nobr>k. Therefore</nobr></div>
<div style="position:absolute;top:11884;left:108"><nobr>the total <b style="color:black;background-color:#a0ffff">search</b> cost is on average at most (assuming that each pattern fits in a computer word)</nobr></div>
<div style="position:absolute;top:11921;left:206"><nobr>nr</nobr></div>
<div style="position:absolute;top:11943;left:209"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11943;left:217"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11934;left:241"><nobr>1 +</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:281"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:298"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:310"><nobr>k</nobr></div>
<div style="position:absolute;top:11943;left:295"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:338"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:343"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:360"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:372"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:380"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:385"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11919;left:402"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11945;left:345"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11943;left:355"><nobr>=r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11943;left:377"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11945;left:381"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11942;left:388"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11934;left:436"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11932;left:457"><nobr>nr</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:497"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11943;left:495"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11943;left:503"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11934;left:513"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:541"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:558"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:570"><nobr>k</nobr></div>
<div style="position:absolute;top:11943;left:556"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:598"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:603"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:620"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:632"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11923;left:641"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:11921;left:645"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11919;left:662"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:11918;left:669"><nobr>m</nobr></div>
<div style="position:absolute;top:11942;left:637"><nobr>m</nobr></div>
</span></font>

<div style="position:absolute;top:12055;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=11><b>Page 11</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:12200;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:12200;left:765"><nobr>1011</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12251;left:138"><nobr>Assume now that we use hierarchical verification. In this case, 2 searches with r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12249;left:689"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12251;left:693"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12253;left:702"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12251;left:716"><nobr>patterns are</nobr></div>
<div style="position:absolute;top:12271;left:112"><nobr>triggered for each occurrence of the superimposed pattern. For each occurrence of those superimpositions</nobr></div>
<div style="position:absolute;top:12292;left:112"><nobr>of r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12290;left:137"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12291;left:141"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12293;left:151"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12292;left:162"><nobr>patterns we will have to check a text window with 2 patterns superimposing r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12290;left:659"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12291;left:663"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12293;left:672"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12292;left:683"><nobr>original patterns,</nobr></div>
<div style="position:absolute;top:12312;left:112"><nobr>and so on. Abstracting from the mechanism we use to find the nodes of the tree of superimpositions, we</nobr></div>
<div style="position:absolute;top:12332;left:112"><nobr>have that in total, in the hierarchy there are</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12334;left:391"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12329;left:400"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12332;left:409"><nobr>groups of r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12330;left:482"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12332;left:486"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12334;left:495"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12329;left:502"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12332;left:511"><nobr>patterns, for i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12334;left:601"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12332;left:622"><nobr>::</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12334;left:633"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12341;left:662"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12334;left:669"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12332;left:673"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12330;left:683"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12334;left:687"><nobr>) 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12332;left:709"><nobr>. Each such</nobr></div>
<div style="position:absolute;top:12353;left:112"><nobr>group matches with probability</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12348;left:329"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12350;left:339"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12348;left:346"><nobr>k</nobr></div>
<div style="position:absolute;top:12361;left:337"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12352;left:364"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12354;left:374"><nobr>( 2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12350;left:397"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12352;left:402"><nobr>=r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12350;left:418"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12354;left:422"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12350;left:428"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12353;left:440"><nobr>, and each match costs the verification of a window of</nobr></div>
<div style="position:absolute;top:12373;left:112"><nobr>length m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12375;left:174"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12373;left:186"><nobr>k for other two patterns. The total verification cost is</nobr></div>
<div style="position:absolute;top:12413;left:180"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:197"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:209"><nobr>k</nobr></div>
<div style="position:absolute;top:12435;left:195"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:237"><nobr>2(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:250"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:267"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:279"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:288"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:292"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12411;left:310"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12410;left:316"><nobr>m</nobr></div>
<div style="position:absolute;top:12434;left:280"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12407;left:330"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:12415;left:346"><nobr>2</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12407;left:352"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12405;left:356"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:5px;font-family:Times">
<div style="position:absolute;top:12406;left:363"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12407;left:367"><nobr>) 1</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:26px;font-family:Times">
<div style="position:absolute;top:12397;left:347"><nobr>X</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12447;left:349"><nobr>i</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12449;left:352"><nobr>=0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:405"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12410;left:413"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12437;left:393"><nobr>(2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12434;left:407"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12437;left:413"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12434;left:419"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12426;left:445"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:483"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:500"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:512"><nobr>k</nobr></div>
<div style="position:absolute;top:12435;left:497"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:540"><nobr>2(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:553"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:570"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:582"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12415;left:590"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12413;left:595"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12411;left:612"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12410;left:619"><nobr>m</nobr></div>
<div style="position:absolute;top:12434;left:583"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12426;left:634"><nobr>(1 +</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12424;left:662"><nobr>O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12426;left:675"><nobr>(1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12424;left:687"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12426;left:697"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12420;left:712"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12426;left:724"><nobr>))</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12473;left:112"><nobr>(assuming m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12475;left:216"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12473;left:224"><nobr>), which is r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12471;left:314"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12473;left:318"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12475;left:327"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12473;left:340"><nobr>times cheaper than without hierarchical verification. The <b style="color:black;background-color:#a0ffff">search</b> cost</nobr></div>
<div style="position:absolute;top:12493;left:112"><nobr>becomes now bounded by</nobr></div>
<div style="position:absolute;top:12523;left:325"><nobr>nr</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12514;left:361"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12534;left:359"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12533;left:367"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12525;left:377"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12512;left:405"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12514;left:422"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12512;left:434"><nobr>k</nobr></div>
<div style="position:absolute;top:12534;left:420"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12514;left:462"><nobr>2(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12512;left:475"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12514;left:492"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12512;left:504"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12514;left:513"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12512;left:517"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12510;left:534"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12509;left:541"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12511;left:555"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12532;left:513"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12559;left:112"><nobr>which is minimized for</nobr></div>
<div style="position:absolute;top:12579;left:322"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12577;left:330"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12581;left:347"><nobr>=</nobr></div>
<div style="position:absolute;top:12603;left:384"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12597;left:400"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12599;left:410"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12597;left:417"><nobr>k</nobr></div>
<div style="position:absolute;top:12609;left:408"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12603;left:435"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12601;left:440"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12603;left:457"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12601;left:469"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12603;left:477"><nobr>)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12601;left:487"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12603;left:514"><nobr>1)</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12592;left:556"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12590;left:562"><nobr>=m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12632;left:112"><nobr>and gives a <b style="color:black;background-color:#a0ffff">search</b> time bound of</nobr></div>
<div style="position:absolute;top:12667;left:301"><nobr>nr</nobr></div>
<div style="position:absolute;top:12667;left:337"><nobr>m</nobr></div>
<div style="position:absolute;top:12690;left:322"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12692;left:350"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12667;left:394"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12669;left:411"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12667;left:423"><nobr>k</nobr></div>
<div style="position:absolute;top:12690;left:408"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12680;left:449"><nobr>2(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12678;left:462"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12680;left:479"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12678;left:491"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12680;left:499"><nobr>)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12678;left:509"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12680;left:536"><nobr>1)</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12665;left:581"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12663;left:587"><nobr>=m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12721;left:138"><nobr>An asymptotic simplification (for large m and</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12723;left:465"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12721;left:480"><nobr>k=m considered constant) of the cost can be</nobr></div>
<div style="position:absolute;top:12742;left:112"><nobr>obtained using Stirling’s approximation to the factorial m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12743;left:488"><nobr>! = (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12741;left:514"><nobr>m=e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12743;left:546"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:12739;left:559"><nobr>m</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:12720;left:571"><nobr>p</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12743;left:584"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12741;left:597"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12743;left:611"><nobr>(1 +</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12741;left:639"><nobr>O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12743;left:652"><nobr>(1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12741;left:665"><nobr>=m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12743;left:687"><nobr>))</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12742;left:697"><nobr>:</nobr></div>
<div style="position:absolute;top:12774;left:401"><nobr>nr</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12776;left:427"><nobr>(1 + )</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12773;left:478"><nobr>1+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12823;left:112"><nobr>which monotonically worsens with , as expected.</nobr></div>
<div style="position:absolute;top:12843;left:138"><nobr>This shows that in the best case we may expect a speedup of O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12845;left:543"><nobr>( )</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12843;left:562"><nobr>by superimposing the subpatterns.</nobr></div>
<div style="position:absolute;top:12863;left:112"><nobr>This means that the amount of grouping permitted depends only on the alphabet size and the error level</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12885;left:125"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12883;left:141"><nobr>k=m. The larger the alphabet or the lower the error level, the more grouping is possible. The</nobr></div>
<div style="position:absolute;top:12904;left:112"><nobr>speedup is for k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12906;left:230"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12904;left:255"><nobr>and it moves to 1 as grows.</nobr></div>
<div style="position:absolute;top:12924;left:138"><nobr>A natural question is: Up to which error level the speedup is larger than 1 (<i>i.e.</i>, useful)? This is, when</nobr></div>
<div style="position:absolute;top:12945;left:112"><nobr>it happens that</nobr></div>
<div style="position:absolute;top:12944;left:245"><nobr>&gt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12946;left:259"><nobr>(1 + )</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:12943;left:313"><nobr>1+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12945;left:338"><nobr>, <i>i.e.</i>, &gt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12946;left:397"><nobr>(1 + )(1 + 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12944;left:469"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12946;left:483"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12945;left:532"><nobr>? A sufficient condition can be obtained</nobr></div>
<div style="position:absolute;top:12965;left:112"><nobr>by noticing that</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12967;left:222"><nobr>1</nobr></div>
<div style="position:absolute;top:12967;left:250"><nobr>(1 + 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12965;left:288"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12967;left:302"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12965;left:355"><nobr>e, and therefore &lt; =e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12967;left:534"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12965;left:547"><nobr>suffices. In general it has to hold</nobr></div>
<div style="position:absolute;top:12985;left:122"><nobr>&lt; =</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12987;left:151"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12985;left:156"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:12983;left:178"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12985;left:182"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12987;left:191"><nobr>) 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:12985;left:218"><nobr>. That means that no multipattern <b style="color:black;background-color:#a0ffff">search</b> is effective under this method for sufficiently</nobr></div>
<div style="position:absolute;top:13006;left:112"><nobr>high error levels.</nobr></div>
<div style="position:absolute;top:13026;left:138"><nobr>For longer patterns all <b style="color:black;background-color:#a0ffff">search</b> costs get multiplied by m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13028;left:498"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:13035;left:520"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13028;left:527"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13026;left:532"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13028;left:541"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13026;left:545"><nobr>=w. On the other hand, if the patterns</nobr></div>
<div style="position:absolute;top:13046;left:112"><nobr>are very short, we may do multipattern <b style="color:black;background-color:#a0ffff">search</b> by packing the states of many patterns inside the same</nobr></div>
<div style="position:absolute;top:13066;left:112"><nobr>computer word, so that we update the states of all the searches in a single operation. The size of the</nobr></div>
<div style="position:absolute;top:13087;left:112"><nobr>representation of each pattern, however, is nearly m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13088;left:461"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:13096;left:483"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13088;left:490"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13086;left:495"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13088;left:504"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13087;left:509"><nobr>, which makes the idea impractical except</nobr></div>
<div style="position:absolute;top:13107;left:112"><nobr>for very short patterns. In the next section we present a filter that needs much less information per pattern</nobr></div>
<div style="position:absolute;top:13127;left:112"><nobr>and therefore is suitable for this approach.</nobr></div>
</span></font>

<div style="position:absolute;top:13243;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=12><b>Page 12</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:13388;left:108"><nobr>1012</nobr></div>
<div style="position:absolute;top:13388;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:13433;left:108"><nobr><b>6. A Counting Filter</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13489;left:108"><nobr>A different approach to filter the <b style="color:black;background-color:#a0ffff">search</b> for <b style="color:black;background-color:#ff9999">multiple</b> patterns is to use a “counting” filter. The filter is</nobr></div>
<div style="position:absolute;top:13510;left:108"><nobr>based on the notion that if a pattern is found at text position j, then all its characters must appear in the</nobr></div>
<div style="position:absolute;top:13530;left:108"><nobr>text window T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:13536;left:201"><nobr>j m k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:13538;left:229"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:13536;left:241"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13530;left:275"><nobr>. The idea is to keep count at any text position j of how many pattern characters</nobr></div>
<div style="position:absolute;top:13550;left:108"><nobr>are present in the text window, updating this information in O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13552;left:510"><nobr>(1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13550;left:531"><nobr>operations per text character. Note that</nobr></div>
<div style="position:absolute;top:13571;left:108"><nobr>we cannot ensure that the pattern characters appear in the correct order, so we filter with a necessary</nobr></div>
<div style="position:absolute;top:13591;left:108"><nobr>condition which is not sufficient to guarantee a match. Moreover, we show that for a multipattern <b style="color:black;background-color:#a0ffff">search</b></nobr></div>
<div style="position:absolute;top:13611;left:108"><nobr>many counters (one per pattern) can be stored in a single computer word and all can be updated in O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13613;left:766"><nobr>(1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13632;left:108"><nobr>operations per text character. Each time a counter reaches the critical value m, it means that all its</nobr></div>
<div style="position:absolute;top:13652;left:108"><nobr>characters are in the text window and therefore the window is checked using the <b style="color:black;background-color:#99ff99">algorithm</b> of Section 4.</nobr></div>
<div style="position:absolute;top:13672;left:108"><nobr>A similar idea has been proposed in [12, 21, 22] for the k-differences problem and earlier [11] for the k-</nobr></div>
<div style="position:absolute;top:13693;left:108"><nobr>mismatches problem. We now describe the <b style="color:black;background-color:#99ff99">algorithm</b> and later show how to adapt it for <b style="color:black;background-color:#ff9999">multiple</b> patterns</nobr></div>
<div style="position:absolute;top:13713;left:108"><nobr>(by combining it with bit-parallelism).</nobr></div>
<div style="position:absolute;top:13740;left:133"><nobr>Again we will assume that the patterns have the same length, with the possibility of truncating to the</nobr></div>
<div style="position:absolute;top:13760;left:108"><nobr>shortest pattern if this is not the case. Once more, this solution is effective only if the pattern lengths are</nobr></div>
<div style="position:absolute;top:13781;left:108"><nobr>not that different.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:13863;left:108"><nobr><b>6.1. One Pattern</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13909;left:108"><nobr>The filter passes over the text examining an</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13911;left:392"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13909;left:396"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13911;left:412"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13909;left:422"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13911;left:430"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13909;left:435"><nobr>-characters <b style="color:black;background-color:#ff66ff">long</b> window. It keeps track of how many</nobr></div>
<div style="position:absolute;top:13930;left:108"><nobr>characters of P are present in the current text window (accounting for multiplicities too). If, at a given</nobr></div>
<div style="position:absolute;top:13950;left:108"><nobr>text position j, the m characters of P are in the window T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:13956;left:486"><nobr>j m k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:13958;left:514"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:13956;left:526"><nobr>::j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13950;left:560"><nobr>, the window area is verified with a</nobr></div>
<div style="position:absolute;top:13970;left:108"><nobr>classical <b style="color:black;background-color:#99ff99">algorithm</b> (in this paper, with the bit-parallel <b style="color:black;background-color:#99ff99">algorithm</b> of Section 4).</nobr></div>
<div style="position:absolute;top:13997;left:133"><nobr>We implement the filtering <b style="color:black;background-color:#99ff99">algorithm</b> as follows: we build a table A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:13999;left:597"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:13997;left:613"><nobr>where, for each character</nobr></div>
<div style="position:absolute;top:14017;left:108"><nobr>c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:14010;left:125"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14018;left:150"><nobr>, the number of times that c appears in P is initially stored. Throughout the <b style="color:black;background-color:#99ff99">algorithm</b>, A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14019;left:766"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14017;left:770"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14019;left:778"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14038;left:108"><nobr>indicates the difference between the number of times c appears in P and the number of times it has</nobr></div>
<div style="position:absolute;top:14058;left:108"><nobr>appeared in the current window. Only when A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14060;left:431"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14058;left:434"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14060;left:443"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14058;left:453"><nobr>is positive we count a character c that enters the</nobr></div>
<div style="position:absolute;top:14079;left:108"><nobr>window. We also keep a counter count of matching characters. To advance the window, we must include</nobr></div>
<div style="position:absolute;top:14099;left:108"><nobr>the new character T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:14104;left:242"><nobr>j</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:14106;left:245"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14099;left:270"><nobr>and exclude the last character, T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:14105;left:490"><nobr>j m k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:14106;left:517"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14099;left:550"><nobr>. To include the new character, we</nobr></div>
<div style="position:absolute;top:14119;left:108"><nobr>decrement A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14121;left:191"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14119;left:195"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:14125;left:207"><nobr>j</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:14127;left:210"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14121;left:229"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14119;left:233"><nobr>. If the entry was greater than zero <i>before </i>the operation, it is because the character is</nobr></div>
<div style="position:absolute;top:14140;left:108"><nobr>in P, so we increment the counter count. To exclude the old character, we increment A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14141;left:685"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14139;left:689"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:14145;left:702"><nobr>j m k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:14147;left:729"><nobr>+1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14141;left:762"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14140;left:766"><nobr>. If</nobr></div>
<div style="position:absolute;top:14160;left:108"><nobr>the entry is greater than zero <i>after </i>the operation, it is because the character was in P, so we decrement</nobr></div>
<div style="position:absolute;top:14180;left:108"><nobr>count. When the counter count reaches m we verify the preceding area.</nobr></div>
<div style="position:absolute;top:14207;left:133"><nobr>When A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14209;left:188"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14207;left:192"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14209;left:200"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14207;left:209"><nobr>is negative, it means that the character c must leave the window A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14209;left:653"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14207;left:657"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14209;left:665"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14207;left:674"><nobr>times before we</nobr></div>
<div style="position:absolute;top:14228;left:108"><nobr>accept it again as belonging to the pattern. For example, if we run the pattern &quot;abca&quot; over the text</nobr></div>
<div style="position:absolute;top:14247;left:108"><nobr>&quot;aaaaaaaa&quot;, with k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14250;left:250"><nobr>= 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14248;left:276"><nobr>it will hold A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14250;left:364"><nobr>[</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:14246;left:375"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14247;left:380"><nobr>a</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:14246;left:388"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14250;left:393"><nobr>] = 3</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14248;left:430"><nobr>, A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14250;left:449"><nobr>[</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:14246;left:467"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14247;left:471"><nobr>b</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:14246;left:480"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14250;left:484"><nobr>] = 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14248;left:515"><nobr>, A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14250;left:534"><nobr>[</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:14246;left:546"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14247;left:550"><nobr>c</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:14246;left:559"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14250;left:563"><nobr>] = 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:14248;left:593"><nobr>, and the value of count will</nobr></div>
<div style="position:absolute;top:14268;left:108"><nobr>be 2. Figure 4 shows another example.</nobr></div>
<div style="position:absolute;top:14295;left:133"><nobr>Figure 5 shows the pseudocode of the <b style="color:black;background-color:#99ff99">algorithm</b>. As it can be seen, the <b style="color:black;background-color:#99ff99">algorithm</b> is not only linear</nobr></div>
<div style="position:absolute;top:14315;left:108"><nobr>time (excluding verifications), but the number of operations per character is very small.</nobr></div>
</span></font>

<div style="position:absolute;top:14431;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=13><b>Page 13</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:14576;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:14576;left:765"><nobr>1013</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:16px;font-family:Times">
<div style="position:absolute;top:14729;left:578"><nobr><b>X</b></nobr></div>
<div style="position:absolute;top:14800;left:578"><nobr><b>X</b></nobr></div>
<div style="position:absolute;top:14833;left:578"><nobr><b>X</b></nobr></div>
<div style="position:absolute;top:14762;left:578"><nobr><b>X</b></nobr></div>
<div style="position:absolute;top:14680;left:415"><nobr><b>h e l l o a</b></nobr></div>
<div style="position:absolute;top:14765;left:626"><nobr>l</nobr></div>
<div style="position:absolute;top:14731;left:663"><nobr><b>1</b></nobr></div>
<div style="position:absolute;top:14768;left:663"><nobr><b>-1</b></nobr></div>
<div style="position:absolute;top:14801;left:663"><nobr><b>0</b></nobr></div>
<div style="position:absolute;top:14833;left:663"><nobr><b>0</b></nobr></div>
<div style="position:absolute;top:14862;left:663"><nobr><b>-1</b></nobr></div>
<div style="position:absolute;top:14727;left:621"><nobr>a</nobr></div>
<div style="position:absolute;top:14793;left:621"><nobr>o</nobr></div>
<div style="position:absolute;top:14830;left:621"><nobr>h</nobr></div>
<div style="position:absolute;top:14863;left:621"><nobr>e</nobr></div>
<div style="position:absolute;top:14903;left:621"><nobr><i>c</i></nobr></div>
<div style="position:absolute;top:14902;left:654"><nobr><i>A[c]</i></nobr></div>
<div style="position:absolute;top:14816;left:243"><nobr><i><b>(k=1)</b></i></nobr></div>
<div style="position:absolute;top:14729;left:547"><nobr><b>X</b></nobr></div>
<div style="position:absolute;top:14792;left:197"><nobr><b>Searching for ’aloha’</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14948;left:112"><nobr>Figure 4. An example of the counting filter. The crosses represent elements which A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:14950;left:635"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14948;left:649"><nobr>accepts, and the circles</nobr></div>
<div style="position:absolute;top:14966;left:112"><nobr>are the elements that appeared in the window. A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:14968;left:403"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14966;left:407"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:14968;left:414"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:14966;left:422"><nobr>stores the number of crosses minus circles, and count counts</nobr></div>
<div style="position:absolute;top:14984;left:112"><nobr>circled crosses.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15096;left:155"><nobr>CountFilter (T,n,P,m,k)</nobr></div>
<div style="position:absolute;top:15137;left:241"><nobr>/* <b style="color:white;background-color:#880000">Preprocessing</b> */</nobr></div>
<div style="position:absolute;top:15157;left:121"><nobr>1.</nobr></div>
<div style="position:absolute;top:15157;left:178"><nobr>for c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15150;left:218"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15157;left:249"><nobr>do A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15160;left:286"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15158;left:290"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15160;left:298"><nobr>] 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15177;left:121"><nobr>2.</nobr></div>
<div style="position:absolute;top:15177;left:178"><nobr>for i</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15170;left:214"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15180;left:232"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15178;left:240"><nobr>::m do A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15180;left:309"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15178;left:312"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15184;left:334"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15180;left:339"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15178;left:359"><nobr>A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15180;left:370"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15178;left:374"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15184;left:397"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15180;left:402"><nobr>] + 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15198;left:121"><nobr>3.</nobr></div>
<div style="position:absolute;top:15198;left:178"><nobr>count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15200;left:233"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15218;left:241"><nobr>/* Searching */</nobr></div>
<div style="position:absolute;top:15238;left:121"><nobr>4.</nobr></div>
<div style="position:absolute;top:15238;left:178"><nobr>for j</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15231;left:215"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15241;left:233"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15239;left:240"><nobr>::m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15241;left:267"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15239;left:279"><nobr>k do /* fill initial window */</nobr></div>
<div style="position:absolute;top:15259;left:121"><nobr>5.</nobr></div>
<div style="position:absolute;top:15259;left:203"><nobr>if A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15261;left:231"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15259;left:235"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15265;left:259"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15261;left:265"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15259;left:274"><nobr>&gt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15261;left:288"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15259;left:305"><nobr>then count count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15261;left:444"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15279;left:121"><nobr>6.</nobr></div>
<div style="position:absolute;top:15279;left:203"><nobr>A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15281;left:214"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15279;left:218"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15285;left:233"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15281;left:240"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15279;left:259"><nobr>A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15281;left:270"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15279;left:274"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15285;left:296"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15281;left:303"><nobr>] 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15299;left:121"><nobr>7.</nobr></div>
<div style="position:absolute;top:15299;left:178"><nobr>for j</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15292;left:215"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15300;left:233"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15302;left:250"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15300;left:262"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15302;left:274"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15300;left:293"><nobr>::n do /* move window */</nobr></div>
<div style="position:absolute;top:15320;left:121"><nobr>8.</nobr></div>
<div style="position:absolute;top:15320;left:203"><nobr>if count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15322;left:264"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15320;left:277"><nobr>m then verify T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15326;left:430"><nobr>j m k::j</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:15328;left:472"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15340;left:121"><nobr>9.</nobr></div>
<div style="position:absolute;top:15340;left:203"><nobr>if A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15342;left:231"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15340;left:235"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15346;left:259"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15342;left:265"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15340;left:274"><nobr>&gt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15342;left:288"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15340;left:305"><nobr>then count count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15342;left:444"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15360;left:112"><nobr>10.</nobr></div>
<div style="position:absolute;top:15361;left:204"><nobr>A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15363;left:215"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15361;left:219"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15366;left:233"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15363;left:240"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15361;left:259"><nobr>A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15363;left:270"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15361;left:274"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15366;left:296"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15363;left:303"><nobr>] 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15381;left:112"><nobr>11.</nobr></div>
<div style="position:absolute;top:15381;left:204"><nobr>A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15383;left:215"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15381;left:219"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15387;left:233"><nobr>j m k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15383;left:278"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15381;left:297"><nobr>A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15383;left:308"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15381;left:312"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15387;left:334"><nobr>j m k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15383;left:379"><nobr>] + 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15401;left:112"><nobr>12.</nobr></div>
<div style="position:absolute;top:15401;left:204"><nobr>if A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15403;left:232"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15401;left:236"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:15407;left:259"><nobr>j m k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15403;left:303"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15401;left:312"><nobr>&gt;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15403;left:326"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15401;left:342"><nobr>then count count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15403;left:492"><nobr>1</nobr></div>
<div style="position:absolute;top:15454;left:300"><nobr>Figure 5. The counting <b style="color:black;background-color:#99ff99">algorithm</b> for one pattern.</nobr></div>
</span></font>

<div style="position:absolute;top:15619;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=14><b>Page 14</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:15764;left:108"><nobr>1014</nobr></div>
<div style="position:absolute;top:15764;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:15813;left:108"><nobr><b>6.2. <b style="color:black;background-color:#ff9999">Multiple</b> Patterns</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15846;left:108"><nobr>The previous <b style="color:black;background-color:#99ff99">algorithm</b> can <b style="color:black;background-color:#a0ffff">search</b> for one pattern only. However, we can extend it to handle <b style="color:black;background-color:#ff9999">multiple</b></nobr></div>
<div style="position:absolute;top:15867;left:108"><nobr>patterns. To <b style="color:black;background-color:#a0ffff">search</b> for r patterns in the same text, we maintain one A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15868;left:565"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15867;left:580"><nobr>table and count value for each</nobr></div>
<div style="position:absolute;top:15887;left:108"><nobr>pattern. We use bit-parallelism to keep all these elements in a single machine word, both for A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15889;left:723"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15887;left:738"><nobr>and for</nobr></div>
<div style="position:absolute;top:15907;left:108"><nobr>count.</nobr></div>
<div style="position:absolute;top:15928;left:133"><nobr>The values of the entries of A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15929;left:326"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15928;left:340"><nobr>lie in the range</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15929;left:442"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15927;left:453"><nobr>m k::m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15929;left:511"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15928;left:515"><nobr>, so we need exactly</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15929;left:650"><nobr>1 +</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15927;left:673"><nobr>‘ bits to store</nobr></div>
<div style="position:absolute;top:15948;left:108"><nobr>them, where ‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15950;left:203"><nobr>=</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15940;left:217"><nobr>d</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15950;left:230"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:15957;left:253"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15950;left:260"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15948;left:265"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15950;left:282"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15948;left:295"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15950;left:303"><nobr>)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15940;left:308"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15948;left:321"><nobr>. This is also enough for count, since it is in the range</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15950;left:687"><nobr>[0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15948;left:699"><nobr>::m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15950;left:721"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15948;left:725"><nobr>. Hence,</nobr></div>
<div style="position:absolute;top:15968;left:108"><nobr>we can pack</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15961;left:193"><nobr>b</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15968;left:206"><nobr>w=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15970;left:228"><nobr>(1 +</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15961;left:256"><nobr>d</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15970;left:270"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:15977;left:284"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15970;left:291"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15968;left:296"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15970;left:313"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15968;left:325"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15970;left:333"><nobr>)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15961;left:338"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:15970;left:351"><nobr>)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:15961;left:356"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:15968;left:373"><nobr>patterns in a single <b style="color:black;background-color:#a0ffff">search</b> (recall that w is the number of bits in</nobr></div>
<div style="position:absolute;top:15989;left:108"><nobr>the computer word). If we have more patterns, we must divide the set in subsets of at most this size and</nobr></div>
<div style="position:absolute;top:16009;left:108"><nobr><b style="color:black;background-color:#a0ffff">search</b> for each subset separately. We focus our attention on a single subset now.</nobr></div>
<div style="position:absolute;top:16029;left:133"><nobr>The <b style="color:black;background-color:#99ff99">algorithm</b> simulates the simple one as follows. We have a table MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16031;left:622"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16029;left:638"><nobr>that packs all the A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16031;left:769"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16050;left:108"><nobr>tables. Each entry of MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16051;left:280"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16050;left:297"><nobr>is divided in bit areas of length</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16051;left:514"><nobr>1 +</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16049;left:540"><nobr>‘. In the area of the machine word</nobr></div>
<div style="position:absolute;top:16070;left:108"><nobr>corresponding to each pattern, we store</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16072;left:367"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:16067;left:376"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16072;left:384"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16070;left:395"><nobr>A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16072;left:406"><nobr>[ ] 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16070;left:437"><nobr>. When, in the <b style="color:black;background-color:#99ff99">algorithm</b>, we have to add or subtract</nobr></div>
<div style="position:absolute;top:16090;left:108"><nobr>1, we can easily do it in parallel without causing overflow from an area to the next. Moreover, the</nobr></div>
<div style="position:absolute;top:16111;left:108"><nobr>corresponding A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16112;left:216"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16111;left:231"><nobr>value is not positive if and only if the most significant bit of the area is zero.</nobr></div>
<div style="position:absolute;top:16131;left:133"><nobr>We have a parallel counter Mcount, where the areas are aligned with MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16133;left:626"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16131;left:636"><nobr>. It is initialized with</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16153;left:108"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:16148;left:116"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16151;left:138"><nobr>m in each area. Later, we can add or subtract 1 in parallel without causing overflow. Moreover,</nobr></div>
<div style="position:absolute;top:16172;left:108"><nobr>the window must be verified for a pattern whenever the most significant bit of its area reaches 1. The</nobr></div>
<div style="position:absolute;top:16192;left:108"><nobr>condition can be checked in parallel, although if some counter reaches zero we sequentially verify which</nobr></div>
<div style="position:absolute;top:16212;left:108"><nobr>ones did it. Figure 6 illustrates.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16272;left:522"><nobr>1</nobr></div>
<div style="position:absolute;top:16292;left:522"><nobr>0</nobr></div>
<div style="position:absolute;top:16312;left:522"><nobr>0</nobr></div>
<div style="position:absolute;top:16333;left:522"><nobr>0</nobr></div>
<div style="position:absolute;top:16353;left:522"><nobr>0</nobr></div>
<div style="position:absolute;top:16249;left:454"><nobr>m</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16251;left:469"><nobr>= 5</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16249;left:486"><nobr>; k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16251;left:503"><nobr>= 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16249;left:520"><nobr>; ‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16251;left:533"><nobr>= 3</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16272;left:668"><nobr>MA [a]</nobr></div>
<div style="position:absolute;top:16292;left:668"><nobr>MA [l]</nobr></div>
<div style="position:absolute;top:16312;left:668"><nobr>MA [o]</nobr></div>
<div style="position:absolute;top:16332;left:668"><nobr>MA [h]</nobr></div>
<div style="position:absolute;top:16353;left:668"><nobr>MA [e]</nobr></div>
<div style="position:absolute;top:16380;left:503"><nobr>A</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16382;left:513"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16380;left:516"><nobr>c</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16382;left:523"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16380;left:530"><nobr>&gt;</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16382;left:541"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16380;left:551"><nobr>?</nobr></div>
<div style="position:absolute;top:16272;left:535"><nobr>0 0</nobr></div>
<div style="position:absolute;top:16292;left:569"><nobr>0</nobr></div>
<div style="position:absolute;top:16292;left:552"><nobr>1</nobr></div>
<div style="position:absolute;top:16292;left:535"><nobr>1</nobr></div>
<div style="position:absolute;top:16313;left:535"><nobr>1</nobr></div>
<div style="position:absolute;top:16313;left:569"><nobr>1</nobr></div>
<div style="position:absolute;top:16313;left:552"><nobr>1</nobr></div>
<div style="position:absolute;top:16333;left:535"><nobr>1 1 1</nobr></div>
<div style="position:absolute;top:16353;left:535"><nobr>1</nobr></div>
<div style="position:absolute;top:16353;left:569"><nobr>0</nobr></div>
<div style="position:absolute;top:16353;left:552"><nobr>1</nobr></div>
<div style="position:absolute;top:16418;left:668"><nobr>Mcount</nobr></div>
<div style="position:absolute;top:16419;left:519"><nobr>0 1 1 1</nobr></div>
<div style="position:absolute;top:16272;left:569"><nobr>0</nobr></div>
<div style="position:absolute;top:16445;left:503"><nobr>count</nobr></div>
<div style="position:absolute;top:16445;left:554"><nobr>m ?</nobr></div>
<div style="position:absolute;top:16296;left:365"><nobr>MA</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16298;left:387"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16296;left:390"><nobr>c</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16298;left:397"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16355;left:365"><nobr>Mcount</nobr></div>
<div style="position:absolute;top:16264;left:279"><nobr>A</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16266;left:288"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16264;left:291"><nobr>c</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16266;left:298"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16325;left:279"><nobr>count</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16298;left:216"><nobr>+2</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:16297;left:233"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:16298;left:248"><nobr>1</nobr></div>
<div style="position:absolute;top:16357;left:222"><nobr>+2</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:16356;left:240"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16355;left:255"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16471;left:143"><nobr>Figure 6. Scheme and an example of the bit-parallel counters. The example follows that of Figure 4.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16514;left:133"><nobr>Observe that the counters that we want to selectively increment or decrement correspond exactly to</nobr></div>
<div style="position:absolute;top:16534;left:108"><nobr>the MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16536;left:156"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16534;left:171"><nobr>areas that have a 1 in their most significant bit (<i>i.e.</i>, those whose A</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:16536;left:612"><nobr>[ ]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16534;left:628"><nobr>value is positive). This</nobr></div>
<div style="position:absolute;top:16555;left:108"><nobr>yields a bit mask-shift-add mechanism to perform this operation in parallel on all the counters.</nobr></div>
<div style="position:absolute;top:16575;left:133"><nobr>Figure 7 shows the pseudocode of the parallel <b style="color:black;background-color:#99ff99">algorithm</b>. As it can be seen, the <b style="color:black;background-color:#99ff99">algorithm</b> is more</nobr></div>
<div style="position:absolute;top:16595;left:108"><nobr>complex than the simple version but the number of operations per character is still very low.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:16638;left:108"><nobr><b>6.3. Analysis</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:16671;left:108"><nobr>We want to determine the probability that the filter triggers a verification for a random pattern. Since the</nobr></div>
<div style="position:absolute;top:16691;left:108"><nobr>m characters of P can appear at any window position in any order, the probability can be bounded from</nobr></div>
</span></font>

<div style="position:absolute;top:16807;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=15><b>Page 15</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:16952;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:16952;left:765"><nobr>1015</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17000;left:155"><nobr>CountFilter (T,n,P</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17000;left:319"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:16998;left:325"><nobr>::r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17000;left:339"><nobr>,m,k)</nobr></div>
<div style="position:absolute;top:17041;left:241"><nobr>/* <b style="color:white;background-color:#880000">Preprocessing</b> */</nobr></div>
<div style="position:absolute;top:17061;left:121"><nobr>1.</nobr></div>
<div style="position:absolute;top:17061;left:178"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17063;left:186"><nobr>=</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17054;left:199"><nobr>d</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17063;left:212"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17070;left:238"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17063;left:245"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17061;left:250"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17063;left:267"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17061;left:279"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17063;left:287"><nobr>)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17054;left:292"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17081;left:121"><nobr>2.</nobr></div>
<div style="position:absolute;top:17081;left:178"><nobr>for c</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17074;left:218"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17081;left:249"><nobr>do MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17084;left:299"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17082;left:303"><nobr>c</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17084;left:311"><nobr>] (01</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17079;left:380"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17084;left:386"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17079;left:392"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17102;left:121"><nobr>3.</nobr></div>
<div style="position:absolute;top:17102;left:178"><nobr>for s</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17095;left:218"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17104;left:236"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17102;left:244"><nobr>::r do</nobr></div>
<div style="position:absolute;top:17122;left:121"><nobr>4.</nobr></div>
<div style="position:absolute;top:17122;left:203"><nobr>for i</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17115;left:240"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17124;left:257"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17122;left:265"><nobr>::m do</nobr></div>
<div style="position:absolute;top:17143;left:121"><nobr>5.</nobr></div>
<div style="position:absolute;top:17143;left:229"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17145;left:253"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17143;left:257"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17141;left:277"><nobr>s</nobr></div>
<div style="position:absolute;top:17151;left:275"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17145;left:284"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17143;left:303"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17145;left:327"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17143;left:331"><nobr>P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17141;left:358"><nobr>s</nobr></div>
<div style="position:absolute;top:17151;left:356"><nobr>i</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17145;left:365"><nobr>] + 10</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17143;left:406"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17141;left:409"><nobr>s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17143;left:419"><nobr>1)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17141;left:432"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17143;left:435"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17163;left:121"><nobr>6.</nobr></div>
<div style="position:absolute;top:17164;left:178"><nobr>Mcount</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17166;left:248"><nobr>(10</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17161;left:287"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17164;left:307"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17166;left:320"><nobr>)</nobr></div>
<div style="position:absolute;top:17166;left:356"><nobr>(0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17161;left:385"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17166;left:391"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17161;left:406"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17184;left:241"><nobr>/* Searching */</nobr></div>
<div style="position:absolute;top:17204;left:121"><nobr>7.</nobr></div>
<div style="position:absolute;top:17204;left:178"><nobr>for j</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17197;left:215"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17206;left:233"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17204;left:240"><nobr>::m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17206;left:267"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17204;left:279"><nobr>k do /* fill initial window */</nobr></div>
<div style="position:absolute;top:17224;left:121"><nobr>8.</nobr></div>
<div style="position:absolute;top:17225;left:203"><nobr>Mcount</nobr></div>
<div style="position:absolute;top:17225;left:291"><nobr>Mcount</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17227;left:358"><nobr>+ ((</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17225;left:388"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17227;left:412"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17225;left:415"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17231;left:456"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17227;left:463"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17225;left:471"><nobr>&gt;&gt; ‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17227;left:498"><nobr>) &amp; (0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17222;left:559"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17227;left:565"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17222;left:580"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17227;left:587"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17245;left:121"><nobr>9.</nobr></div>
<div style="position:absolute;top:17245;left:203"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17247;left:227"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17245;left:231"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17251;left:248"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17247;left:255"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17245;left:292"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17247;left:315"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17245;left:319"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17251;left:343"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17247;left:350"><nobr>]</nobr></div>
<div style="position:absolute;top:17247;left:385"><nobr>(0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17242;left:406"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17247;left:412"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17242;left:426"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17265;left:112"><nobr>10.</nobr></div>
<div style="position:absolute;top:17265;left:178"><nobr>for j</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17258;left:215"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17265;left:233"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17267;left:250"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17265;left:262"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17267;left:274"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17265;left:294"><nobr>::n do /* move window */</nobr></div>
<div style="position:absolute;top:17286;left:112"><nobr>11.</nobr></div>
<div style="position:absolute;top:17286;left:204"><nobr>if Mcount</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17288;left:284"><nobr>&amp; (10</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17284;left:343"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17288;left:349"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17284;left:355"><nobr>r</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17279;left:367"><nobr>6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17288;left:380"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17284;left:392"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17286;left:397"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17284;left:400"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17286;left:403"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17286;left:439"><nobr>then</nobr></div>
<div style="position:absolute;top:17306;left:112"><nobr>12.</nobr></div>
<div style="position:absolute;top:17306;left:230"><nobr>for s</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17299;left:270"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17309;left:288"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17307;left:296"><nobr>::r do</nobr></div>
<div style="position:absolute;top:17327;left:112"><nobr>13.</nobr></div>
<div style="position:absolute;top:17327;left:256"><nobr>if Mcount</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17330;left:336"><nobr>&amp; 0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17327;left:380"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17325;left:383"><nobr>r s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17327;left:398"><nobr>)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17325;left:405"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17327;left:408"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17330;left:444"><nobr>10</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17325;left:460"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17330;left:466"><nobr>0</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17327;left:474"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17325;left:478"><nobr>s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17327;left:487"><nobr>1)(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17325;left:501"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17327;left:503"><nobr>+1)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17320;left:543"><nobr>6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17330;left:556"><nobr>= 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17325;left:568"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17327;left:573"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17325;left:576"><nobr>‘</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17327;left:579"><nobr>+1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17327;left:615"><nobr>then</nobr></div>
<div style="position:absolute;top:17348;left:112"><nobr>14.</nobr></div>
<div style="position:absolute;top:17348;left:281"><nobr>verify T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17354;left:354"><nobr>j m k::j</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17356;left:395"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17348;left:436"><nobr>for pattern P</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17345;left:552"><nobr>s</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17368;left:112"><nobr>15.</nobr></div>
<div style="position:absolute;top:17368;left:204"><nobr>Mcount</nobr></div>
<div style="position:absolute;top:17368;left:292"><nobr>Mcount</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17370;left:359"><nobr>+ ((</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17368;left:389"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17370;left:412"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17368;left:416"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17374;left:456"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17370;left:463"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17368;left:471"><nobr>&gt;&gt; ‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17370;left:498"><nobr>) &amp; (0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17366;left:559"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17370;left:565"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17366;left:580"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17370;left:587"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17388;left:112"><nobr>16.</nobr></div>
<div style="position:absolute;top:17389;left:204"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17391;left:228"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17389;left:231"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17395;left:248"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17391;left:255"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17389;left:292"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17391;left:315"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17389;left:319"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17395;left:343"><nobr>j</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17391;left:350"><nobr>]</nobr></div>
<div style="position:absolute;top:17391;left:385"><nobr>(0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17386;left:406"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17391;left:412"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17386;left:426"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17409;left:112"><nobr>17.</nobr></div>
<div style="position:absolute;top:17409;left:204"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17411;left:228"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17409;left:231"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17415;left:248"><nobr>j m k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17411;left:293"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17409;left:329"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17411;left:353"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17409;left:357"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17415;left:381"><nobr>j m k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17411;left:426"><nobr>] + (0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17406;left:482"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17411;left:488"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17406;left:502"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17429;left:112"><nobr>18.</nobr></div>
<div style="position:absolute;top:17429;left:204"><nobr>Mcount</nobr></div>
<div style="position:absolute;top:17429;left:292"><nobr>Mcount</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17431;left:378"><nobr>((</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17429;left:387"><nobr>MA</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17431;left:411"><nobr>[</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17429;left:415"><nobr>T</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17435;left:456"><nobr>j m k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17431;left:501"><nobr>]</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17429;left:509"><nobr>&gt;&gt; ‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17431;left:536"><nobr>) &amp; (0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17427;left:597"><nobr>‘</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17431;left:603"><nobr>1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17427;left:618"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17431;left:625"><nobr>)</nobr></div>
<div style="position:absolute;top:17482;left:160"><nobr>Figure 7. The <b style="color:black;background-color:#ff9999">multiple</b>-pattern counting <b style="color:black;background-color:#99ff99">algorithm</b>. All the constants are of course precomputed.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17533;left:112"><nobr>above by (recall Section 5.2)</nobr></div>
<div style="position:absolute;top:17550;left:367"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17552;left:384"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17550;left:396"><nobr>k</nobr></div>
<div style="position:absolute;top:17573;left:381"><nobr>m</nobr></div>
<div style="position:absolute;top:17550;left:426"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17552;left:439"><nobr>!</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17571;left:434"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17563;left:460"><nobr>=</nobr></div>
<div style="position:absolute;top:17552;left:488"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17550;left:492"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17552;left:510"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17550;left:521"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17552;left:530"><nobr>)!</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17573;left:500"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17575;left:509"><nobr>!</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17571;left:524"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17562;left:773"><nobr>(3)</nobr></div>
<div style="position:absolute;top:17596;left:112"><nobr>which, compared to the actual matching probability of Eq. (2), has an extra m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17598;left:624"><nobr>!</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17596;left:636"><nobr>factor. Since we pack a</nobr></div>
<div style="position:absolute;top:17617;left:112"><nobr>pattern in</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17609;left:178"><nobr>d</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17618;left:192"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17625;left:207"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17618;left:214"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17616;left:219"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17618;left:236"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17616;left:248"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17618;left:256"><nobr>)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:17609;left:261"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17617;left:279"><nobr>bits, the total <b style="color:black;background-color:#a0ffff">search</b> cost is</nobr></div>
<div style="position:absolute;top:17655;left:310"><nobr>nr</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17646;left:344"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17653;left:365"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17646;left:372"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17644;left:377"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17646;left:394"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17644;left:406"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17646;left:415"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17666;left:380"><nobr>w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17657;left:438"><nobr>+</nobr></div>
<div style="position:absolute;top:17646;left:460"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17644;left:465"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17646;left:482"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17644;left:494"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17646;left:503"><nobr>)!</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17666;left:473"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17668;left:481"><nobr>!</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17665;left:496"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17657;left:527"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17655;left:532"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17657;left:549"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17655;left:560"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17657;left:569"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17693;left:112"><nobr>where, unlike the case of superimposed automata, we have to pack the maximum number of patterns</nobr></div>
<div style="position:absolute;top:17713;left:112"><nobr>together, since the number of verifications triggered does not depend on how the packing is done. We</nobr></div>
<div style="position:absolute;top:17734;left:112"><nobr>are interested, on the other hand, in the maximum error level for which this filter is useful.</nobr></div>
<div style="position:absolute;top:17754;left:138"><nobr>Applying Stirling’s approximation to the matching probability formula of Eq. (3) we get an asymp-</nobr></div>
<div style="position:absolute;top:17774;left:112"><nobr>totic simplification for large m:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:17795;left:401"><nobr>(1 + )</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:17792;left:452"><nobr>1+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17793;left:478"><nobr>m</nobr></div>
<div style="position:absolute;top:17815;left:428"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:17787;left:506"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:17839;left:112"><nobr>which is exponentially decreasing with m as <b style="color:black;background-color:#ff66ff">long</b> as the base is smaller than 1. When this happens, all the</nobr></div>
<div style="position:absolute;top:17859;left:112"><nobr>verification costs become negligible. When, on the other hand, the cost is not exponentially decreasing</nobr></div>
<div style="position:absolute;top:17879;left:112"><nobr>with m, the verifications dominate the <b style="color:black;background-color:#a0ffff">search</b> cost and the filter is no longer useful.</nobr></div>
</span></font>

<div style="position:absolute;top:17995;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=16><b>Page 16</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:18140;left:108"><nobr>1016</nobr></div>
<div style="position:absolute;top:18140;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18191;left:133"><nobr>So the simplified condition for the filter to be useful is</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18228;left:384"><nobr>(1 + )</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:18225;left:436"><nobr>1+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18237;left:471"><nobr>&lt;</nobr></div>
<div style="position:absolute;top:18226;left:494"><nobr>e</nobr></div>
<div style="position:absolute;top:18248;left:496"><nobr>m</nobr></div>
<div style="position:absolute;top:18279;left:108"><nobr>which worsens as m or grow. A simplified condition can be obtained by noticing again that</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18281;left:748"><nobr>(1 +</nobr></div>
<div style="position:absolute;top:18301;left:112"><nobr>)</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:18299;left:125"><nobr>1+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18299;left:150"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18301;left:182"><nobr>= (1 + )(1 + 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18299;left:268"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18301;left:282"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18299;left:343"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18301;left:352"><nobr>(1 + )</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18300;left:390"><nobr>, and therefore it suffices that</nobr></div>
<div style="position:absolute;top:18337;left:411"><nobr>&lt; =m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18339;left:467"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18374;left:108"><nobr>to ensure that the filter is useful. Note that the condition is equivalent to m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18376;left:597"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18374;left:609"><nobr>k &lt; .</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:18422;left:108"><nobr><b>7. Experimental Results</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18465;left:108"><nobr>In this section we present some experimental results about our algorithms and their analyses.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:18509;left:108"><nobr><b>7.1. Probability of Matching</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18543;left:108"><nobr>We test experimentally the probability that a random pattern matches at a random text position. We</nobr></div>
<div style="position:absolute;top:18563;left:108"><nobr>generated a random text and 100 random patterns for each experimental value shown. Figure 8 shows</nobr></div>
<div style="position:absolute;top:18583;left:108"><nobr>the probability of matching in a text of 3 Mb for a pattern with m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18585;left:550"><nobr>= 300</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18583;left:587"><nobr>, where pattern and text were</nobr></div>
<div style="position:absolute;top:18603;left:108"><nobr>randomly generated over an alphabet of size</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18605;left:424"><nobr>= 68</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18603;left:461"><nobr>(this value was chosen based on the number of</nobr></div>
<div style="position:absolute;top:18624;left:108"><nobr>different events present in our real audit trails; this is typically between 60 and 90). We chose a large m</nobr></div>
<div style="position:absolute;top:18644;left:108"><nobr>value because, as we see next, the behavior stabilizes for large m.</nobr></div>
<div style="position:absolute;top:18665;left:133"><nobr>As can be seen, there is a k value from where the matching probability starts to grow abruptly, moving</nobr></div>
<div style="position:absolute;top:18685;left:108"><nobr>from almost 0 to almost 1 in a short range of values. Despite that this phenomenon is not as abrupt as for</nobr></div>
<div style="position:absolute;top:18705;left:108"><nobr>the k differences problem [4, 22], it is sharp enough to make this k value the most important parameter</nobr></div>
<div style="position:absolute;top:18726;left:108"><nobr>governing the behavior of the <b style="color:black;background-color:#99ff99">algorithm</b>. We call k this point, and</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:18727;left:574"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:18725;left:587"><nobr>k =m the corresponding error</nobr></div>
<div style="position:absolute;top:18746;left:108"><nobr>level.</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:19010;left:312"><nobr>10</nobr></div>
<div style="position:absolute;top:19006;left:319"><nobr>1</nobr></div>
<div style="position:absolute;top:19010;left:380"><nobr>10</nobr></div>
<div style="position:absolute;top:19006;left:387"><nobr>2</nobr></div>
<div style="position:absolute;top:19010;left:448"><nobr>10</nobr></div>
<div style="position:absolute;top:19006;left:455"><nobr>3</nobr></div>
<div style="position:absolute;top:19010;left:516"><nobr>10</nobr></div>
<div style="position:absolute;top:19006;left:523"><nobr>4</nobr></div>
<div style="position:absolute;top:19010;left:584"><nobr>10</nobr></div>
<div style="position:absolute;top:19006;left:591"><nobr>5</nobr></div>
<div style="position:absolute;top:19002;left:312"><nobr>0</nobr></div>
<div style="position:absolute;top:18981;left:307"><nobr>0.1</nobr></div>
<div style="position:absolute;top:18960;left:307"><nobr>0.2</nobr></div>
<div style="position:absolute;top:18938;left:307"><nobr>0.3</nobr></div>
<div style="position:absolute;top:18917;left:307"><nobr>0.4</nobr></div>
<div style="position:absolute;top:18895;left:307"><nobr>0.5</nobr></div>
<div style="position:absolute;top:18874;left:307"><nobr>0.6</nobr></div>
<div style="position:absolute;top:18852;left:307"><nobr>0.7</nobr></div>
<div style="position:absolute;top:18831;left:307"><nobr>0.8</nobr></div>
<div style="position:absolute;top:18810;left:307"><nobr>0.9</nobr></div>
<div style="position:absolute;top:18788;left:312"><nobr>1</nobr></div>
<div style="position:absolute;top:18781;left:335"><nobr>Probability of verification with counting filter and matching for a random pattern (m=300)</nobr></div>
<div style="position:absolute;top:19017;left:451"><nobr>k</nobr></div>
<div style="position:absolute;top:18920;left:304"><nobr>matching probability</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:5px;font-family:Times">
<div style="position:absolute;top:18799;left:365"><nobr>verification</nobr></div>
<div style="position:absolute;top:18806;left:365"><nobr>matching    </nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19043;left:108"><nobr>Figure 8. Actual matching probability and probability that the counting filter triggers a verification, for increasing</nobr></div>
<div style="position:absolute;top:19061;left:108"><nobr>k values and fixed m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:19063;left:236"><nobr>= 300</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19061;left:268"><nobr>.</nobr></div>
</span></font>

<div style="position:absolute;top:19183;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=17><b>Page 17</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:19328;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:19328;left:765"><nobr>1017</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19379;left:138"><nobr>Figure 8 also shows the probability that the counting filter triggers a verification. For large m, this</nobr></div>
<div style="position:absolute;top:19399;left:112"><nobr>probability goes to 1 much before the real matching probability does.</nobr></div>
<div style="position:absolute;top:19429;left:138"><nobr>On Figure 9 (left) we have shown this limiting</nobr></div>
<div style="position:absolute;top:19429;left:488"><nobr>value for increasing pattern lengths, showing</nobr></div>
<div style="position:absolute;top:19449;left:112"><nobr>that the actual</nobr></div>
<div style="position:absolute;top:19449;left:238"><nobr>tends to a constant for large m (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19451;left:486"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19449;left:508"><nobr>=e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19451;left:543"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19449;left:551"><nobr>) in the analysis, despite that it is</nobr></div>
<div style="position:absolute;top:19470;left:112"><nobr>smaller for short patterns. On the other hand, the maximum error level</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:19477;left:592"><nobr>count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19470;left:629"><nobr>up to where the counting</nobr></div>
<div style="position:absolute;top:19490;left:112"><nobr>filter does not require to verify every position quickly reduces as m grows. The (pessimistic) analysis</nobr></div>
<div style="position:absolute;top:19510;left:112"><nobr>predicts a limit of the form</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:19517;left:307"><nobr>count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19512;left:345"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19510;left:364"><nobr>=m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19512;left:402"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19510;left:410"><nobr>. Least squares show an excellent fitting with the curve</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:19537;left:123"><nobr>count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19532;left:159"><nobr>= 13</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19530;left:188"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19532;left:192"><nobr>5182</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19530;left:243"><nobr>=m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19532;left:270"><nobr>+ 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19530;left:289"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19532;left:294"><nobr>693</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19531;left:318"><nobr>, with a percentual error of 12.32%.</nobr></div>
<div style="position:absolute;top:19560;left:138"><nobr>Finally, we show in Figure 9 (right) how the alphabet size affects the asymptotic</nobr></div>
<div style="position:absolute;top:19560;left:721"><nobr>and</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:19567;left:760"><nobr>count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19580;left:112"><nobr>values (really for m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19582;left:255"><nobr>= 300</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19580;left:295"><nobr>). As can be seen, the curves look as straight lines, where least squares</nobr></div>
<div style="position:absolute;top:19601;left:112"><nobr>estimation yields</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19602;left:252"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19600;left:271"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19602;left:281"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19600;left:289"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19602;left:293"><nobr>0856 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19600;left:348"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19602;left:352"><nobr>8878</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19601;left:389"><nobr>and</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:19608;left:444"><nobr>count</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19602;left:482"><nobr>= 21</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19600;left:512"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19602;left:516"><nobr>5771</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19600;left:568"><nobr>=m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19602;left:595"><nobr>+ 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19600;left:615"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19602;left:620"><nobr>6931</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:19601;left:656"><nobr>with a percentual</nobr></div>
<div style="position:absolute;top:19621;left:112"><nobr>error of 1.87%.</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:19903;left:131"><nobr>0</nobr></div>
<div style="position:absolute;top:19903;left:166"><nobr>200</nobr></div>
<div style="position:absolute;top:19903;left:204"><nobr>400</nobr></div>
<div style="position:absolute;top:19903;left:243"><nobr>600</nobr></div>
<div style="position:absolute;top:19903;left:281"><nobr>800</nobr></div>
<div style="position:absolute;top:19903;left:318"><nobr>1000</nobr></div>
<div style="position:absolute;top:19903;left:356"><nobr>1200</nobr></div>
<div style="position:absolute;top:19903;left:394"><nobr>1400</nobr></div>
<div style="position:absolute;top:19898;left:128"><nobr>0</nobr></div>
<div style="position:absolute;top:19865;left:124"><nobr>10</nobr></div>
<div style="position:absolute;top:19833;left:124"><nobr>20</nobr></div>
<div style="position:absolute;top:19800;left:124"><nobr>30</nobr></div>
<div style="position:absolute;top:19767;left:124"><nobr>40</nobr></div>
<div style="position:absolute;top:19735;left:124"><nobr>50</nobr></div>
<div style="position:absolute;top:19702;left:124"><nobr>60</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:19909;left:263"><nobr>m</nobr></div>
<div style="position:absolute;top:19791;left:122"><nobr>α</nobr></div>
<div style="position:absolute;top:19786;left:122"><nobr>*</nobr></div>
<div style="position:absolute;top:19675;left:253"><nobr>α* vs m</nobr></div>
<div style="position:absolute;top:19798;left:349"><nobr>α*</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:19804;left:358"><nobr>count</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:19813;left:349"><nobr>α*        </nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:19901;left:509"><nobr>10</nobr></div>
<div style="position:absolute;top:19901;left:554"><nobr>20</nobr></div>
<div style="position:absolute;top:19901;left:599"><nobr>30</nobr></div>
<div style="position:absolute;top:19901;left:644"><nobr>40</nobr></div>
<div style="position:absolute;top:19901;left:689"><nobr>50</nobr></div>
<div style="position:absolute;top:19901;left:734"><nobr>60</nobr></div>
<div style="position:absolute;top:19901;left:779"><nobr>70</nobr></div>
<div style="position:absolute;top:19896;left:507"><nobr>0</nobr></div>
<div style="position:absolute;top:19866;left:504"><nobr>10</nobr></div>
<div style="position:absolute;top:19835;left:504"><nobr>20</nobr></div>
<div style="position:absolute;top:19805;left:504"><nobr>30</nobr></div>
<div style="position:absolute;top:19775;left:504"><nobr>40</nobr></div>
<div style="position:absolute;top:19744;left:504"><nobr>50</nobr></div>
<div style="position:absolute;top:19714;left:504"><nobr>60</nobr></div>
<div style="position:absolute;top:19683;left:504"><nobr>70</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:7px;font-family:Times">
<div style="position:absolute;top:19907;left:645"><nobr>σ</nobr></div>
<div style="position:absolute;top:19787;left:501"><nobr>α∗</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19939;left:112"><nobr>Figure 9. On the left, the</nobr></div>
<div style="position:absolute;top:19939;left:296"><nobr>limit as m grows for the number of real matches and for the counting filter. On the</nobr></div>
<div style="position:absolute;top:19957;left:112"><nobr>right, both limits as grows, for m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:19958;left:321"><nobr>= 300</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:19957;left:353"><nobr>.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20023;left:138"><nobr>All this matches our pessimistic analytical results. There is a clear error level</nobr></div>
<div style="position:absolute;top:20023;left:664"><nobr>where the matching</nobr></div>
<div style="position:absolute;top:20043;left:112"><nobr>probability goes from almost 0 to almost 1, both for the actual matching probability and for the counting</nobr></div>
<div style="position:absolute;top:20063;left:112"><nobr>filter. This limit depends linearly on the alphabet size in both cases. Regarding the dependency with</nobr></div>
<div style="position:absolute;top:20084;left:112"><nobr>respect to the pattern length m, the real probability tends to a constant while the counting filter decreases</nobr></div>
<div style="position:absolute;top:20104;left:112"><nobr>with a curve of the form O</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20106;left:288"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20104;left:297"><nobr>=m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20106;left:320"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20104;left:325"><nobr>.</nobr></div>
<div style="position:absolute;top:20134;left:138"><nobr>Since the analysis is pessimistic, the analytical and empirical constants differ. However, there is</nobr></div>
<div style="position:absolute;top:20154;left:112"><nobr>a remarkable point regarding the real probability of matching. The analysis (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20156;left:648"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20154;left:669"><nobr>=e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20156;left:704"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20154;left:712"><nobr>) and the</nobr></div>
<div style="position:absolute;top:20174;left:112"><nobr>empirical curve (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20176;left:237"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20174;left:257"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20176;left:266"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20174;left:274"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20176;left:279"><nobr>09 0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20174;left:318"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20176;left:322"><nobr>9</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20174;left:330"><nobr>) match provided we use</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20176;left:500"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20174;left:508"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20176;left:513"><nobr>09</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20174;left:534"><nobr>instead of e. This means that, even</nobr></div>
<div style="position:absolute;top:20194;left:112"><nobr>when our analysis is pessimistic, it does predict the real growth rate of the curves up to a constant factor.</nobr></div>
<div style="position:absolute;top:20215;left:112"><nobr>This is similar to the result obtained for the k differences problem [4, 22] when relating their analytical</nobr></div>
<div style="position:absolute;top:20235;left:112"><nobr>predictions (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20237;left:216"><nobr>= 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20235;left:247"><nobr>e=</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:20216;left:273"><nobr>p</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20235;left:292"><nobr>) with the experiments (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20237;left:473"><nobr>= 1 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20235;left:512"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20237;left:516"><nobr>09</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20235;left:532"><nobr>=</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:20216;left:552"><nobr>p</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20235;left:571"><nobr>) and shows a consistent behavior</nobr></div>
<div style="position:absolute;top:20255;left:112"><nobr>of the pessimistic analytical model used in both cases.</nobr></div>
</span></font>

<div style="position:absolute;top:20371;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=18><b>Page 18</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:20516;left:108"><nobr>1018</nobr></div>
<div style="position:absolute;top:20516;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:20565;left:108"><nobr><b>7.2. Filtering Efficiency</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20599;left:108"><nobr>A second concern is about the ability of our algorithms to filter out text in more typical cases (<i>i.e.</i>, short</nobr></div>
<div style="position:absolute;top:20619;left:108"><nobr>patterns), rather than asymptotically. We are also interested in comparing the plain and hierarchical</nobr></div>
<div style="position:absolute;top:20639;left:108"><nobr>verification methods.</nobr></div>
<div style="position:absolute;top:20660;left:133"><nobr>We have selected three groups of 64 patterns each, of lengths 4, 6 and 8. Each group is searched</nobr></div>
<div style="position:absolute;top:20680;left:108"><nobr>for with the superimposition method in seven possible ways: one <b style="color:black;background-color:#a0ffff">search</b> with all the 64 patterns su-</nobr></div>
<div style="position:absolute;top:20700;left:108"><nobr>perimposed, two searches of 32 patterns each, four searches with 16 patterns each, and so on until 64</nobr></div>
<div style="position:absolute;top:20721;left:108"><nobr>searches for a single pattern (no superimposition). The same group is also searched with the counting</nobr></div>
<div style="position:absolute;top:20741;left:108"><nobr>method (the amount of verifications triggered does not depend on the parallelization in this case). The</nobr></div>
<div style="position:absolute;top:20761;left:108"><nobr>superimposition method is attempted both with the plain and hierarchical verification methods.</nobr></div>
<div style="position:absolute;top:20782;left:133"><nobr>Figure 10 shows the number of verifications triggered per pattern and per text character (in the case</nobr></div>
<div style="position:absolute;top:20802;left:108"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:20804;left:118"><nobr>= 1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:20802;left:143"><nobr>we count just the number of matches, so this represents the actual matching probability). This plot</nobr></div>
<div style="position:absolute;top:20822;left:108"><nobr>is similar to Figure 8 except that we use much smaller m and show also the result of superimposition.</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:21084;left:153"><nobr>10</nobr></div>
<div style="position:absolute;top:21084;left:175"><nobr>20</nobr></div>
<div style="position:absolute;top:21084;left:198"><nobr>30</nobr></div>
<div style="position:absolute;top:21084;left:220"><nobr>40</nobr></div>
<div style="position:absolute;top:21084;left:243"><nobr>50</nobr></div>
<div style="position:absolute;top:21084;left:265"><nobr>60</nobr></div>
<div style="position:absolute;top:21084;left:287"><nobr>70</nobr></div>
<div style="position:absolute;top:21084;left:310"><nobr>80</nobr></div>
<div style="position:absolute;top:21084;left:332"><nobr>90</nobr></div>
<div style="position:absolute;top:21084;left:353"><nobr>100</nobr></div>
<div style="position:absolute;top:21084;left:375"><nobr>110</nobr></div>
<div style="position:absolute;top:21084;left:398"><nobr>120</nobr></div>
<div style="position:absolute;top:21052;left:123"><nobr>10</nobr></div>
<div style="position:absolute;top:21049;left:130"><nobr>−5</nobr></div>
<div style="position:absolute;top:21020;left:123"><nobr>10</nobr></div>
<div style="position:absolute;top:21016;left:130"><nobr>−4</nobr></div>
<div style="position:absolute;top:20988;left:123"><nobr>10</nobr></div>
<div style="position:absolute;top:20984;left:130"><nobr>−3</nobr></div>
<div style="position:absolute;top:20956;left:123"><nobr>10</nobr></div>
<div style="position:absolute;top:20952;left:130"><nobr>−2</nobr></div>
<div style="position:absolute;top:20923;left:123"><nobr>10</nobr></div>
<div style="position:absolute;top:20920;left:130"><nobr>−1</nobr></div>
<div style="position:absolute;top:20891;left:123"><nobr>10</nobr></div>
<div style="position:absolute;top:20888;left:130"><nobr>0</nobr></div>
<div style="position:absolute;top:20862;left:263"><nobr>m=4</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:21091;left:267"><nobr>k</nobr></div>
<div style="position:absolute;top:21048;left:120"><nobr># of verifications per character in input text</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:5px;font-family:Times">
<div style="position:absolute;top:21011;left:341"><nobr>real matches       </nobr></div>
<div style="position:absolute;top:21019;left:341"><nobr>counting           </nobr></div>
<div style="position:absolute;top:21026;left:341"><nobr>r=4 plain        </nobr></div>
<div style="position:absolute;top:21034;left:341"><nobr>r=16 plain       </nobr></div>
<div style="position:absolute;top:21042;left:341"><nobr>r=64 plain       </nobr></div>
<div style="position:absolute;top:21050;left:341"><nobr>r=4 hierarchical </nobr></div>
<div style="position:absolute;top:21058;left:341"><nobr>r=16 hierarchical</nobr></div>
<div style="position:absolute;top:21065;left:341"><nobr>r=64 hierarchical</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:21084;left:558"><nobr>5</nobr></div>
<div style="position:absolute;top:21084;left:612"><nobr>10</nobr></div>
<div style="position:absolute;top:21084;left:668"><nobr>15</nobr></div>
<div style="position:absolute;top:21084;left:723"><nobr>20</nobr></div>
<div style="position:absolute;top:21084;left:779"><nobr>25</nobr></div>
<div style="position:absolute;top:21079;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:21075;left:508"><nobr>−8</nobr></div>
<div style="position:absolute;top:21055;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:21051;left:508"><nobr>−7</nobr></div>
<div style="position:absolute;top:21030;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:21027;left:508"><nobr>−6</nobr></div>
<div style="position:absolute;top:21006;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:21002;left:508"><nobr>−5</nobr></div>
<div style="position:absolute;top:20982;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:20978;left:508"><nobr>−4</nobr></div>
<div style="position:absolute;top:20958;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:20954;left:508"><nobr>−3</nobr></div>
<div style="position:absolute;top:20933;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:20930;left:508"><nobr>−2</nobr></div>
<div style="position:absolute;top:20909;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:20905;left:508"><nobr>−1</nobr></div>
<div style="position:absolute;top:20885;left:502"><nobr>10</nobr></div>
<div style="position:absolute;top:20881;left:508"><nobr>0</nobr></div>
<div style="position:absolute;top:20861;left:643"><nobr>m=5</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:21091;left:646"><nobr>k</nobr></div>
<div style="position:absolute;top:21047;left:499"><nobr># of verifications per character in input text</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:5px;font-family:Times">
<div style="position:absolute;top:21011;left:720"><nobr>real matches       </nobr></div>
<div style="position:absolute;top:21018;left:720"><nobr>counting           </nobr></div>
<div style="position:absolute;top:21026;left:720"><nobr>r=4 plain        </nobr></div>
<div style="position:absolute;top:21034;left:720"><nobr>r=16 plain       </nobr></div>
<div style="position:absolute;top:21042;left:720"><nobr>r=64 plain       </nobr></div>
<div style="position:absolute;top:21050;left:720"><nobr>r=4 hierarchical </nobr></div>
<div style="position:absolute;top:21057;left:720"><nobr>r=16 hierarchical</nobr></div>
<div style="position:absolute;top:21065;left:720"><nobr>r=64 hierarchical</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:21345;left:322"><nobr>1</nobr></div>
<div style="position:absolute;top:21345;left:366"><nobr>2</nobr></div>
<div style="position:absolute;top:21345;left:411"><nobr>3</nobr></div>
<div style="position:absolute;top:21345;left:456"><nobr>4</nobr></div>
<div style="position:absolute;top:21345;left:500"><nobr>5</nobr></div>
<div style="position:absolute;top:21345;left:545"><nobr>6</nobr></div>
<div style="position:absolute;top:21345;left:590"><nobr>7</nobr></div>
<div style="position:absolute;top:21308;left:310"><nobr>10</nobr></div>
<div style="position:absolute;top:21305;left:317"><nobr>−6</nobr></div>
<div style="position:absolute;top:21274;left:310"><nobr>10</nobr></div>
<div style="position:absolute;top:21270;left:317"><nobr>−4</nobr></div>
<div style="position:absolute;top:21239;left:310"><nobr>10</nobr></div>
<div style="position:absolute;top:21235;left:317"><nobr>−2</nobr></div>
<div style="position:absolute;top:21204;left:310"><nobr>10</nobr></div>
<div style="position:absolute;top:21200;left:317"><nobr>0</nobr></div>
<div style="position:absolute;top:21169;left:310"><nobr>10</nobr></div>
<div style="position:absolute;top:21165;left:317"><nobr>2</nobr></div>
<div style="position:absolute;top:21134;left:310"><nobr>10</nobr></div>
<div style="position:absolute;top:21131;left:317"><nobr>4</nobr></div>
<div style="position:absolute;top:21122;left:451"><nobr>m=6</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:21352;left:455"><nobr>k</nobr></div>
<div style="position:absolute;top:21309;left:308"><nobr># of verifications per character in input text</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:5px;font-family:Times">
<div style="position:absolute;top:21141;left:370"><nobr>real matches       </nobr></div>
<div style="position:absolute;top:21149;left:370"><nobr>counting           </nobr></div>
<div style="position:absolute;top:21157;left:370"><nobr>r=4 plain        </nobr></div>
<div style="position:absolute;top:21165;left:370"><nobr>r=16 plain       </nobr></div>
<div style="position:absolute;top:21172;left:370"><nobr>r=64 plain       </nobr></div>
<div style="position:absolute;top:21180;left:370"><nobr>r=4 hierarchical </nobr></div>
<div style="position:absolute;top:21188;left:370"><nobr>r=16 hierarchical</nobr></div>
<div style="position:absolute;top:21196;left:370"><nobr>r=64 hierarchical</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21381;left:108"><nobr>Figure 10. Per character number of real matches, verifications of the counting methods, and verifications for</nobr></div>
<div style="position:absolute;top:21399;left:108"><nobr>different superimposition schemes. We show the cases m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:21401;left:453"><nobr>= 4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21399;left:471"><nobr>, 5 and 6.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21443;left:133"><nobr>As can be seen, hierarchical verification works better than plain verification, despite that in the worst</nobr></div>
</span></font>

<div style="position:absolute;top:21559;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=19><b>Page 19</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:21704;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:21704;left:765"><nobr>1019</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21755;left:112"><nobr>case it could work up to</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21757;left:273"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:21764;left:295"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21757;left:302"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21755;left:307"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21757;left:312"><nobr>)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21755;left:322"><nobr>more times. The plots also show that (as it should be clear) much more</nobr></div>
<div style="position:absolute;top:21775;left:112"><nobr>verifications are triggered as r increases. The counting filter shows to be better for larger k values and</nobr></div>
<div style="position:absolute;top:21796;left:112"><nobr>for smaller m values.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:21845;left:112"><nobr><b>7.3. Scanning Efficiency</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21880;left:112"><nobr>We now study the scanning efficiency of our algorithms. We tested with 35 Mb of random text (</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21882;left:747"><nobr>= 68</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21880;left:776"><nobr>)</nobr></div>
<div style="position:absolute;top:21901;left:112"><nobr>and a set of 100 random patterns of lengths m</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:21893;left:418"><nobr>2 f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21902;left:442"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21900;left:450"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21902;left:457"><nobr>5</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21900;left:465"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21902;left:472"><nobr>6</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:21893;left:480"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21901;left:494"><nobr>. This is a typical setup for intrusion detection</nobr></div>
<div style="position:absolute;top:21921;left:112"><nobr>applications, as explained in the Introduction. We use a Sun Enterprise 450 server (4 x UltraSPARC-II</nobr></div>
<div style="position:absolute;top:21941;left:112"><nobr>250MHz) running SunOS 5.6 with 512 Mb of RAM and w</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:21943;left:521"><nobr>= 32</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:21941;left:552"><nobr>. Each data point was obtained by</nobr></div>
<div style="position:absolute;top:21962;left:112"><nobr>averaging the Unix’s real time over 10 trials.</nobr></div>
<div style="position:absolute;top:21983;left:138"><nobr>Our concern now is which is the scanning efficiency of the algorithms compared to plain dynamic</nobr></div>
<div style="position:absolute;top:22003;left:112"><nobr>programming for one pattern, independently of their filtering efficiency to deal with <b style="color:black;background-color:#ff9999">multiple</b> patterns.</nobr></div>
<div style="position:absolute;top:22024;left:112"><nobr>Figure 11 shows the scanning efficiency of the dynamic programming, the bit-parallel simulation and</nobr></div>
<div style="position:absolute;top:22044;left:112"><nobr>the counting filter (using the bit-parallel simulation as the verification engine) for single random patterns</nobr></div>
<div style="position:absolute;top:22064;left:112"><nobr>with m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22066;left:164"><nobr>= 4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22064;left:185"><nobr>. We measure the megabytes per second (Mb/s) processed by the algorithms as k increases.</nobr></div>
<div style="position:absolute;top:22085;left:112"><nobr>As can be seen, the bit-parallel simulation is 2.5 to 3 times faster than the classical solution even for very</nobr></div>
<div style="position:absolute;top:22105;left:112"><nobr>large k values. The counting filter is in between.</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:22362;left:366"><nobr>20</nobr></div>
<div style="position:absolute;top:22362;left:411"><nobr>40</nobr></div>
<div style="position:absolute;top:22362;left:456"><nobr>60</nobr></div>
<div style="position:absolute;top:22362;left:501"><nobr>80</nobr></div>
<div style="position:absolute;top:22362;left:544"><nobr>100</nobr></div>
<div style="position:absolute;top:22362;left:589"><nobr>120</nobr></div>
<div style="position:absolute;top:22356;left:322"><nobr>2</nobr></div>
<div style="position:absolute;top:22331;left:322"><nobr>4</nobr></div>
<div style="position:absolute;top:22306;left:322"><nobr>6</nobr></div>
<div style="position:absolute;top:22281;left:322"><nobr>8</nobr></div>
<div style="position:absolute;top:22256;left:318"><nobr>10</nobr></div>
<div style="position:absolute;top:22230;left:318"><nobr>12</nobr></div>
<div style="position:absolute;top:22205;left:318"><nobr>14</nobr></div>
<div style="position:absolute;top:22180;left:318"><nobr>16</nobr></div>
<div style="position:absolute;top:22155;left:318"><nobr>18</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:22368;left:460"><nobr>k</nobr></div>
<div style="position:absolute;top:22255;left:315"><nobr>Mb/s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:22159;left:475"><nobr>Dynamic Prog       </nobr></div>
<div style="position:absolute;top:22173;left:475"><nobr>Bit−parallel Simulation </nobr></div>
<div style="position:absolute;top:22188;left:475"><nobr>Counting Filter    </nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22401;left:112"><nobr>Figure 11. Scanning efficiency of the bit-parallel simulation and the counting filter compared to the classical</nobr></div>
<div style="position:absolute;top:22419;left:112"><nobr>dynamic programming <b style="color:black;background-color:#99ff99">algorithm</b>.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:22493;left:112"><nobr><b>7.4. Overall Performance</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22529;left:112"><nobr>Finally, we consider how the filtering and scanning efficiency combine to form the overall performance.</nobr></div>
<div style="position:absolute;top:22550;left:138"><nobr>We compare first the impact of the number of patterns r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:22548;left:514"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22550;left:524"><nobr>in the multipattern filter based on super-</nobr></div>
<div style="position:absolute;top:22570;left:112"><nobr>imposed automata. We take m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22572;left:332"><nobr>= 4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22570;left:362"><nobr>(<i>i.e.</i>, the length of the shortest pattern in the set) and</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22572;left:743"><nobr>= 68</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22591;left:112"><nobr>for our analytical estimation of optimal superimposition, which yields r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:22589;left:591"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:22599;left:590"><nobr>k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:22601;left:597"><nobr>=4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22592;left:621"><nobr>= 8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22590;left:643"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22592;left:648"><nobr>93</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22591;left:663"><nobr>, r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:22589;left:686"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:22599;left:685"><nobr>k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:22601;left:692"><nobr>=6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22592;left:716"><nobr>= 6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22590;left:738"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22592;left:743"><nobr>41</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22591;left:764"><nobr>and</nobr></div>
<div style="position:absolute;top:22611;left:112"><nobr>r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:22609;left:120"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:22619;left:120"><nobr>k</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:22621;left:126"><nobr>=8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22613;left:151"><nobr>= 4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22611;left:174"><nobr>:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:22613;left:178"><nobr>94</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22611;left:194"><nobr>. Figure 12 (left) shows the Mb/s processed when using different values of r</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:22609;left:718"><nobr>0</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22611;left:728"><nobr>over a set</nobr></div>
<div style="position:absolute;top:22631;left:112"><nobr>of 100 patterns. As the analysis predicts, there is an optimal amount of superimposition that is reduced</nobr></div>
</span></font>

<div style="position:absolute;top:22747;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=20><b>Page 20</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:22892;left:108"><nobr>1020</nobr></div>
<div style="position:absolute;top:22892;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:22943;left:108"><nobr>as k grows. The analytically estimated optima are below the practical ones, since our analysis uses a</nobr></div>
<div style="position:absolute;top:22963;left:108"><nobr>pessimistic bound on the matching probability. We use the experimental optima in the tests that follow.</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:23224;left:126"><nobr>0</nobr></div>
<div style="position:absolute;top:23224;left:154"><nobr>5</nobr></div>
<div style="position:absolute;top:23224;left:179"><nobr>10</nobr></div>
<div style="position:absolute;top:23224;left:206"><nobr>15</nobr></div>
<div style="position:absolute;top:23224;left:233"><nobr>20</nobr></div>
<div style="position:absolute;top:23224;left:261"><nobr>25</nobr></div>
<div style="position:absolute;top:23224;left:288"><nobr>30</nobr></div>
<div style="position:absolute;top:23224;left:315"><nobr>35</nobr></div>
<div style="position:absolute;top:23224;left:342"><nobr>40</nobr></div>
<div style="position:absolute;top:23224;left:369"><nobr>45</nobr></div>
<div style="position:absolute;top:23224;left:396"><nobr>50</nobr></div>
<div style="position:absolute;top:23219;left:123"><nobr>0</nobr></div>
<div style="position:absolute;top:23189;left:123"><nobr>1</nobr></div>
<div style="position:absolute;top:23158;left:123"><nobr>2</nobr></div>
<div style="position:absolute;top:23127;left:123"><nobr>3</nobr></div>
<div style="position:absolute;top:23097;left:123"><nobr>4</nobr></div>
<div style="position:absolute;top:23066;left:123"><nobr>5</nobr></div>
<div style="position:absolute;top:23036;left:123"><nobr>6</nobr></div>
<div style="position:absolute;top:23005;left:123"><nobr>7</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:23230;left:261"><nobr>r’</nobr></div>
<div style="position:absolute;top:23117;left:120"><nobr>Mb/s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:23022;left:358"><nobr>k = 4</nobr></div>
<div style="position:absolute;top:23036;left:358"><nobr>k = 6</nobr></div>
<div style="position:absolute;top:23050;left:358"><nobr>k = 8</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:23225;left:509"><nobr>0</nobr></div>
<div style="position:absolute;top:23225;left:534"><nobr>10</nobr></div>
<div style="position:absolute;top:23225;left:561"><nobr>20</nobr></div>
<div style="position:absolute;top:23225;left:588"><nobr>30</nobr></div>
<div style="position:absolute;top:23225;left:614"><nobr>40</nobr></div>
<div style="position:absolute;top:23225;left:641"><nobr>50</nobr></div>
<div style="position:absolute;top:23225;left:667"><nobr>60</nobr></div>
<div style="position:absolute;top:23225;left:694"><nobr>70</nobr></div>
<div style="position:absolute;top:23225;left:721"><nobr>80</nobr></div>
<div style="position:absolute;top:23225;left:747"><nobr>90</nobr></div>
<div style="position:absolute;top:23225;left:772"><nobr>100</nobr></div>
<div style="position:absolute;top:23220;left:506"><nobr>0</nobr></div>
<div style="position:absolute;top:23199;left:501"><nobr>0.1</nobr></div>
<div style="position:absolute;top:23178;left:501"><nobr>0.2</nobr></div>
<div style="position:absolute;top:23157;left:501"><nobr>0.3</nobr></div>
<div style="position:absolute;top:23136;left:501"><nobr>0.4</nobr></div>
<div style="position:absolute;top:23115;left:501"><nobr>0.5</nobr></div>
<div style="position:absolute;top:23094;left:501"><nobr>0.6</nobr></div>
<div style="position:absolute;top:23073;left:501"><nobr>0.7</nobr></div>
<div style="position:absolute;top:23052;left:501"><nobr>0.8</nobr></div>
<div style="position:absolute;top:23031;left:501"><nobr>0.9</nobr></div>
<div style="position:absolute;top:23010;left:506"><nobr>1</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:23231;left:642"><nobr>r</nobr></div>
<div style="position:absolute;top:23155;left:498"><nobr>parallel/sequential</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:23025;left:663"><nobr>Superimposition Filter</nobr></div>
<div style="position:absolute;top:23037;left:663"><nobr>Counting Filter    </nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23264;left:108"><nobr>Figure 12. On the left, Mb/s vs partition size for k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:23266;left:440"><nobr>= 4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23264;left:461"><nobr>, k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:23266;left:486"><nobr>= 6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23264;left:512"><nobr>and k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:23266;left:554"><nobr>= 8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23264;left:581"><nobr>over a set of 100 patterns with</nobr></div>
<div style="position:absolute;top:23282;left:108"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:23279;left:124"><nobr>2 f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:23284;left:143"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23282;left:150"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:23284;left:156"><nobr>5</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23282;left:163"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:23284;left:170"><nobr>6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:23279;left:177"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23282;left:186"><nobr>. On the right, ratio between parallel and sequential versions of the algorithms.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23329;left:133"><nobr>We now show the degree of parallelism achieved by the superimposition and counting filters algo-</nobr></div>
<div style="position:absolute;top:23350;left:108"><nobr>rithms, in terms of the ratio between the parallel version and r applications of the corresponding single-</nobr></div>
<div style="position:absolute;top:23370;left:108"><nobr>pattern <b style="color:black;background-color:#99ff99">algorithm</b>. We <b style="color:black;background-color:#a0ffff">search</b> for the same set of randomly selected patterns (m</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:23362;left:629"><nobr>2 f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23372;left:654"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23370;left:662"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23372;left:669"><nobr>5</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23370;left:677"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23372;left:684"><nobr>6</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:23362;left:692"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23370;left:705"><nobr>) with k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23372;left:762"><nobr>= 8</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23370;left:782"><nobr>.</nobr></div>
<div style="position:absolute;top:23390;left:108"><nobr>Figure 12 (right) shows the behavior in terms of r. We observe that the multipattern filter quickly con-</nobr></div>
<div style="position:absolute;top:23411;left:108"><nobr>verges to a 5-fold improvement over its sequential version as r increases. The counting filter achieves a</nobr></div>
<div style="position:absolute;top:23431;left:108"><nobr>lower degree of parallelism, taking 0.27 of its sequential counterpart. The “waves” in the superimposition</nobr></div>
<div style="position:absolute;top:23451;left:108"><nobr>filter is due to a discretization effect when the patterns are divided into groups.</nobr></div>
<div style="position:absolute;top:23473;left:133"><nobr>Figure 13 shows the impact of searching allowing different numbers of insertions for both algorithms,</nobr></div>
<div style="position:absolute;top:23493;left:108"><nobr>for pattern sets of r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23495;left:249"><nobr>=</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:23486;left:265"><nobr>f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23495;left:272"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23493;left:280"><nobr>::</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23495;left:289"><nobr>100</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:23486;left:312"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23493;left:326"><nobr>. We observe that performance remains stable up to a limit around</nobr></div>
<div style="position:absolute;top:23513;left:108"><nobr>r</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23515;left:121"><nobr>= 25</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23514;left:157"><nobr>with low k. For higher k values, however, performance drops drastically from the beginning.</nobr></div>
<div style="position:absolute;top:23534;left:108"><nobr>The counting filter resists more this behavior, which shows its higher tolerance to insertions for short</nobr></div>
<div style="position:absolute;top:23554;left:108"><nobr>patterns. To see this, note that the case m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23556;left:394"><nobr>= 6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23554;left:417"><nobr>, k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23556;left:441"><nobr>= 25</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23554;left:477"><nobr>and</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:23556;left:517"><nobr>= 68</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23554;left:553"><nobr>is totally inside the scope of the</nobr></div>
<div style="position:absolute;top:23575;left:108"><nobr>counting filter according to the analysis, while the superimposition filter can only superimpose 3 patterns</nobr></div>
<div style="position:absolute;top:23595;left:108"><nobr>under this setup.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:23650;left:108"><nobr><b>8. Application to a Real-Life Case</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:23696;left:108"><nobr>The experiments of the previous section use an idealized model where text and patterns are randomly</nobr></div>
<div style="position:absolute;top:23716;left:108"><nobr>generated. This is useful to generate massive data and check the experimental performance against the</nobr></div>
<div style="position:absolute;top:23737;left:108"><nobr>predictions. We complete the above experiments with a real-life case study.</nobr></div>
<div style="position:absolute;top:23758;left:133"><nobr>We experimentally study how the probabilistic model of <b style="color:black;background-color:#ffff66">string</b> matching allowing insertions relates</nobr></div>
<div style="position:absolute;top:23779;left:108"><nobr>to the problem of false negatives and positives. Our goal is to determine how</nobr></div>
<div style="position:absolute;top:23779;left:665"><nobr>relates to the ratio</nobr></div>
<div style="position:absolute;top:23799;left:108"><nobr>between false negatives and positives and the total number of reported attacks and, consequently, to the</nobr></div>
<div style="position:absolute;top:23819;left:108"><nobr>filtering efficiency of the model.</nobr></div>
</span></font>

<div style="position:absolute;top:23935;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=21><b>Page 21</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:24080;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:24080;left:765"><nobr>1021</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:24348;left:133"><nobr>0</nobr></div>
<div style="position:absolute;top:24348;left:159"><nobr>10</nobr></div>
<div style="position:absolute;top:24348;left:185"><nobr>20</nobr></div>
<div style="position:absolute;top:24348;left:212"><nobr>30</nobr></div>
<div style="position:absolute;top:24348;left:239"><nobr>40</nobr></div>
<div style="position:absolute;top:24348;left:266"><nobr>50</nobr></div>
<div style="position:absolute;top:24348;left:293"><nobr>60</nobr></div>
<div style="position:absolute;top:24348;left:319"><nobr>70</nobr></div>
<div style="position:absolute;top:24348;left:346"><nobr>80</nobr></div>
<div style="position:absolute;top:24348;left:373"><nobr>90</nobr></div>
<div style="position:absolute;top:24348;left:398"><nobr>100</nobr></div>
<div style="position:absolute;top:24343;left:130"><nobr>0</nobr></div>
<div style="position:absolute;top:24317;left:130"><nobr>2</nobr></div>
<div style="position:absolute;top:24290;left:130"><nobr>4</nobr></div>
<div style="position:absolute;top:24264;left:130"><nobr>6</nobr></div>
<div style="position:absolute;top:24237;left:130"><nobr>8</nobr></div>
<div style="position:absolute;top:24211;left:127"><nobr>10</nobr></div>
<div style="position:absolute;top:24185;left:127"><nobr>12</nobr></div>
<div style="position:absolute;top:24158;left:127"><nobr>14</nobr></div>
<div style="position:absolute;top:24132;left:127"><nobr>16</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:24354;left:267"><nobr>r</nobr></div>
<div style="position:absolute;top:24242;left:124"><nobr>Mb/s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:24147;left:288"><nobr>Counting Filter     </nobr></div>
<div style="position:absolute;top:24160;left:288"><nobr>Superimposition Filter</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:4px;font-family:Times">
<div style="position:absolute;top:24348;left:516"><nobr>0</nobr></div>
<div style="position:absolute;top:24348;left:541"><nobr>10</nobr></div>
<div style="position:absolute;top:24348;left:568"><nobr>20</nobr></div>
<div style="position:absolute;top:24348;left:595"><nobr>30</nobr></div>
<div style="position:absolute;top:24348;left:622"><nobr>40</nobr></div>
<div style="position:absolute;top:24348;left:648"><nobr>50</nobr></div>
<div style="position:absolute;top:24348;left:675"><nobr>60</nobr></div>
<div style="position:absolute;top:24348;left:702"><nobr>70</nobr></div>
<div style="position:absolute;top:24348;left:729"><nobr>80</nobr></div>
<div style="position:absolute;top:24348;left:756"><nobr>90</nobr></div>
<div style="position:absolute;top:24348;left:781"><nobr>100</nobr></div>
<div style="position:absolute;top:24343;left:513"><nobr>0</nobr></div>
<div style="position:absolute;top:24317;left:513"><nobr>2</nobr></div>
<div style="position:absolute;top:24290;left:513"><nobr>4</nobr></div>
<div style="position:absolute;top:24264;left:513"><nobr>6</nobr></div>
<div style="position:absolute;top:24237;left:513"><nobr>8</nobr></div>
<div style="position:absolute;top:24211;left:509"><nobr>10</nobr></div>
<div style="position:absolute;top:24185;left:509"><nobr>12</nobr></div>
<div style="position:absolute;top:24158;left:509"><nobr>14</nobr></div>
<div style="position:absolute;top:24132;left:509"><nobr>16</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:24354;left:650"><nobr>r</nobr></div>
<div style="position:absolute;top:24242;left:507"><nobr>Mb/s</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:24147;left:671"><nobr>Counting Filter     </nobr></div>
<div style="position:absolute;top:24160;left:671"><nobr>Superimposition Filter</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24388;left:112"><nobr>Figure 13. Mb/s processed by both algorithms for a set of patterns with m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:24385;left:585"><nobr>2 f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:24390;left:606"><nobr>4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24388;left:613"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:24390;left:620"><nobr>5</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24388;left:627"><nobr>;</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:24390;left:633"><nobr>6</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:24385;left:640"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24388;left:654"><nobr>with k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:24390;left:700"><nobr>= 4</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24388;left:726"><nobr>(left) and</nobr></div>
<div style="position:absolute;top:24406;left:112"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:24408;left:124"><nobr>= 25</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24406;left:153"><nobr>(right).</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:24461;left:138"><nobr>The experimental input data consists of an audit trail and an attack database. The audit trail was</nobr></div>
<div style="position:absolute;top:24481;left:112"><nobr>collected using the Gassata intrusion detection system [18] in a real environment. The log format is an</nobr></div>
<div style="position:absolute;top:24502;left:112"><nobr>extension of the log format proposed in [6]:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24538;left:112"><nobr>#S#version=suntrad5.6#system=SOLARIS#deamon=system#ahost=amstel#no=28#</nobr></div>
<div style="position:absolute;top:24556;left:112"><nobr>event=AUE_EXECVE#date=2000.3.14@14.29.41#program=/var/audit/ls#</nobr></div>
<div style="position:absolute;top:24574;left:112"><nobr>file=/var/audit/ls#euid=root#egid=other#ruid=root#rgid=other#pid=13949#</nobr></div>
<div style="position:absolute;top:24592;left:112"><nobr>error=-1#return=KO#E#I#</nobr></div>
<div style="position:absolute;top:24628;left:112"><nobr>#S#version=suntrad5.6#system=SOLARIS#deamon=system#ahost=lancelot#no=29#</nobr></div>
<div style="position:absolute;top:24646;left:112"><nobr>event=AUE_EXECVE#date=2000.3.14@14.29.41#program=/usr/bin/ls#</nobr></div>
<div style="position:absolute;top:24664;left:112"><nobr>file=/usr/bin/ls#arg=ls,-als#euid=root#egid=other#ruid=root#rgid=other#</nobr></div>
<div style="position:absolute;top:24682;left:112"><nobr>pid=13949#error=0#return=OK#E#I#</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:24719;left:138"><nobr>The attack database consists of attacks signatures with the following format:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24756;left:144"><nobr>&gt;&gt;&gt; Attack_login</nobr></div>
<div style="position:absolute;top:24773;left:144"><nobr>rule1</nobr></div>
<div style="position:absolute;top:24791;left:144"><nobr>rule1</nobr></div>
<div style="position:absolute;top:24809;left:144"><nobr>rule1</nobr></div>
<div style="position:absolute;top:24827;left:144"><nobr>&gt;&gt;&gt; Attack_file_creation</nobr></div>
<div style="position:absolute;top:24845;left:144"><nobr>rule2</nobr></div>
<div style="position:absolute;top:24863;left:144"><nobr>&gt;&gt;&gt; Attack_ps_cmd</nobr></div>
<div style="position:absolute;top:24881;left:144"><nobr>rule3</nobr></div>
<div style="position:absolute;top:24899;left:144"><nobr>rule7</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:24936;left:138"><nobr>The rules are defined in the following way:</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:24973;left:144"><nobr>rule1 ::= ( (event=AUE_login)||(event=AUE_rlogin) ) &amp;&amp; (return=KO) ;</nobr></div>
<div style="position:absolute;top:24991;left:144"><nobr>rule2 ::= (event=AUE_CREAT) &amp;&amp; ( (file co ls)||(file co cd) ) ;</nobr></div>
<div style="position:absolute;top:25009;left:144"><nobr>rule3 ::= (event=AUE_EXECVE) &amp;&amp; (program=/usr/bin/ps) ;</nobr></div>
</span></font>

<div style="position:absolute;top:25123;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=22><b>Page 22</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:25268;left:108"><nobr>1022</nobr></div>
<div style="position:absolute;top:25268;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:25320;left:139"><nobr>rule4 ::= (event=AUE_EXECVE) &amp;&amp; (program co crack) ;</nobr></div>
<div style="position:absolute;top:25338;left:139"><nobr>rule5 ::= (event=AUE_su);</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:25373;left:108"><nobr>where the co operator stands for “<b>co</b>ntains”.</nobr></div>
<div style="position:absolute;top:25413;left:133"><nobr>The audit trail and attack signatures are translated into a pattern matching representation in three</nobr></div>
<div style="position:absolute;top:25434;left:108"><nobr>steps. First, a different character is assigned to each rule (<i>e.g.</i>, rule1 = ’a’). Attack signatures are then</nobr></div>
<div style="position:absolute;top:25454;left:108"><nobr>translated into patterns by mapping their rules to the corresponding characters. Finally, the audit trail is</nobr></div>
<div style="position:absolute;top:25474;left:108"><nobr>scanned and its events are matched against the rules. Events which match more than one rule are assigned</nobr></div>
<div style="position:absolute;top:25495;left:108"><nobr>the corresponding characters. Events which do not match a rule are assigned arbitrary characters. The</nobr></div>
<div style="position:absolute;top:25515;left:108"><nobr>final <b style="color:black;background-color:#ffff66">string</b> is constructed by concatenating the sequence of characters corresponding to matches of rules</nobr></div>
<div style="position:absolute;top:25535;left:108"><nobr>and the arbitrary characters.</nobr></div>
<div style="position:absolute;top:25556;left:133"><nobr>We used an audit file of 24,847 events and studied three different series of actions:</nobr></div>
<div style="position:absolute;top:25591;left:108"><nobr><i><b>Chained who: </b></i>represented as a pattern of four events of a &quot;who&quot; command. The probability of the</nobr></div>
<div style="position:absolute;top:25612;left:149"><nobr>corresponding character in our audit file is 0.004382 and there are four real attacks of this kind in</nobr></div>
<div style="position:absolute;top:25632;left:149"><nobr>the audit file.</nobr></div>
<div style="position:absolute;top:25664;left:108"><nobr><i><b>Sensitive commands: </b></i>represented as a pattern of ten events of any command in the set</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:25657;left:677"><nobr>f</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:25664;left:688"><nobr>&quot;last&quot;, &quot;ps&quot;,</nobr></div>
<div style="position:absolute;top:25684;left:149"><nobr>&quot;who&quot;, &quot;whois&quot;</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:25677;left:260"><nobr>g</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:25685;left:273"><nobr>. The probability of the corresponding character in our audit file is 0.007187</nobr></div>
<div style="position:absolute;top:25705;left:149"><nobr>and there are two real attacks of this kind in the audit file.</nobr></div>
<div style="position:absolute;top:25738;left:108"><nobr><i><b>Chained whois: </b></i>represented as a pattern of four events of a &quot;whois&quot; command. The probability of the</nobr></div>
<div style="position:absolute;top:25759;left:149"><nobr>corresponding character in our audit file is 0.001402 and there is one real attack of this kind in the</nobr></div>
<div style="position:absolute;top:25779;left:149"><nobr>audit file.</nobr></div>
<div style="position:absolute;top:25815;left:133"><nobr>The audit trail and attacks described above may seem not representative enough because of their</nobr></div>
<div style="position:absolute;top:25835;left:108"><nobr>small size. However, it must be noted that it is extremely difficult to obtain audit trails with traces of</nobr></div>
<div style="position:absolute;top:25855;left:108"><nobr>attacks for several reasons. First of all, the owners of such trails are reluctant to give their logs away</nobr></div>
<div style="position:absolute;top:25876;left:108"><nobr>because of confidentiality and security concerns. Secondly, the log generating systems are not perfect</nobr></div>
<div style="position:absolute;top:25896;left:108"><nobr>in the sense that they do not log all the events that could appear as part of an attack. As a consequence,</nobr></div>
<div style="position:absolute;top:25916;left:108"><nobr>detection of some attacks is impossible. Though the audit trail and attacks used in this experiment are</nobr></div>
<div style="position:absolute;top:25937;left:108"><nobr>small, we decided to use them because they are genuine, that is, they correspond to a real case.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:25979;left:108"><nobr><b>8.1. Effectiveness of the Filter and False Negatives</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:26013;left:108"><nobr>We have searched for the three patterns in our audit file allowing an increasing number of insertions k.</nobr></div>
<div style="position:absolute;top:26033;left:108"><nobr>Our goal is to determine the effectiveness of the proposed filtering <b style="color:black;background-color:#99ff99">algorithm</b>. That is: how much text</nobr></div>
<div style="position:absolute;top:26053;left:108"><nobr>is able to filter out in order to retrieve what fraction of the real attacks that occur in the audit file? The</nobr></div>
<div style="position:absolute;top:26074;left:108"><nobr>text that our filter is not able to discard has to be processed by a more sophisticated <b style="color:black;background-color:#99ff99">algorithm</b> in order to</nobr></div>
<div style="position:absolute;top:26094;left:108"><nobr>determine the presence of a real attack. As those algorithms are much slower than our pattern matching</nobr></div>
<div style="position:absolute;top:26114;left:108"><nobr>based approach, the effectiveness of the filter is crucial.</nobr></div>
<div style="position:absolute;top:26134;left:133"><nobr>By applying the analytical predictions of Section 5.2 to our real data, we computed the maximum</nobr></div>
<div style="position:absolute;top:26154;left:108"><nobr>k value for which the matching probability does not reach 1 (recall that the model is pessimistic). To</nobr></div>
<div style="position:absolute;top:26175;left:108"><nobr>compute that maximum value, we have used the most precise formula (Eq. (2)) for the matching proba-</nobr></div>
<div style="position:absolute;top:26195;left:108"><nobr>bility. Given that the text is biased we have replaced</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:26197;left:460"><nobr>1</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:26195;left:468"><nobr>=</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:26192;left:487"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:26195;left:503"><nobr>by p</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:10px;font-family:Times">
<div style="position:absolute;top:26192;left:533"><nobr>m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:26195;left:545"><nobr>, where p is the relative frequency of</nobr></div>
</span></font>

<div style="position:absolute;top:26311;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=23><b>Page 23</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:26456;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:26456;left:765"><nobr>1023</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:26508;left:201"><nobr>Attack</nobr></div>
<div style="position:absolute;top:26508;left:318"><nobr>m</nobr></div>
<div style="position:absolute;top:26508;left:359"><nobr>Occs.</nobr></div>
<div style="position:absolute;top:26508;left:422"><nobr>Prob. char</nobr></div>
<div style="position:absolute;top:26508;left:517"><nobr>Nec. k</nobr></div>
<div style="position:absolute;top:26508;left:588"><nobr>Max. k</nobr></div>
<div style="position:absolute;top:26508;left:662"><nobr>Fract. of text</nobr></div>
<div style="position:absolute;top:26533;left:179"><nobr>Chained who</nobr></div>
<div style="position:absolute;top:26533;left:321"><nobr>4</nobr></div>
<div style="position:absolute;top:26533;left:374"><nobr>4</nobr></div>
<div style="position:absolute;top:26533;left:427"><nobr>0.004382</nobr></div>
<div style="position:absolute;top:26533;left:528"><nobr>225</nobr></div>
<div style="position:absolute;top:26533;left:601"><nobr>500</nobr></div>
<div style="position:absolute;top:26533;left:685"><nobr>8.21%</nobr></div>
<div style="position:absolute;top:26558;left:155"><nobr>Sensitive commands</nobr></div>
<div style="position:absolute;top:26558;left:316"><nobr>10</nobr></div>
<div style="position:absolute;top:26558;left:374"><nobr>2</nobr></div>
<div style="position:absolute;top:26558;left:426"><nobr>0.007187</nobr></div>
<div style="position:absolute;top:26558;left:528"><nobr>580</nobr></div>
<div style="position:absolute;top:26558;left:601"><nobr>620</nobr></div>
<div style="position:absolute;top:26558;left:681"><nobr>14.50%</nobr></div>
<div style="position:absolute;top:26582;left:174"><nobr>Chained whois</nobr></div>
<div style="position:absolute;top:26582;left:321"><nobr>4</nobr></div>
<div style="position:absolute;top:26582;left:374"><nobr>1</nobr></div>
<div style="position:absolute;top:26582;left:427"><nobr>0.001402</nobr></div>
<div style="position:absolute;top:26582;left:524"><nobr>1425</nobr></div>
<div style="position:absolute;top:26582;left:597"><nobr>1570</nobr></div>
<div style="position:absolute;top:26582;left:685"><nobr>5.74%</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:26636;left:284"><nobr>Table 1. Main parameters for the three <b style="color:black;background-color:#a0ffff">search</b> patterns.</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:26935;left:286"><nobr>0</nobr></div>
<div style="position:absolute;top:26894;left:270"><nobr>0.02</nobr></div>
<div style="position:absolute;top:26852;left:270"><nobr>0.04</nobr></div>
<div style="position:absolute;top:26811;left:270"><nobr>0.06</nobr></div>
<div style="position:absolute;top:26770;left:270"><nobr>0.08</nobr></div>
<div style="position:absolute;top:26728;left:276"><nobr>0.1</nobr></div>
<div style="position:absolute;top:26687;left:270"><nobr>0.12</nobr></div>
<div style="position:absolute;top:26947;left:297"><nobr>0</nobr></div>
<div style="position:absolute;top:26947;left:354"><nobr>0.2</nobr></div>
<div style="position:absolute;top:26947;left:417"><nobr>0.4</nobr></div>
<div style="position:absolute;top:26947;left:480"><nobr>0.6</nobr></div>
<div style="position:absolute;top:26947;left:543"><nobr>0.8</nobr></div>
<div style="position:absolute;top:26947;left:610"><nobr>1</nobr></div>
<div style="position:absolute;top:26867;left:255"><nobr>fract. of text not filtered</nobr></div>
<div style="position:absolute;top:26964;left:408"><nobr>fract. of attacks detected</nobr></div>
<div style="position:absolute;top:26708;left:321"><nobr>chained who</nobr></div>
<div style="position:absolute;top:26719;left:310"><nobr>sensitive cmds</nobr></div>
<div style="position:absolute;top:26731;left:312"><nobr>chained whois</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:26997;left:185"><nobr>Figure 14. Fraction of attacks detected versus fraction of text left for further processing.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:27054;left:112"><nobr>the character that forms the pattern (all the attacks are repetitions of a single character, otherwise we can</nobr></div>
<div style="position:absolute;top:27075;left:112"><nobr>just multiply the probabilities of the participating characters).</nobr></div>
<div style="position:absolute;top:27096;left:138"><nobr>Together with the maximum k recommended by the model we have computed the fraction of the text</nobr></div>
<div style="position:absolute;top:27116;left:112"><nobr>that the filter selects (for that k) as a candidate for further evaluation. This is simply the m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:27118;left:696"><nobr>+</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:27116;left:706"><nobr>k characters</nobr></div>
<div style="position:absolute;top:27137;left:112"><nobr>preceding every match, avoiding to count <b style="color:black;background-color:#ff9999">multiple</b> times the overlapping areas.</nobr></div>
<div style="position:absolute;top:27158;left:138"><nobr>Table 1 shows that using the maximum k recommended by the model selects just 6% to 15% of the</nobr></div>
<div style="position:absolute;top:27178;left:112"><nobr>text to be processed by a more costly <b style="color:black;background-color:#99ff99">algorithm</b>. Moreover, we show in the column of “necessary k” the</nobr></div>
<div style="position:absolute;top:27199;left:112"><nobr>minimum k value that is necessary to detect all the attacks present in the audit file. This turns out to be</nobr></div>
<div style="position:absolute;top:27219;left:112"><nobr>below (and generally close to) the maximum k recommended by the model. Therefore, the model can be</nobr></div>
<div style="position:absolute;top:27239;left:112"><nobr>used to obtain a good estimation of the k value to use in order to detect all real attacks. Of course, it is</nobr></div>
<div style="position:absolute;top:27260;left:112"><nobr>also possible to use specific knowledge of the application to determine the appropriate k.</nobr></div>
<div style="position:absolute;top:27309;left:112"><nobr><b>8.1.1. False negatives</b></nobr></div>
<div style="position:absolute;top:27343;left:112"><nobr>Another interesting experiment is related to the evolution of the number of attacks detected as a function</nobr></div>
<div style="position:absolute;top:27363;left:112"><nobr>of the fraction of text not filtered out. That is: what is the percentage of text that we will need to evaluate</nobr></div>
<div style="position:absolute;top:27383;left:112"><nobr>with a more complex <b style="color:black;background-color:#99ff99">algorithm</b> in order to detect a given fraction of the real attacks?</nobr></div>
</span></font>

<div style="position:absolute;top:27499;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=24><b>Page 24</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:27644;left:108"><nobr>1024</nobr></div>
<div style="position:absolute;top:27644;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:27949;left:268"><nobr>0</nobr></div>
<div style="position:absolute;top:27913;left:268"><nobr>5</nobr></div>
<div style="position:absolute;top:27878;left:261"><nobr>10</nobr></div>
<div style="position:absolute;top:27842;left:261"><nobr>15</nobr></div>
<div style="position:absolute;top:27807;left:261"><nobr>20</nobr></div>
<div style="position:absolute;top:27771;left:261"><nobr>25</nobr></div>
<div style="position:absolute;top:27736;left:261"><nobr>30</nobr></div>
<div style="position:absolute;top:27701;left:261"><nobr>35</nobr></div>
<div style="position:absolute;top:27960;left:278"><nobr>0</nobr></div>
<div style="position:absolute;top:27960;left:323"><nobr>500</nobr></div>
<div style="position:absolute;top:27960;left:371"><nobr>1000</nobr></div>
<div style="position:absolute;top:27960;left:422"><nobr>1500</nobr></div>
<div style="position:absolute;top:27960;left:474"><nobr>2000</nobr></div>
<div style="position:absolute;top:27960;left:525"><nobr>2500</nobr></div>
<div style="position:absolute;top:27960;left:576"><nobr>3000</nobr></div>
<div style="position:absolute;top:27960;left:628"><nobr>3500</nobr></div>
<div style="position:absolute;top:27859;left:251"><nobr>matches found</nobr></div>
<div style="position:absolute;top:27978;left:442"><nobr>k value</nobr></div>
<div style="position:absolute;top:27710;left:521"><nobr>chained who</nobr></div>
<div style="position:absolute;top:27722;left:510"><nobr>sensitive cmds</nobr></div>
<div style="position:absolute;top:27734;left:513"><nobr>chained whois</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:28010;left:276"><nobr>Figure 15. Number of matches found as a function of k.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:28068;left:133"><nobr>Regarding the false negatives, we evaluated, for our three particular patterns, the fraction of text</nobr></div>
<div style="position:absolute;top:28088;left:108"><nobr>filtered as a function of the fraction of attacks detected (see Figure 14). As can be seen, the curve is</nobr></div>
<div style="position:absolute;top:28108;left:108"><nobr>concave, which suggests that considering a very small fraction of the text permits to detect most of the</nobr></div>
<div style="position:absolute;top:28129;left:108"><nobr>attacks. For example, with a k value that leaves just 2% of the text for further evaluation we get 50% of</nobr></div>
<div style="position:absolute;top:28149;left:108"><nobr>the attacks (and thus 50% of false negatives). We have here a way to balance the false negatives rate and</nobr></div>
<div style="position:absolute;top:28169;left:108"><nobr>the speed of detection. Of course, in many cases, no false negative is required. In that situation, the value</nobr></div>
<div style="position:absolute;top:28190;left:108"><nobr>of k determined by the model is an upper bound of the value to be used for the corresponding pattern.</nobr></div>
<div style="position:absolute;top:28238;left:108"><nobr><b>8.1.2. False positives</b></nobr></div>
<div style="position:absolute;top:28271;left:108"><nobr>Regarding the false positives, we studied the evolution of the number of matches as a function of k</nobr></div>
<div style="position:absolute;top:28292;left:108"><nobr>for the three patterns (see Figure 15). Of course, for some patterns, the use of an excessively large k</nobr></div>
<div style="position:absolute;top:28312;left:108"><nobr>value leads to many false positives. Let us note that these false positives may be discarded by the more</nobr></div>
<div style="position:absolute;top:28332;left:108"><nobr>accurate detection <b style="color:black;background-color:#99ff99">algorithm</b> which may analyse the output of our pattern matching mechanism (recall</nobr></div>
<div style="position:absolute;top:28353;left:108"><nobr>that we give a part of the trail containing a <i>potential </i>attack). To limit false positives without allowing</nobr></div>
<div style="position:absolute;top:28373;left:108"><nobr>false negatives, the value of k determined by the model appears as a near-optimum.</nobr></div>
<div style="position:absolute;top:28394;left:133"><nobr>It is interesting to observe that some curves of Figure 15 (most notably <i>sensitive commands</i>) behave</nobr></div>
<div style="position:absolute;top:28414;left:108"><nobr>much as the synthetic curve of Figure 8. We believe that the fitting would be better with a larger text,</nobr></div>
<div style="position:absolute;top:28435;left:108"><nobr>since currently it is not large enough to obtain smooth averages.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:28487;left:108"><nobr><b>9. Conclusions</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:28531;left:108"><nobr>We have presented a <b style="color:black;background-color:#ffff66">string</b> matching approach to the problem of intrusion detection, which is formalized</nobr></div>
<div style="position:absolute;top:28551;left:108"><nobr>as the problem of multipattern matching allowing insertions. Besides the classical solution for one pattern</nobr></div>
<div style="position:absolute;top:28571;left:108"><nobr>adapted from the field of approximate pattern matching, we have presented two new <b style="color:black;background-color:#a0ffff">search</b> algorithms</nobr></div>
</span></font>

<div style="position:absolute;top:28687;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=25><b>Page 25</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:28832;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:28832;left:765"><nobr>1025</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:28883;left:112"><nobr>which we also extended to handle <b style="color:black;background-color:#ff9999">multiple</b> patterns. Each of the two algorithms can be better than the</nobr></div>
<div style="position:absolute;top:28903;left:112"><nobr>other depending on the number of insertions allowed and the pattern length.</nobr></div>
<div style="position:absolute;top:28925;left:138"><nobr>We have presented analytical and experimental results concerning the performance of the new algo-</nobr></div>
<div style="position:absolute;top:28945;left:112"><nobr>rithms. As an example, we illustrate the case of 4-characters patterns searched for allowing 4 insertions,</nobr></div>
<div style="position:absolute;top:28965;left:112"><nobr>which is a case of interest in intrusion detection applications. The single pattern versions are typically</nobr></div>
<div style="position:absolute;top:28985;left:112"><nobr>3 times faster than the classical solution. The multipattern algorithms allow searching for 100 patterns</nobr></div>
<div style="position:absolute;top:29006;left:112"><nobr>at the same cost of 4 single pattern searches (a 25-fold speedup). As a result, our new algorithms allow</nobr></div>
<div style="position:absolute;top:29026;left:112"><nobr>searching for 100 patterns at a rate of 4 Mb/s in our machine, while the classical <b style="color:black;background-color:#99ff99">algorithm</b> can <b style="color:black;background-color:#a0ffff">search</b></nobr></div>
<div style="position:absolute;top:29046;left:112"><nobr>for just one single pattern at 5 Mb/s, a 75-fold improvement.</nobr></div>
<div style="position:absolute;top:29068;left:138"><nobr>In the field of approximate <b style="color:black;background-color:#ffff66">string</b> matching, the fastest algorithms are filters able to discard most</nobr></div>
<div style="position:absolute;top:29088;left:112"><nobr>of the text by checking a necessary condition. In general, those filters cannot easily be applied here</nobr></div>
<div style="position:absolute;top:29108;left:112"><nobr>because the error levels typical in intrusion detection applications are too high for the standards of the</nobr></div>
<div style="position:absolute;top:29129;left:112"><nobr>approximate <b style="color:black;background-color:#ffff66">string</b> matching problem. We have shown, however, that some filtration techniques can be</nobr></div>
<div style="position:absolute;top:29149;left:112"><nobr>adapted to this problem to obtain a large improvement in the performance of multipattern searching.</nobr></div>
<div style="position:absolute;top:29170;left:138"><nobr>Concerning a detailed tuning of implementation choices, a number of potential optimizations could</nobr></div>
<div style="position:absolute;top:29190;left:112"><nobr>bring large improvements in practice. For example, in the multipattern filter <b style="color:black;background-color:#99ff99">algorithm</b>, if the patterns</nobr></div>
<div style="position:absolute;top:29211;left:112"><nobr>have different length, we just truncate them to the shortest one when superimposing the automata. We</nobr></div>
<div style="position:absolute;top:29231;left:112"><nobr>can select cleverly the substrings to use, since having the same character at the same position in two</nobr></div>
<div style="position:absolute;top:29251;left:112"><nobr>patterns improves the filtering mechanism. Also, we used simple heuristics to group subpatterns in</nobr></div>
<div style="position:absolute;top:29272;left:112"><nobr>the superimposed automata. These can be improved to maximize common characters too. Finally, the</nobr></div>
<div style="position:absolute;top:29292;left:112"><nobr>multipattern filter is limited to patterns of size m</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:29294;left:443"><nobr>(</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:29284;left:448"><nobr>d</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:29294;left:461"><nobr>log</nobr></div>
</span></font>
<font size=2 face="Times"><span style="font-size:8px;font-family:Times">
<div style="position:absolute;top:29301;left:480"><nobr>2</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:29294;left:487"><nobr>(</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:29292;left:491"><nobr>k</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:29294;left:505"><nobr>+ 1)</nobr></div>
</span></font>
<font size=4 face="Times"><span style="font-size:22px;font-family:Times">
<div style="position:absolute;top:29284;left:531"><nobr>e</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:29294;left:549"><nobr>+ 1)</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:14px;font-family:Times">
<div style="position:absolute;top:29292;left:597"><nobr>w. Automaton and pattern</nobr></div>
<div style="position:absolute;top:29313;left:112"><nobr>partition techniques [4] can be incorporated to <b style="color:black;background-color:#a0ffff">search</b> for longer patterns. Furthermore, the combination</nobr></div>
<div style="position:absolute;top:29333;left:112"><nobr>of techniques can be considered in order to increase the tolerance to insertions.</nobr></div>
<div style="position:absolute;top:29354;left:138"><nobr>Related to this last point about the length of the patterns, we point out that we have concentrated in</nobr></div>
<div style="position:absolute;top:29374;left:112"><nobr>the parameters typical of intrusion detection, where the patterns are rather short, the error level is quite</nobr></div>
<div style="position:absolute;top:29395;left:112"><nobr>high, and the number of patterns is large. The new algorithms we have presented are very well suited to</nobr></div>
<div style="position:absolute;top:29415;left:112"><nobr>this setup, but other variants of the problem could be of interest in other applications and could demand</nobr></div>
<div style="position:absolute;top:29435;left:112"><nobr>(or permit) different approaches. A weakness of our methods that could be addressed is the need that the</nobr></div>
<div style="position:absolute;top:29456;left:112"><nobr>patterns have more or less the same length.</nobr></div>
<div style="position:absolute;top:29477;left:138"><nobr>In particular, more sophisticated models of attacks may yield more complex pattern matching prob-</nobr></div>
<div style="position:absolute;top:29497;left:112"><nobr>lems, involving for example regular expression searching allowing insertions or permitting transpositions</nobr></div>
<div style="position:absolute;top:29517;left:112"><nobr>(swaps) of events in the pattern, as well as a limited number of missing pattern events. We remark that</nobr></div>
<div style="position:absolute;top:29538;left:112"><nobr>the counting filter is well suited to deal with transpositions, while fast algorithms for regular expression</nobr></div>
<div style="position:absolute;top:29558;left:112"><nobr>searching based on bit parallelism [24] could be adapted for these more complex problems. For permit-</nobr></div>
<div style="position:absolute;top:29578;left:112"><nobr>ting a given number of deletions as well as insertions, where both operations are counted and thresholded</nobr></div>
<div style="position:absolute;top:29599;left:112"><nobr>separately, there is a dynamic programming solution in [26] applied to a different problem.</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:29651;left:112"><nobr><b>References</b></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:29695;left:120"><nobr>[1] Baeza-Yates, R.: <i>Efficient Text Searching</i>, Ph.D. Thesis, Dept. of Computer Science, Univ. of Waterloo, May</nobr></div>
<div style="position:absolute;top:29713;left:145"><nobr>1989, Also as Research Report CS-89-17.</nobr></div>
<div style="position:absolute;top:29743;left:120"><nobr>[2] Baeza-Yates, R.: Text Retrieval: Theory and Practice, <i>12th IFIP World Computer Congress</i>, I, Elsevier</nobr></div>
<div style="position:absolute;top:29761;left:145"><nobr>Science, September 1992.</nobr></div>
</span></font>

<div style="position:absolute;top:29875;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=26><b>Page 26</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:30020;left:108"><nobr>1026</nobr></div>
<div style="position:absolute;top:30020;left:199"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:30072;left:116"><nobr>[3] Baeza-Yates, R., Gonnet, G.: A new approach to text searching, <i>Comm. of the ACM</i>, <b>35</b>(10), October 1992,</nobr></div>
<div style="position:absolute;top:30090;left:141"><nobr>74–82.</nobr></div>
<div style="position:absolute;top:30117;left:116"><nobr>[4] Baeza-Yates, R., Navarro, G.: Faster Approximate <b style="color:black;background-color:#ffff66">String</b> Matching, <i>Algorithmica</i>, <b>23</b>(2), 1999, 127–158.</nobr></div>
<div style="position:absolute;top:30144;left:116"><nobr>[5] Baeza-Yates, R., Navarro, G.: New and Faster Filters for <b style="color:black;background-color:#ff9999">Multiple</b> Approximate <b style="color:black;background-color:#ffff66">String</b> Matching, <i>Random</i></nobr></div>
<div style="position:absolute;top:30162;left:141"><nobr><i>Structures and Algorithms (RSA)</i>, <b>20</b>, 2002, 23–49.</nobr></div>
<div style="position:absolute;top:30189;left:116"><nobr>[6] Bishop, M.: A standard audit log format, <i>Proc. 19th National Information Systems Security Conference</i>,</nobr></div>
<div style="position:absolute;top:30206;left:141"><nobr>1995.</nobr></div>
<div style="position:absolute;top:30233;left:116"><nobr>[7] Boasson, L., Cegielski, P., Guessarian, I., Matiyasevich, Y.: Window Accumulated Subsequence Matching is</nobr></div>
<div style="position:absolute;top:30251;left:141"><nobr>linear, <i>Annals of Pure and Applied Logic</i>, <b>113</b>, 2002, 59–80, Previous version in <i>ACM PODS’99</i>.</nobr></div>
<div style="position:absolute;top:30278;left:116"><nobr>[8] Das, G., Fleischer, R., Gasieniec, L., Gunopulos, D., Karkkainen, J.: Episode Matching, <i>Proc. 8th Annual</i></nobr></div>
<div style="position:absolute;top:30296;left:141"><nobr><i>Symposium on Combinatorial Pattern Matching (CPM’96)</i>, LNCS 1264, 1997.</nobr></div>
<div style="position:absolute;top:30323;left:116"><nobr>[9] Forrest, S., Perelson, A., Allen, L., Cherukuri, R.: Self-nonself discrimination in a computer, <i>Proc. IEEE</i></nobr></div>
<div style="position:absolute;top:30341;left:141"><nobr><i>Symp. on Research in Security and Privacy</i>, 1994.</nobr></div>
<div style="position:absolute;top:30367;left:108"><nobr>[10] Garvey, T., Lunt, T.: Model-based intrusion detection, <i>Proc. 14th National Computer Security Conference</i>,</nobr></div>
<div style="position:absolute;top:30385;left:141"><nobr>October 1991.</nobr></div>
<div style="position:absolute;top:30412;left:108"><nobr>[11] Grossi, R., Luccio, F.: Simple and Efficient <b style="color:black;background-color:#ffff66">String</b> Matching with k Mismatches, <i>Information Processing</i></nobr></div>
<div style="position:absolute;top:30430;left:141"><nobr><i>Letters</i>, <b>33</b>(3), 1989, 113–120.</nobr></div>
<div style="position:absolute;top:30457;left:108"><nobr>[12] Jokinen, P., Tarhio, J., Ukkonen, E.: A Comparison of Approximate <b style="color:black;background-color:#ffff66">String</b> Matching Algorithms, <i>Software</i></nobr></div>
<div style="position:absolute;top:30475;left:141"><nobr><i>Practice and Experience</i>, <b>26</b>(12), 1996, 1439–1458.</nobr></div>
<div style="position:absolute;top:30502;left:108"><nobr>[13] Kendall, K.: <i>A Database of Computer Attacks for the Evaluation of Intrusion Detection Systems</i>, Master</nobr></div>
<div style="position:absolute;top:30519;left:141"><nobr>Thesis, MIT, Dept. of Electrical Engineering and Computer Science, June 1999.</nobr></div>
<div style="position:absolute;top:30546;left:108"><nobr>[14] Kumar, S.: <i>Classification and Detection of Computer Intrusions</i>, Ph.D. Thesis, Dept. of Computer Science,</nobr></div>
<div style="position:absolute;top:30564;left:141"><nobr>Purdue University, August 1995.</nobr></div>
<div style="position:absolute;top:30591;left:108"><nobr>[15] Kuri, J., Navarro, G.: Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection, <i>Proc. of the 6th Interna-</i></nobr></div>
<div style="position:absolute;top:30609;left:141"><nobr><i>tional Symposium on <b style="color:black;background-color:#ffff66">String</b> Processing and Information Retrieval (SPIRE’2000)</i>, IEEE CS Press, 2000.</nobr></div>
<div style="position:absolute;top:30636;left:108"><nobr>[16] Kuri, J., Navarro, G., Me, L., Heye, L.: A Pattern Matching Based Filter for Audit Reduction and Fast De-</nobr></div>
<div style="position:absolute;top:30654;left:141"><nobr>tection of Potential Intrusions, <i>Proc. of the 3rd International Workshop on the Recent Advances in Intrusion</i></nobr></div>
<div style="position:absolute;top:30672;left:141"><nobr><i>Detection (RAID’2000)</i>, LNCS v. 1907, 2000.</nobr></div>
<div style="position:absolute;top:30698;left:108"><nobr>[17] Lunt, T.: A survey of intrusion detection techniques, <i>Computers and Security</i>, <b>12</b>, 1993.</nobr></div>
<div style="position:absolute;top:30725;left:108"><nobr>[18] Me, L.: Gassata, a genetic <b style="color:black;background-color:#99ff99">algorithm</b> as an alternative tool for security audit analysis, <i>Proc. of the 1st</i></nobr></div>
<div style="position:absolute;top:30743;left:141"><nobr><i>International Workshop on the Recent Advances in Intrusion Detection (RAID’98)</i>, 1998.</nobr></div>
<div style="position:absolute;top:30770;left:108"><nobr>[19] Muth, R., Manber, U.: Approximate <b style="color:black;background-color:#ff9999">Multiple</b> <b style="color:black;background-color:#ffff66">String</b> <b style="color:black;background-color:#a0ffff">Search</b>, <i>Proc. 7th Annual Symposium on Combinatorial</i></nobr></div>
<div style="position:absolute;top:30788;left:141"><nobr><i>Pattern Matching (CPM’96)</i>, LNCS 1075, 1996.</nobr></div>
<div style="position:absolute;top:30815;left:108"><nobr>[20] Myers, G.: A Fast Bit-Vector <b style="color:black;background-color:#99ff99">Algorithm</b> for Approximate <b style="color:black;background-color:#ffff66">String</b> Matching Based on Dynamic Progamming,</nobr></div>
<div style="position:absolute;top:30832;left:141"><nobr><i>Journal of the ACM</i>, <b>46</b>(3), 1999, 395–415.</nobr></div>
<div style="position:absolute;top:30859;left:108"><nobr>[21] Navarro, G.: <b style="color:black;background-color:#ff9999">Multiple</b> Approximate <b style="color:black;background-color:#ffff66">String</b> Matching by Counting, <i>Proc. 3rd South American Workshop on</i></nobr></div>
<div style="position:absolute;top:30877;left:141"><nobr><i><b style="color:black;background-color:#ffff66">String</b> Processing (WSP’97)</i>, Carleton University Press, 1997.</nobr></div>
<div style="position:absolute;top:30904;left:108"><nobr>[22] Navarro, G.: <i>Approximate Text Searching</i>, Ph.D. Thesis, Dept. of Computer Science, Univ. of Chile, Decem-</nobr></div>
<div style="position:absolute;top:30922;left:141"><nobr>ber 1998, Technical Report TR/DCC-98-14.</nobr></div>
<div style="position:absolute;top:30949;left:108"><nobr>[23] Navarro, G.: A guided tour to approximate <b style="color:black;background-color:#ffff66">string</b> matching, <i>ACM Computing Surveys</i>, <b>33</b>(1), 2001, 31–88.</nobr></div>
</span></font>

<div style="position:absolute;top:31063;left:0"><hr><table border=0 width=100%><tr><td bgcolor=eeeeee align=right><font face=arial,sans-serif><a name=27><b>Page 27</b></a></font></td></tr></table></div><font size=3 face="Times"><span style="font-size:11px;font-family:Times">
<div style="position:absolute;top:31208;left:203"><nobr><i>J. Kuri, G. Navarro, and L. Me /Fast Multipattern <b style="color:black;background-color:#a0ffff">Search</b> Algorithms for Intrusion Detection</i></nobr></div>
<div style="position:absolute;top:31208;left:765"><nobr>1027</nobr></div>
</span></font>
<font size=3 face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:31260;left:112"><nobr>[24] Navarro, G.: NR-grep: a Fast and Flexible Pattern Matching Tool, <i>Software Practice and Experience (SPE)</i>,</nobr></div>
<div style="position:absolute;top:31278;left:145"><nobr><b>31</b>, 2001, 1265–1312.</nobr></div>
<div style="position:absolute;top:31305;left:112"><nobr>[25] Navarro, G., Baeza-Yates, R.: Improving an <b style="color:black;background-color:#99ff99">Algorithm</b> for Approximate Pattern Matching, <i>Algorithmica</i>,</nobr></div>
<div style="position:absolute;top:31323;left:145"><nobr><b>30</b>(4), 2001, 473–502.</nobr></div>
<div style="position:absolute;top:31350;left:112"><nobr>[26] Navarro, G., Baeza-Yates, R., Arcoverde, J.: Matchsimile: A Flexible Approximate Matching Tool for</nobr></div>
<div style="position:absolute;top:31368;left:145"><nobr>Searching Proper Names, <i>Journal of the American Society for Information Science and Technology (JA-</i></nobr></div>
<div style="position:absolute;top:31386;left:145"><nobr><i>SIST)</i>, 2003, To appear. Earlier version in <i>Proc. SBBD 2001</i>.</nobr></div>
<div style="position:absolute;top:31413;left:112"><nobr>[27] Sellers, P.: The theory and computation of evolutionary distances: pattern recognition, <i>J. of Algorithms</i>, <b>1</b>,</nobr></div>
<div style="position:absolute;top:31431;left:145"><nobr>1980, 359–373.</nobr></div>
<div style="position:absolute;top:31458;left:112"><nobr>[28] Wu, S., Manber, U.: Fast text searching allowing errors, <i>Comm. of the ACM</i>, <b>35</b>(10), October 1992, 83–91.</nobr></div>
</span></font>
</body>
</html>
