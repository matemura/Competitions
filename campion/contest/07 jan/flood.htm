<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<TITLE>flood</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#FF00FF">
<h3><font face="Arial, Helvetica, sans-serif" size="2"><B> <font size="4">flood</font></B></font></h3>
<P ALIGN="JUSTIFY"><font face="Arial, Helvetica, sans-serif" size="2">In 2005, Romania was under water. Hundreds of bridges fell, hundreds of roads were destroyed.<BR> The Prime Minister set up an emergency situation council, analyzing the country map. The map has marked on it <font face="Courier New, Courier, mono">N</font> important localities. The localities are numbered from <font face="Courier New, Courier, mono">1</font> to <font face="Courier New, Courier, mono">N</font>. We also have marked on the map the existing roads between localities that can be traveled on, but also the roads that have been destroyed. The estimated cost for road rebuilding is also specified for every destroyed road.<BR> The Prime Minister wishes to build a minimum number of roads, so that in the end there be a connection between the <font face="Courier New, Courier, mono">N</font> localities marked on the map. If there is more than one solution with a minimum number of roads, the one for which the sum of rebuilding costs is smallest will be preferred.</font><font face="Arial, Helvetica, sans-serif"><BR>
  </font></P>
<p><font face="Arial, Helvetica, sans-serif" size="2"><B><font size="3">Task</font></B></font></p>
<p><font face="Arial, Helvetica, sans-serif" size="2">Determine the roads that have to be rebuilt, as well as the minimum amount of money spent on rebuilding.</font></p>
<p><font face="Arial, Helvetica, sans-serif" size="2"><B><font size="3">Input Data </font></B></font></p>
<P><font face="Arial, Helvetica, sans-serif" size="2">Input file <font face="Courier New, Courier, mono">flood.in</font> contains on line one a positive integer <font face="Courier New, Courier, mono">N</font>, representing the number of localities.<BR>
  Line two contains a non-negative integer <font face="Courier New, Courier, mono">M</font>, 
  which represents the number of existing roads that can be traveled.<BR>
  Each of the following <font face="Courier New, Courier, mono">M</font> lines 
  contain two positive integers each, <font face="Courier New, Courier, mono">X</font> 
  and <font face="Courier New, Courier, mono">Y</font>, between <font face="Courier New, Courier, mono">1</font> 
  and <font face="Courier New, Courier, mono">N</font>, separated by a space, 
  with the meaning that &quot;between localities <font face="Courier New, Courier, mono">X</font> 
  and <font face="Courier New, Courier, mono">Y</font> there is a road that can 
  be traveled&quot;.<BR>
  The next line contains a non-negative integer <font face="Courier New, Courier, mono">P</font>, 
  representing the number of destroyed roads.<BR>
   Each of the following <font face="Courier New, Courier, mono">P</font> lines contain three positive integers, each separated by a space, <font face="Courier New, Courier, mono">X</font>, <font face="Courier New, Courier, mono">Y</font> and <font face="Courier New, Courier, mono">C</font>, with the meaning that &quot;rebuilding the road between <font face="Courier New, Courier, mono">X</font> and <font face="Courier New, Courier, mono">Y</font> costs <font face="Courier New, Courier, mono">C</font> RON&quot;.</font><font face="Arial, Helvetica, sans-serif"><BR>
  </font></P>
<p><font face="Arial, Helvetica, sans-serif" size="2"><B><font size="3">Output Data</font></B></font></p>
<P><font face="Arial, Helvetica, sans-serif" size="2">Output file <font face="Courier New, Courier, mono">flood.out</font> 
  will contain on line one a non-negative integer <font face="Courier New, Courier, mono">nr</font>, 
  representing the minimum number of roads that have to be rebuilt. The second 
  line will contain a non-negative integer <font face="Courier New, Courier, mono">S</font> 
  representing the sum of rebuilding costs for the <font face="Courier New, Courier, mono">nr</font> 
  roads (minimum possible). Each of the following <font face="Courier New, Courier, mono">nr</font> 
  lines will contain three positive integers each separated by a space, <font face="Courier New, Courier, mono">X 
  Y C</font>, with the meaning that &quot;the road between <font face="Courier New, Courier, mono">X</font> 
  and <font face="Courier New, Courier, mono">Y</font> of cost <font face="Courier New, Courier, mono">C</font> 
  will be rebuilt&quot;.</font></P>
<p><font face="Arial, Helvetica, sans-serif"><B><font size="3">Constraints</font> and Statements</B></font> </p>
<UL>
  <li><font face="Arial, Helvetica, sans-serif" size="2"> <font face="Courier New, Courier, mono">0 
    &lt; N &lt;= 10 000</font></font></li>
  <li><font face="Courier New, Courier, mono" size="2">0 &lt;= M, P &lt;= 200 
    000</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="2">The rebuilding costs are non-zero positive integers <font face="Courier New, Courier, mono">&lt;= 1000</font></font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="2">Roads between localities are two-directional.</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="2">There can be more than one connecting roads between two localities.</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="2">Total rebuilding costs do not exceed <font face="Courier New, Courier, mono">2 000 000 000</font>.</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="2">Before the floods there was a connection between any two localities.</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="2">Partial scores will be 
    given as follows: <BR>
     - for correctly determining the minimum number of roads, 20% of the test score;<BR> - for correctly determining the minimum number of roads and minimum, 50% of the test score;</font><font face="Arial, Helvetica, sans-serif"><BR>
    <BR>
    </font></li>
</UL>
<font face="Arial, Helvetica, sans-serif" size="2"><B> <font size="3">Example</font></B></font> 
<TABLE BORDER CELLSPACING=1 CELLPADDING=7 WIDTH=451>
  <TR> 
    <TD WIDTH="51%" VALIGN="TOP"> <font face="Courier New, Courier, mono" size="2"><B> flood.in </B></font></TD>
    <td width="49%" valign="TOP"><font face="Courier New, Courier, mono" size="2"><B>flood.out</B></font></td>
  </TR>
  <TR> 
    <TD WIDTH="51%" VALIGN="TOP"> 
      <p><font face="Courier New, Courier, mono" size="2"><B>6<BR> 4<BR> 1 2<BR> 1 6<BR> 3 4<BR> 3 5<BR> 3<BR> 2 5 3<BR> 1 3 5<BR> 4 5 1</B></font></p>
    </TD>
    <td width="49%" valign="TOP"><font face="Courier New, Courier, mono" size="2"><B>1<BR> 3<BR> 2 5 3<BR>
      </B></font></td>
  </TR>
</TABLE>
<P> <font face="Arial, Helvetica, sans-serif" size="2"><B>Time limit</B>: 0.6 
  seconds/test</font></P>
<p align="RIGHT"><font size="2" face="Arial, Helvetica, sans-serif">prof. <I>Emanuela Cerchez</I><BR>
  </font> <font size="2" face="Arial, Helvetica, sans-serif">&quot;<I>Grigore Moisil</I>&quot; Ia&#351;i IT High School<BR>
  </font> <font size="2" face="Arial, Helvetica, sans-serif"> Contact:<a href="mailto:ema@mail.dntis.ro">emanuela.cerchez@gmail.com</a><BR>
  </font> 
</BODY>
</HTML>

